<!DOCTYPE html>
<html lang="en" style="--header-height: 100px; --day-selector-offset: 100px; --scroll-padding: 120px;">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Your Caribbean Cruise Guide | Adventure of the Seas | Feb 14-20, 2026</title>
      <meta name="description" content="Complete cruise planning guide for the Rahe Family Caribbean adventure aboard Adventure of the Seas. Room details, daily itinerary, dining, tips, and everything you need for an amazing vacation.">
      <!-- Preconnect for fonts -->
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
      <!-- Fonts with performance optimization -->
      <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&amp;family=Source+Sans+Pro:wght@300;400;600&amp;display=swap" rel="stylesheet">
      <!-- Font Awesome -->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
      <!-- Favicon -->
      <link rel="icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text y=%22.9em%22 font-size=%2290%22&gt;üö¢&lt;/text&gt;&lt;/svg&gt;">
      <!-- Complete CSS with all fixes -->
      <style>
         /* =============== Tokens =============== */
         :root {
         --bg: #06182b;
         --panel: #0d2640;
         --card: #102c4a;
         --accent: #36c2ff;
         --accent-2: #ffce6b;
         --muted: #9ab2c7;
         --text: #e9f2fb;
         --border: rgba(255,255,255,0.12);
         --shadow: 0 16px 36px rgba(0,0,0,0.35);
         --radius-sm: 8px;
         --radius-md: 14px;
         --radius-lg: 20px;
         --gap-xs: 6px;
         --gap-sm: 10px;
         --gap-md: 14px;
         --gap-lg: 20px;
         --gap-xl: 28px;
         --transition: 150ms ease;
         --font-body: "Source Sans Pro", "Inter", system-ui, -apple-system, sans-serif;
         --font-heading: "Montserrat", "Inter", system-ui, -apple-system, sans-serif;
         --text-xxs: 0.75rem;
         --text-xs: 0.82rem;
         --text-sm: 0.88rem;
         --text-md: 0.96rem;
         --text-lg: 1.05rem;
         --text-xl: 1.2rem;
         --text-2xl: 1.4rem;
         --text-hero: clamp(2rem, 3.6vw, 2.8rem);
         --mode-toggle-height: 56px;
         color-scheme: dark;
         }
         /* =============== Base & Utilities =============== */
         *,*::before,*::after{box-sizing:border-box;}
         body{
         margin:0;
         background: radial-gradient(circle at 18% 18%, rgba(54,194,255,0.08), transparent 36%),
         radial-gradient(circle at 78% 0%, rgba(255,206,107,0.07), transparent 48%),
         var(--bg);
         color:var(--text);
         line-height:1.6;
         font-family:var(--font-body);
         font-size:var(--text-md);
         }
         h1,h2,h3,h4,h5,h6{
         font-family:var(--font-heading);
         font-weight:700;
         letter-spacing:-0.2px;
         margin-top:0;
         }
         img{max-width:100%;display:block;}
         a{color:var(--accent);text-decoration:none;}
         a:hover{color:#1d97d6;}
         .container{width:min(100%,1240px);margin:0 auto;padding:0 var(--gap-lg);}
         .hidden{display:none!important;}
         .is-hidden{display:none!important;}
         .sr-only{position:absolute;left:-9999px;}
         /* Spacing helpers */
         .mb-0{margin-bottom:0;}
         .mb-2{margin-bottom:var(--gap-sm);}
         .mb-4{margin-bottom:var(--gap-md);}
         .mb-6{margin-bottom:var(--gap-lg);}
         .mb-8{margin-bottom:var(--gap-xl);}
         .mt-2{margin-top:var(--gap-md);}
         .mt-4{margin-top:var(--gap-md);}
         .mt-6{margin-top:var(--gap-lg);}
         .mt-8{margin-top:var(--gap-xl);}
         /* Grid helpers */
         .grid-2{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:var(--gap-lg);}
         @media(max-width:1024px){.grid-2{grid-template-columns:1fr;}}
         .grid{display:grid;}
         .grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr));}
         /* =============== Loading Overlay =============== */
         .loading-overlay{
         position:fixed;inset:0;z-index:100;
         background:rgba(0,0,0,0.55);
         display:flex;align-items:center;justify-content:center;flex-direction:column;
         gap:var(--gap-sm);
         }
         .loading-spinner{
         width:56px;height:56px;border-radius:50%;
         border:4px solid rgba(255,255,255,0.15);border-top-color:var(--accent);
         animation:spin 1s linear infinite;
         }
         .loading-text{font-weight:600;}
         .loading-dots::after{content:"...";animation:dots 1.2s steps(3,end) infinite;}
         @keyframes spin{to{transform:rotate(360deg);}}
         @keyframes dots{0%{content:".";}33%{content:"..";}66%{content:"...";}}
         /* =============== Skip Link =============== */
         .skip-link{
         position:absolute;left:-999px;top:8px;z-index:200;
         background:var(--accent);color:#041222;padding:10px 14px;border-radius:var(--radius-sm);
         }
         .skip-link:focus{left:12px;}
         /* =============== Official Banner =============== */
         .rc-official-banner{
         background:rgba(12, 42, 72, 0.92);
         color:var(--text);
         font-size:var(--text-xs);
         border-bottom:1px solid rgba(255,255,255,0.12);
         }
         .rc-banner-content{display:flex;align-items:center;gap:var(--gap-sm);padding:6px 0;}
         .rc-banner-text{display:flex;align-items:center;gap:var(--gap-sm);flex-wrap:wrap;}
         .rc-banner-text img{height:20px;opacity:0.85;}
         .rc-banner-badge{
         padding:3px 8px;border-radius:999px;
         background:rgba(54,194,255,0.18);color:#d7f1ff;font-weight:600;
         font-family:var(--font-heading);
         }
         /* =============== Header =============== */
         .header{
         position:sticky;top:0;z-index:50;
         backdrop-filter:blur(10px);
         background:linear-gradient(135deg, rgba(7,30,54,0.96), rgba(6,24,43,0.86));
         border-bottom:1px solid var(--border);
         box-shadow:0 16px 32px rgba(4,12,24,0.35);
         }
         .header__inner{
         display:flex;align-items:center;justify-content:space-between;
         height:70px;padding:0 var(--gap-lg);gap:var(--gap-md);
         }
         .header__nav{flex:1;display:flex;justify-content:center;}
         .brand{display:flex;align-items:center;gap:var(--gap-sm);color:var(--text);}
         .brand__badge{width:36px;height:36px;border-radius:50%;background:rgba(255,255,255,0.12);display:grid;place-items:center;font-size:1.1rem;}
         .brand__title{display:flex;flex-direction:column;font-size:var(--text-sm);line-height:1.3;font-family:var(--font-heading);}
         .header__nav-list{list-style:none;margin:0;padding:0;display:flex;gap:var(--gap-sm);}
         .nav-link{
         background:none;border:1px solid transparent;color:var(--muted);
         padding:10px 12px;border-radius:var(--radius-sm);display:flex;gap:8px;align-items:center;
         cursor:pointer;transition:background var(--transition),color var(--transition),border var(--transition);
         font-size:var(--text-sm);font-family:var(--font-heading);font-weight:600;
         }
         .nav-link:hover,
         .nav-link.active{color:var(--text);background:rgba(255,255,255,0.06);border-color:var(--border);}
         .header__actions{display:flex;gap:var(--gap-sm);align-items:center;}
         .header__meta{display:flex;align-items:center;gap:var(--gap-xs);}
         .header__chip{
         display:inline-flex;align-items:center;gap:6px;
         padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,0.18);
         background:rgba(255,255,255,0.06);color:var(--text);
         font-size:var(--text-xs);font-family:var(--font-heading);font-weight:600;
         }
         .header__chip i{color:var(--accent);font-size:0.85rem;}
         .header__mobile-toggle,
         .header__search-btn{
         width:40px;height:40px;border:1px solid var(--border);border-radius:10px;
         background:rgba(255,255,255,0.04);color:var(--text);display:grid;place-items:center;cursor:pointer;
         }
         .header__mobile-toggle{display:none;}
         @media(max-width:768px){
         .header__inner{height:64px;}
         .header__nav{display:none;}
         .header__mobile-toggle{display:grid;}
         }
         /* =============== Top Bar Hint =============== */
         .top-bar-hint{
         position:sticky;top:calc(70px + var(--mode-toggle-height));z-index:40;
         background:rgba(17,50,74,0.95);border-bottom:1px solid var(--border);
         padding:10px 0;
         }
         .top-bar-hint__content{display:flex;justify-content:space-between;align-items:flex-start;gap:var(--gap-md);}
         .top-bar-hint__title{display:flex;align-items:center;gap:8px;font-weight:700;font-family:var(--font-heading);}
         .top-bar-hint__badge{padding:4px 8px;border-radius:999px;background:rgba(255,107,107,0.2);color:#ffdede;font-size:var(--text-xs);}
         .top-bar-hint__close{background:none;border:1px solid var(--border);color:var(--text);border-radius:10px;padding:6px 8px;cursor:pointer;}
         @media(max-width:768px){
         :root{--mode-toggle-height: 64px;}
         .top-bar-hint{top:calc(64px + var(--mode-toggle-height));padding:8px 0;}
         }
         /* =============== Mode Toggle Bar =============== */
         .mode-toggle-bar{
         position:sticky;top:70px;z-index:45;
         background:rgba(8,32,56,0.94);
         border-bottom:1px solid var(--border);
         }
         .mode-toggle-content{
         display:flex;align-items:center;justify-content:space-between;
         gap:var(--gap-md);padding:10px 0;
         }
         .mode-label{font-size:var(--text-sm);color:var(--muted);font-family:var(--font-heading);font-weight:600;}
         .mode-buttons{display:flex;gap:var(--gap-sm);flex-wrap:wrap;}
         .mode-btn{
         border:1px solid var(--border);
         background:rgba(255,255,255,0.04);
         color:var(--text);
         border-radius:999px;
         padding:8px 12px;
         font-size:var(--text-sm);
         font-family:var(--font-heading);
         font-weight:600;
         display:inline-flex;
         align-items:center;
         gap:8px;
         cursor:pointer;
         }
         .mode-btn.active{
         background:rgba(54,194,255,0.18);
         border-color:rgba(54,194,255,0.4);
         color:#d7f1ff;
         }
         @media(max-width:768px){
         .mode-toggle-bar{top:64px;}
         .mode-toggle-content{flex-direction:column;align-items:flex-start;}
         }
         /* =============== Search Overlay (modal) =============== */
         .search-overlay{
         position:fixed;inset:0;z-index:120;display:none;
         background:rgba(6,24,43,0.75);backdrop-filter:blur(8px);
         }
         .search-overlay[aria-hidden="false"]{display:flex;align-items:flex-start;justify-content:center;padding:24px;}
         .search-container{
         width:min(100%,720px);background:var(--panel);border:1px solid var(--border);
         border-radius:var(--radius-lg);box-shadow:var(--shadow);padding:20px;
         }
         .search-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--gap-sm);}
         .search-form{display:flex;gap:var(--gap-sm);align-items:center;}
         .search-input{
         flex:1;padding:12px 14px;border-radius:var(--radius-sm);border:1px solid var(--border);
         background:rgba(255,255,255,0.06);color:var(--text);
         }
         .search-submit,.search-close{
         border:none;background:rgba(255,255,255,0.06);color:var(--text);
         width:42px;height:42px;border-radius:10px;cursor:pointer;
         }
         .search-chips,.search-suggestions{margin-top:var(--gap-md);}
         .search-suggestion-chips{display:flex;flex-wrap:wrap;gap:var(--gap-sm);}
         .search-chip{
         border:1px solid var(--border);background:rgba(255,255,255,0.05);color:var(--text);
         border-radius:999px;padding:8px 12px;cursor:pointer;
         font-size:var(--text-sm);font-family:var(--font-heading);font-weight:600;
         }
         .search-results{margin-top:var(--gap-md);min-height:80px;}
         .no-results p{color:var(--muted);margin:0;}
         /* =============== Section Drawer (mobile) =============== */
         .section-drawer-overlay{
         position:fixed;inset:0;z-index:110;display:none;background:rgba(0,0,0,0.55);
         }
         .section-drawer{
         position:fixed;top:0;left:-82%;width:78%;max-width:360px;height:100%;
         background:var(--panel);z-index:130;padding:20px 16px;
         border-right:1px solid var(--border);box-shadow:var(--shadow);
         transition:left var(--transition);
         }
         .section-drawer[aria-hidden="false"]{left:0;}
         .section-drawer__header{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--gap-md);}
         .section-drawer__list{display:grid;gap:var(--gap-sm);}
         .drawer-nav-item{
         width:100%;text-align:left;border:1px solid var(--border);background:rgba(255,255,255,0.04);
         padding:12px;border-radius:12px;color:var(--text);display:flex;justify-content:space-between;align-items:center;cursor:pointer;
         font-size:var(--text-sm);font-family:var(--font-heading);font-weight:600;
         }
         .drawer-badge{padding:4px 8px;border-radius:999px;background:rgba(255,255,255,0.08);font-size:var(--text-xs);}
         .drawer-badge--critical{background:rgba(255,107,107,0.2);color:#ffdede;}
         .drawer-badge--vip{background:rgba(255,206,107,0.2);color:#ffe8b0;}
         @media(min-width:769px){
         .section-drawer,.section-drawer-overlay{display:none!important;}
         }
         /* =============== Hero =============== */
         .hero{
         position:relative;overflow:hidden;color:var(--text);
         padding:var(--gap-xl) 0 var(--gap-lg);
         }
         .hero__content{max-width:780px;}
         .hero__badge-row{display:flex;flex-wrap:wrap;gap:var(--gap-sm);margin-bottom:var(--gap-sm);}
         .hero__badge{
         padding:8px 12px;border-radius:999px;border:1px solid var(--border);
         background:rgba(255,255,255,0.05);color:var(--text);font-weight:600;
         font-family:var(--font-heading);font-size:var(--text-sm);
         }
         .hero__badge--gold{background:rgba(255,206,107,0.18);color:#ffe7a4;}
         .hero__title{font-size:var(--text-hero);margin:0 0 var(--gap-sm);letter-spacing:-0.4px;}
         .hero__subtitle{color:var(--muted);margin:0 0 var(--gap-md);font-size:var(--text-lg);}
         .countdown{display:flex;gap:var(--gap-md);margin:var(--gap-md) 0;}
         .countdown-item{min-width:90px;padding:10px;border-radius:var(--radius-sm);background:rgba(255,255,255,0.05);text-align:center;}
         .countdown-number{font-size:var(--text-2xl);font-weight:700;display:block;}
         .hero__actions{display:flex;flex-wrap:wrap;gap:var(--gap-sm);margin-top:var(--gap-md);}
         .hero__stats{display:flex;flex-wrap:wrap;gap:var(--gap-sm);margin-top:var(--gap-md);color:var(--muted);}
         .hero__stats .stat{
         padding:6px 10px;border-radius:999px;
         background:rgba(255,255,255,0.05);color:var(--text);
         font-size:var(--text-sm);font-family:var(--font-heading);font-weight:600;
         }
         .rc-key-benefits{display:flex;flex-wrap:wrap;gap:var(--gap-sm);margin-top:var(--gap-sm);}
         .key-benefit{display:flex;gap:8px;align-items:center;padding:8px 10px;background:rgba(255,255,255,0.05);border-radius:var(--radius-sm);}
         .rc-wave-bg{position:absolute;inset:0;pointer-events:none;background:radial-gradient(circle at 80% 10%,rgba(54,194,255,0.12),transparent 45%);}
         @media(max-width:768px){.hero{padding:var(--gap-lg) 0 var(--gap-md);}}
         /* =============== Day & Traveler Selectors =============== */
         .day-selector{
         position:sticky;
         top:calc(70px + var(--mode-toggle-height));
         z-index:35;
         background:rgba(6,24,43,0.92);
         border-bottom:1px solid var(--border);
         padding:8px 0;
         }
         .day-selector--hidden{display:none;}
         .day-nav{display:flex;gap:var(--gap-sm);overflow-x:auto;padding-bottom:2px;}
         .day-btn{
         border:1px solid var(--border);background:rgba(255,255,255,0.05);color:var(--text);
         border-radius:999px;padding:8px 12px;white-space:nowrap;cursor:pointer;
         font-size:var(--text-sm);font-family:var(--font-heading);font-weight:600;
         }
         .day-btn.active{background:var(--accent);color:#041222;border-color:transparent;}
         .traveler-selector{padding:10px 0;border-bottom:1px solid var(--border);background:rgba(6,24,43,0.92);}
         .traveler-label{margin-right:10px;color:var(--muted);}
         #travelerSelect{
         background:rgba(255,255,255,0.05);color:var(--text);border:1px solid var(--border);
         padding:10px 12px;border-radius:10px;
         }
         /* =============== Layout =============== */
         .main{padding:var(--gap-lg) 0 var(--gap-xl);}
         .main-layout{display:grid;grid-template-columns:2fr 0.9fr;gap:var(--gap-lg);}
         @media(max-width:1180px){.main-layout{grid-template-columns:1fr;}}
         .main-content{display:flex;flex-direction:column;gap:var(--gap-lg);}
         .sidebar{display:flex;flex-direction:column;gap:var(--gap-lg);position:sticky;top:86px;}
         @media(max-width:1024px){.sidebar{position:static;}}
         /* =============== Cards & Sections =============== */
         .section{scroll-margin-top:90px;}
         .section--pinned{
         border-left:3px solid rgba(54,194,255,0.6);
         padding-left:var(--gap-sm);
         }
         .card{
         background:var(--card);border:1px solid var(--border);border-radius:var(--radius-lg);
         padding:var(--gap-lg);box-shadow:var(--shadow);
         }
         .card__header{display:flex;align-items:flex-start;gap:var(--gap-sm);margin-bottom:var(--gap-sm);}
         .card__icon{width:44px;height:44px;border-radius:12px;background:rgba(255,255,255,0.06);display:grid;place-items:center;font-size:1.1rem;}
         .card__title{margin:0;font-size:var(--text-xl);font-family:var(--font-heading);}
         .card__subtitle{margin:4px 0 0;color:var(--muted);font-size:var(--text-sm);}
         .card__toggle{
         margin-left:auto;border:1px solid var(--border);background:rgba(255,255,255,0.05);
         width:40px;height:40px;border-radius:10px;color:var(--text);cursor:pointer;
         }
         .card__content{color:var(--muted);}
         .card__content.collapsed{display:none;}
         .card--featured{border-color:rgba(54,194,255,0.35);}
         .card--highlight{border-color:rgba(255,206,107,0.4);}
         /* =============== Buttons =============== */
         .btn{
         border:none;cursor:pointer;font-weight:700;
         border-radius:12px;padding:11px 14px;
         transition:transform var(--transition),box-shadow var(--transition),background var(--transition),color var(--transition);
         font-family:var(--font-heading);
         }
         .btn:active{transform:translateY(1px);}
         .btn--primary{background:linear-gradient(135deg,var(--accent),#1b9ad7);color:#041222;box-shadow:0 14px 30px rgba(54,194,255,0.32);}
         .btn--ghost,.btn--outline{
         background:rgba(255,255,255,0.06);color:var(--text);border:1px solid var(--border);
         }
         .btn--ghost:hover,.btn--outline:hover{background:rgba(255,255,255,0.12);}
         .btn--outline{border-style:dashed;}
         .btn--critical{background:linear-gradient(135deg,#ff6b6b,#e94c4c);color:#fff;}
         .btn--sm{padding:8px 12px;font-size:var(--text-sm);border-radius:10px;}
         /* legacy mapping */
         .btn--primary,.btn-primary{background:linear-gradient(135deg,var(--accent),#1b9ad7);color:#041222;}
         .btn--ghost,.btn-tertiary{background:transparent;border:1px dashed var(--border);color:var(--muted);}
         .btn--outline,.btn-secondary{background:rgba(255,255,255,0.05);border:1px solid var(--border);color:var(--text);}
         /* =============== Chips / Tags =============== */
         .chips,.tag-group{display:flex;flex-wrap:wrap;gap:var(--gap-xs);}
         .tag,.chip{
         display:inline-flex;align-items:center;gap:6px;
         padding:6px 10px;border-radius:999px;
         background:rgba(255,255,255,0.06);color:var(--text);font-size:var(--text-sm);
         }
         .tag--essential{background:rgba(255,107,107,0.2);color:#ffdede;}
         .tag--recommended{background:rgba(54,194,255,0.18);color:#d8f1ff;}
         .tag--info{background:rgba(255,255,255,0.1);}
         .tag--time{background:rgba(255,206,107,0.2);color:#ffe7b3;}
         .chip--primary{background:rgba(54,194,255,0.2);}
         .chip--accent{background:rgba(255,206,107,0.2);}
         .chip--teal{background:rgba(59,212,167,0.2);}
         /* =============== Quick Start / Lists / Tables =============== */
         .quick-start__list{list-style:none;margin:var(--gap-md) 0 0;padding:0;display:grid;gap:var(--gap-sm);}
         .quick-start__item{display:flex;gap:var(--gap-sm);align-items:flex-start;padding:12px;border-radius:12px;background:rgba(255,255,255,0.04);}
         .quick-start__actions{display:flex;flex-wrap:wrap;gap:var(--gap-sm);align-items:center;margin-top:var(--gap-md);}
         .critical-toggle{display:flex;align-items:center;gap:var(--gap-xs);flex-wrap:wrap;color:var(--muted);}
         .list{list-style:none;margin:0;padding:0;display:grid;gap:var(--gap-sm);}
         .list--icon li{display:flex;gap:10px;align-items:flex-start;}
         .info-table{width:100%;border-collapse:collapse;color:var(--text);}
         .info-table th,.info-table td{padding:10px;border:1px solid var(--border);text-align:left;}
         .table-responsive{overflow-x:auto;border-radius:12px;border:1px solid var(--border);}
         .guest-list{list-style:none;margin:0;padding:0;display:grid;gap:6px;}
         .checklist{display:grid;gap:var(--gap-sm);}
         .checklist-item{display:flex;gap:12px;padding:12px;border-radius:12px;background:rgba(255,255,255,0.04);}
         .checklist-icon{width:34px;height:34px;display:grid;place-items:center;border-radius:10px;background:rgba(255,255,255,0.06);}
         .checklist-time{font-size:var(--text-xs);color:var(--accent-2);font-weight:700;}
         .checklist-timeline{display:grid;gap:var(--gap-md);}
         .tracker-item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:10px;background:rgba(255,255,255,0.04);}
         .progress-track{height:6px;background:rgba(255,255,255,0.08);border-radius:999px;overflow:hidden;}
         .progress-bar{height:100%;background:var(--accent);width:var(--progress,75%);}
         /* =============== Cards: Activity / Dining / Tips =============== */
         .activity-grid,.dining-grid,.tips-grid,.room-grid{display:grid;gap:var(--gap-lg);}
         .activity-grid{grid-template-columns:repeat(auto-fit,minmax(220px,1fr));}
         .dining-grid{grid-template-columns:repeat(auto-fit,minmax(260px,1fr));}
         .tips-grid{grid-template-columns:repeat(auto-fit,minmax(240px,1fr));}
         .room-grid{grid-template-columns:repeat(auto-fit,minmax(240px,1fr));}
         .deck-plans-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:var(--gap-md);margin-top:var(--gap-md);}
         .deck-plan-card{
         padding:16px;border-radius:14px;background:rgba(255,255,255,0.04);border:1px solid var(--border);
         display:flex;flex-direction:column;gap:var(--gap-sm);
         }
         .deck-plan-card--placeholder{border-style:dashed;text-align:center;color:var(--muted);}
         .deck-plan-card img{width:100%;border-radius:12px;border:1px solid var(--border);}
         .deck-plan-meta{font-size:var(--text-sm);color:var(--muted);}
         .deck-plan-actions{display:flex;flex-wrap:wrap;gap:var(--gap-sm);margin-top:var(--gap-sm);}
         .deck-plan-upload{
         margin-top:var(--gap-md);padding:14px;border-radius:12px;border:1px dashed var(--border);
         background:rgba(255,255,255,0.03);display:grid;gap:8px;
         }
         .deck-plan-upload input{color:var(--text);}
         .activity-card,.dining-card,.tip-card,.room-card{
         padding:16px;border-radius:14px;background:rgba(255,255,255,0.04);border:1px solid var(--border);
         transition:transform var(--transition),border-color var(--transition);
         }
         .activity-card:hover,.dining-card:hover,.tip-card:hover,.room-card:hover{transform:translateY(-2px);border-color:rgba(255,255,255,0.16);}
         .activity-card__icon,.room-number{
         font-size:1.6rem;font-weight:700;font-family:var(--font-heading);
         }
         .room-card.featured{border-color:rgba(54,194,255,0.3);}
         .dining-card.featured{border-color:rgba(255,206,107,0.35);}
         .tip-header{display:flex;gap:8px;align-items:center;margin-bottom:8px;}
         .tip-icon{width:34px;height:34px;border-radius:10px;background:rgba(255,255,255,0.07);display:grid;place-items:center;}
         .tips-priority{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:var(--gap-lg);}
         .tip-card--large{padding:20px;border-radius:18px;}
         /* =============== Today Timeline =============== */
         .today-timeline{display:grid;gap:var(--gap-md);}
         .today-task{
         display:grid;gap:var(--gap-sm);
         padding:16px;border-radius:16px;
         background:rgba(255,255,255,0.04);
         border:1px solid var(--border);
         }
         .today-task--critical{border-color:rgba(255,107,107,0.4);background:rgba(255,107,107,0.08);}
         .today-task--important{border-color:rgba(255,206,107,0.4);background:rgba(255,206,107,0.08);}
         .task-time{font-size:var(--text-xs);font-weight:700;color:var(--accent-2);text-transform:uppercase;letter-spacing:0.08em;}
         .task-content h3{margin:0 0 6px;font-size:var(--text-lg);}
         .task-checklist{display:grid;gap:6px;font-size:var(--text-sm);color:var(--muted);}
         .task-checklist input{margin-right:8px;}
         .comm-block{
         margin-top:var(--gap-lg);
         padding:16px;border-radius:16px;border:1px solid var(--border);
         background:rgba(255,255,255,0.04);
         }
         /* =============== Royal Caribbean Highlights =============== */
         .rc-card,
         .perfect-day-card,
         .rc-app-integration,
         .official-muster-info{
         border:1px solid var(--border);
         border-radius:var(--radius-lg);
         padding:var(--gap-md);
         background:rgba(255,255,255,0.04);
         }
         .rc-badge{
         display:inline-flex;align-items:center;gap:6px;
         padding:6px 12px;border-radius:999px;
         font-size:var(--text-xs);
         font-weight:700;
         text-transform:uppercase;
         letter-spacing:0.6px;
         background:rgba(54,194,255,0.2);
         color:#d9f3ff;
         }
         .rc-headline{font-size:var(--text-lg);margin:0;font-family:var(--font-heading);}
         .rc-body{font-size:var(--text-md);color:var(--text);margin:0;}
         .rc-caption{font-size:var(--text-sm);color:var(--muted);margin:0;}
         .perfect-day-card{
         position:relative;
         overflow:hidden;
         background:linear-gradient(135deg,rgba(54,194,255,0.18),rgba(255,206,107,0.18));
         }
         .rc-app-integration{
         display:grid;
         grid-template-columns:minmax(140px, 180px) 1fr;
         gap:var(--gap-md);
         align-items:center;
         }
         .app-qr-code{
         width:160px;max-width:100%;
         aspect-ratio:1/1;
         border-radius:18px;
         overflow:hidden;
         background:linear-gradient(145deg,rgba(54,194,255,0.18),rgba(6,24,43,0.9));
         box-shadow:0 16px 30px rgba(0,0,0,0.35);
         display:grid;place-items:center;
         }
         .app-qr-code img{width:100%;height:100%;object-fit:cover;}
         .app-features h3{margin:0 0 var(--gap-sm);font-size:var(--text-lg);}
         .app-features ul{margin:0 0 var(--gap-sm);padding-left:18px;color:var(--muted);font-size:var(--text-sm);}
         .app-features li{margin-bottom:6px;}
         .rc-btn{
         display:inline-flex;align-items:center;gap:8px;
         padding:10px 16px;border-radius:12px;border:none;
         background:linear-gradient(135deg,var(--accent),#1b9ad7);
         color:#041222;font-weight:700;font-family:var(--font-heading);
         cursor:pointer;
         }
         .official-muster-info{display:grid;gap:var(--gap-sm);}
         .muster-header{display:flex;align-items:center;justify-content:space-between;gap:var(--gap-sm);}
         .muster-header h3{margin:0;font-size:var(--text-lg);}
         .muster-badge{
         padding:6px 10px;border-radius:999px;
         background:rgba(255,206,107,0.2);
         color:#ffe7b3;font-weight:700;font-size:var(--text-sm);
         }
         .muster-details p{margin:0 0 6px;font-size:var(--text-sm);}
         .muster-progress span{font-size:var(--text-xs);color:var(--muted);}
         /* =============== Timeline =============== */
         .timeline{display:grid;gap:var(--gap-md);}
         .timeline-item{
         border-left:3px solid var(--accent);padding-left:14px;
         background:rgba(255,255,255,0.03);border-radius:12px;border:1px solid var(--border);
         }
         .timeline-day{color:var(--muted);font-weight:700;display:block;margin-bottom:6px;font-size:var(--text-sm);}
         /* =============== Sidebar Cards =============== */
         .sidebar-card{
         background:var(--panel);border:1px solid var(--border);border-radius:var(--radius-lg);
         padding:var(--gap-md);box-shadow:var(--shadow);
         }
         .sidebar-card--highlight{border-color:rgba(54,194,255,0.3);}
         .sidebar-card--critical{border-color:rgba(255,107,107,0.4);background:rgba(255,107,107,0.08);}
         .sidebar-card__title{margin:0 0 var(--gap-sm);display:flex;align-items:center;gap:8px;}
         .sidebar-links{list-style:none;padding:0;margin:0;display:grid;gap:var(--gap-xs);}
         .sidebar-link{
         width:100%;text-align:left;border:1px solid var(--border);background:rgba(255,255,255,0.04);
         padding:10px;border-radius:10px;color:var(--text);display:flex;gap:8px;align-items:center;cursor:pointer;
         font-size:var(--text-sm);font-family:var(--font-heading);font-weight:600;
         }
         .sidebar-link:hover{border-color:rgba(255,255,255,0.16);}
         .date-list{list-style:none;margin:0;padding:0;display:grid;gap:var(--gap-xs);}
         .date-item{display:flex;justify-content:space-between;padding:10px;border-radius:10px;background:rgba(255,255,255,0.04);}
         .weather-widget{text-align:center;padding:var(--gap-sm);border-radius:12px;background:rgba(255,255,255,0.04);border:1px solid var(--border);}
         .weather-temp{font-size:1.6rem;font-weight:700;}
         .weather-summary{margin-bottom:var(--gap-sm);color:var(--muted);font-size:var(--text-sm);}
         .weather-forecast-list{display:grid;gap:var(--gap-xs);text-align:left;margin:0;padding:0;list-style:none;}
         .weather-forecast-item{display:grid;grid-template-columns:auto 1fr auto;gap:var(--gap-sm);align-items:center;padding:8px 10px;border-radius:10px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);}
         .weather-forecast-item strong{font-family:var(--font-heading);font-size:var(--text-sm);}
         .weather-forecast-meta{font-size:var(--text-xs);color:var(--muted);}
         .weather-forecast-temp{font-size:var(--text-sm);font-weight:600;}
         .nav-badge,.drawer-badge,.tag{font-weight:700;}
         /* =============== Toast =============== */
         .toast{
         position:relative;margin-bottom:var(--gap-md);
         padding:12px 14px;border-radius:12px;background:rgba(54,194,255,0.12);
         border:1px solid rgba(54,194,255,0.3);color:var(--text);
         }
         .toast__close{
         position:absolute;top:8px;right:8px;border:none;background:transparent;color:var(--text);cursor:pointer;
         }
         /* =============== Floating Actions =============== */
         .floating-actions{
         position:fixed;right:16px;bottom:78px;z-index:80;display:flex;flex-direction:column;gap:12px;
         }
         .fab{
         width:56px;height:56px;border-radius:50%;border:none;cursor:pointer;
         background:var(--accent);color:#041222;box-shadow:0 14px 30px rgba(0,0,0,0.35);
         }
         .fab--critical{background:linear-gradient(135deg,#ff6b6b,#e94c4c);color:#fff;}
         .fab--compact.active{background:rgba(255,255,255,0.14);color:var(--text);}
         /* =============== Bottom Nav (mobile) =============== */
         .bottom-nav{
         position:sticky;bottom:0;z-index:90;display:none;
         background:rgba(6,24,43,0.95);border-top:1px solid var(--border);
         grid-template-columns:repeat(4,1fr);gap:0;
         }
         .bottom-nav .nav-item{
         border:none;background:transparent;color:var(--muted);
         padding:10px 6px;display:flex;flex-direction:column;gap:4px;align-items:center;justify-content:center;
         font-size:0.9rem;cursor:pointer;
         }
         .bottom-nav .nav-item.active{color:var(--text);background:rgba(255,255,255,0.06);}
         .nav-badge{
         display:inline-flex;align-items:center;justify-content:center;
         min-width:18px;padding:2px 6px;border-radius:10px;
         background:rgba(255,107,107,0.8);color:#fff;font-size:0.75rem;
         }
         @media(max-width:768px){.bottom-nav{display:grid;} .floating-actions{bottom:70px;}}
         @media(max-width:420px){.bottom-nav{grid-template-columns:repeat(4,1fr);}}
         /* =============== Footer =============== */
         .rc-official-footer{
         background:linear-gradient(180deg, rgba(6,24,43,0.96), rgba(4,20,36,0.98));
         border-top:1px solid var(--border);padding:var(--gap-lg) 0;
         }
         .rc-footer-main{
         display:grid;grid-template-columns:1.2fr 0.9fr 0.9fr 1fr;gap:var(--gap-lg);align-items:flex-start;
         }
         .rc-footer-column{display:flex;flex-direction:column;gap:var(--gap-sm);}
         .rc-footer-heading{
         font-family:var(--font-heading);font-size:var(--text-xs);font-weight:700;
         letter-spacing:0.12em;text-transform:uppercase;color:var(--muted);margin:0;
         }
         .rc-footer-list{list-style:none;margin:0;padding:0;display:grid;gap:6px;}
         .rc-footer-list a{color:var(--text);}
         .rc-footer-list a:hover{color:var(--accent);}
         .rc-footer-cta{
         display:inline-flex;align-items:center;gap:8px;
         padding:8px 12px;border-radius:999px;border:1px solid var(--border);
         background:rgba(255,255,255,0.06);font-weight:600;color:var(--text);
         }
         .rc-tagline{color:var(--muted);margin:6px 0 0;}
         .rc-legal-links{display:flex;flex-wrap:wrap;gap:8px;color:var(--muted);}
         .rc-contact-info p{margin:4px 0;}
         .rc-footer-social{display:flex;gap:10px;margin-top:8px;}
         .rc-footer-social a{
         width:36px;height:36px;border-radius:50%;
         display:grid;place-items:center;border:1px solid var(--border);
         background:rgba(255,255,255,0.05);color:var(--text);
         }
         .rc-footer-disclaimer{margin-top:var(--gap-md);color:var(--muted);font-size:var(--text-sm);}
         @media(max-width:1100px){.header__meta{display:none;}}
         @media(max-width:900px){.rc-footer-main{grid-template-columns:1fr;}}
         /* =============== Notes / Legends =============== */
         .note{
         padding:12px;border-radius:12px;border:1px solid var(--border);
         background:rgba(255,255,255,0.04);color:var(--text);
         }
         .note--info{border-color:rgba(54,194,255,0.3);}
         .note--accent{border-color:rgba(255,206,107,0.35);}
         .legend-bar{display:flex;gap:var(--gap-sm);flex-wrap:wrap;}
         .legend-chip{padding:6px 10px;border-radius:10px;background:rgba(255,255,255,0.06);}
         .legend-chip.critical{background:rgba(255,107,107,0.2);}
         .legend-chip.optional{background:rgba(255,206,107,0.2);}
         .legend-chip.info{background:rgba(54,194,255,0.2);}
         /* =============== Accessibility / Motion =============== */
         @media (prefers-reduced-motion: reduce){
         *,*::before,*::after{animation-duration:0.001ms!important;transition-duration:0.001ms!important;}
         }
         /* =============== Responsive Shell Tweaks =============== */
         @media(max-width:1280px){.container{padding:0 var(--gap-md);}}
         @media(max-width:1024px){
         .header__inner{padding:0 var(--gap-md);}
         .hero__content{max-width:100%;}
         .card{padding:var(--gap-md);}
         }
         @media(max-width:768px){
         :root{--gap-lg:16px;}
         .container{padding:0 var(--gap-md);}
         .header{backdrop-filter:blur(6px);}
         .top-bar-hint{top:64px;}
         .main{padding:var(--gap-md) 0 var(--gap-lg);}
         }
         @media(max-width:640px){
         :root{--gap-md:12px;--gap-lg:16px;}
         .rc-banner-content{flex-direction:column;align-items:flex-start;}
         .rc-banner-text{flex-wrap:wrap;font-size:var(--text-sm);gap:8px;}
         .rc-banner-text span{font-size:var(--text-xs);line-height:1.35;}
         .rc-banner-text img{max-width:120px;height:auto;}
         .crown-anchor-status{font-size:var(--text-xs);}
         .header__inner{height:60px;}
         .header__inner{padding:0 var(--gap-md);gap:var(--gap-sm);}
         .brand__badge{width:32px;height:32px;font-size:1rem;}
         .brand__title{font-size:var(--text-xs);}
         .brand__title strong{font-size:var(--text-sm);}
         .brand__title span{font-size:var(--text-xxs);}
         .header__actions{gap:8px;}
         .header__search-btn,.header__mobile-toggle{width:36px;height:36px;border-radius:8px;}
         .top-bar-hint__content{flex-direction:column;align-items:flex-start;}
         .top-bar-hint__title{font-size:var(--text-md);}
         .top-bar-hint__close{
         padding:4px 6px;
         align-self:flex-end;
         min-height:36px;
         min-width:36px;
         }
         .hero__badge-row{gap:var(--gap-xs);}
         .hero__badge{font-size:var(--text-xs);padding:6px 10px;}
         .hero__title{font-size:clamp(1.9rem,7vw,2.4rem);}
         .hero__actions{flex-direction:column;align-items:stretch;}
         .countdown{flex-wrap:wrap;}
         .countdown-item{min-width:calc(50% - var(--gap-sm));}
         .rc-app-integration{grid-template-columns:1fr;justify-items:center;text-align:left;}
         .app-qr-code{width:180px;}
         .day-selector{top:calc(64px + var(--mode-toggle-height));}
         .day-nav{gap:8px;}
         .card{padding:var(--gap-md);}
         .card__header{flex-wrap:wrap;}
         .card__toggle{margin-left:0;}
         .activity-grid,.dining-grid,.tips-grid,.room-grid{grid-template-columns:1fr;}
         .info-table th,.info-table td{font-size:var(--text-sm);padding:8px;}
         .floating-actions{right:12px;}
         .fab{width:50px;height:50px;}
         .rc-footer-main{gap:var(--gap-md);}
         }
         @media(max-width:480px){
         .hero__title{font-size:clamp(1.7rem,8vw,2.1rem);}
         .countdown-item{min-width:100%;}
         .card__icon{width:36px;height:36px;border-radius:10px;}
         .card__title{font-size:var(--text-lg);}
         .nav-badge{font-size:var(--text-xxs);}
         }
         @media(max-width:768px){
         .btn,.nav-link,.day-btn,.sidebar-link,.search-chip,.tag{
         min-height:44px;min-width:44px;padding:12px 16px;
         }
         .hero__actions{gap:var(--gap-md);}
         .quick-start__actions{gap:var(--gap-sm);}
         .card{margin-bottom:var(--gap-md);border-radius:var(--radius-md);}
         .day-nav{padding:4px 0;-webkit-overflow-scrolling:touch;}
         .day-btn{padding:10px 14px;font-size:0.95rem;}
         .loading-spinner{width:48px;height:48px;border-width:3px;}
         .loading-text{font-size:1rem;text-align:center;padding:0 var(--gap-md);}
         .toast{margin:var(--gap-sm);border-radius:var(--radius-md);}
         .bottom-nav{
         height:60px;padding-top:4px;
         backdrop-filter:blur(20px);
         background:rgba(6,24,43,0.98);
         }
         .bottom-nav .nav-item{position:relative;transition:all var(--transition);}
         .bottom-nav .nav-item.active{
         color:var(--accent);background:rgba(54,194,255,0.1);
         }
         .bottom-nav .nav-item.active::before{
         content:'';position:absolute;top:0;left:50%;
         transform:translateX(-50%);width:30%;height:3px;
         background:var(--accent);border-radius:0 0 2px 2px;
         }
         .nav-badge{
         position:absolute;top:4px;right:50%;
         transform:translateX(50%);
         min-width:20px;height:20px;padding:0 6px;font-size:0.7rem;
         border:2px solid var(--bg);
         }
         .day-selector{
         padding:0;background:rgba(6,24,43,0.98);
         backdrop-filter:blur(10px);
         }
         .day-nav{padding:12px var(--gap-md);gap:8px;}
         .day-btn{
         flex-shrink:0;font-size:0.9rem;padding:10px 14px;
         border-radius:var(--radius-lg);
         }
         .day-btn.active{
         font-weight:700;box-shadow:0 4px 12px rgba(54,194,255,0.3);
         }
         .card__content{
         max-height:0;overflow:hidden;transition:max-height 0.3s ease;
         display:block;
         }
         .card__content.collapsed{display:block;}
         .card__content.expanded{max-height:2000px;}
         .card__header{padding:var(--gap-sm) 0;}
         .card__toggle{width:36px;height:36px;}
         .timeline-item{margin-left:8px;padding-left:16px;}
         .timeline-day{font-size:0.9rem;margin-bottom:8px;}
         .search-overlay[aria-hidden="false"]{
         padding:0;align-items:stretch;
         }
         .search-container{
         width:100%;height:100vh;border-radius:0;
         padding:20px var(--gap-md);
         display:flex;flex-direction:column;
         }
         .search-input{font-size:16px;padding:14px;}
         .search-suggestion-chips{justify-content:center;}
         .search-chip{padding:10px 14px;font-size:0.9rem;}
         .section-drawer{
         width:85%;max-width:300px;
         padding:var(--gap-lg) var(--gap-md);
         }
         .drawer-nav-item{
         padding:14px;margin-bottom:8px;border-radius:var(--radius-md);
         }
         .sidebar-link{padding:12px;margin-bottom:6px;}
         .rc-wave-bg{opacity:0.7;}
         body{
         background:radial-gradient(circle at 20% 20%, rgba(54,194,255,0.05), transparent 30%),
         var(--bg);
         }
         button:focus-visible,
         a:focus-visible,
         .nav-link:focus-visible{
         outline:3px solid var(--accent);outline-offset:2px;
         }
         .hero__title,
         .card__title,
         .sidebar-card__title{
         text-shadow:0 2px 4px rgba(0,0,0,0.3);
         }
         .sidebar-card:last-child{
         border-color:rgba(255,107,107,0.3);
         background:rgba(255,107,107,0.05);
         }
         }
         @media(max-width:480px){
         .hero__badge{font-size:0.8rem;padding:6px 8px;}
         .countdown-item{padding:12px 8px;}
         .bottom-nav .nav-item{padding:12px 4px;font-size:0.8rem;}
         .floating-actions{bottom:70px;right:12px;}
         .fab{width:56px;height:56px;font-size:1.2rem;}
         }
         @media(max-width:768px) and (prefers-reduced-motion: no-preference){
         *{animation-duration:0.3s!important;transition-duration:0.3s!important;}
         }
         /* =============== Touch Targets =============== */
         @media(hover:none){
         button:not(.top-bar-hint__close),.nav-link,.nav-item,.drawer-nav-item,.sidebar-link{min-height:48px;min-width:48px;}
         }
      </style>
   </head>
   <body class="compact-mode mobile-view">
      <!-- Loading Overlay -->
      <div class="loading-overlay hidden" id="loadingOverlay">
         <div class="loading-spinner"></div>
         <div class="loading-text">
            Loading Your Cruise Adventure<span class="loading-dots"></span>
         </div>
      </div>
      <!-- Skip Link -->
      <a href="#main-content" class="skip-link">
      Skip to main content
      </a>
      <a href="#critical-checklist" class="skip-link">
      Skip to critical checklist
      </a>
      <!-- Official Royal Caribbean Banner -->
      <div class="rc-official-banner" role="status">
         <div class="container">
            <div class="rc-banner-content">
               <div class="rc-banner-text">
                  <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 220 40'><rect width='220' height='40' fill='%230054a4'/><text x='12' y='26' font-family='Montserrat, Arial, sans-serif' font-size='18' fill='white'>Royal Caribbean</text></svg>" alt="Royal Caribbean International">
                  <span class="rc-banner-badge">Official Cruise Planner</span>
                  <span>Adventure of the Seas ‚Ä¢ Booking #12345678</span>
               </div>
            </div>
         </div>
      </div>
      <!-- Header -->
      <header class="header" role="banner">
         <div class="container">
            <div class="header__inner">
               <!-- Logo -->
               <a href="#" class="brand" aria-label="Go to top">
               <span class="brand__badge" role="img" aria-label="Royal Caribbean">‚öì</span>
               <span class="brand__title">
               <strong>Royal Caribbean Cruise Planner</strong>
               <span>Adventure of the Seas ¬∑ Feb 14-20, 2026</span>
               </span>
               </a>
               <!-- Navigation -->
               <nav class="header__nav" id="mainNav" aria-label="Primary navigation">
                  <ul class="header__nav-list">
                     <li>
                        <button class="nav-link" data-section="overview" type="button">
                        <span class="emoji" aria-hidden="true">üö¢</span><span>Start Here</span>
                        </button>
                     </li>
                     <li>
                        <button class="nav-link" data-section="operations" type="button">
                        <span class="emoji" aria-hidden="true">‚öì</span><span>Guide</span>
                        </button>
                     </li>
                     <li>
                        <button class="nav-link" data-section="rooms" type="button">
                        <span class="emoji" aria-hidden="true">‚öì</span><span>Rooms</span>
                        </button>
                     </li>
                     <li>
                        <button class="nav-link" data-section="deck-plans" type="button">
                        <span class="emoji" aria-hidden="true">üó∫Ô∏è</span><span>Deck Plans</span>
                        </button>
                     </li>
                     <li>
                        <button class="nav-link" data-section="itinerary" type="button">
                        <span class="emoji" aria-hidden="true">üå¥</span><span>Itinerary</span>
                        </button>
                     </li>
                     <li>
                        <button class="nav-link" data-section="dining" type="button">
                        <span class="emoji" aria-hidden="true">üåä</span><span>Dining</span>
                        </button>
                     </li>
                     <li>
                        <button class="nav-link" data-section="communication" type="button">
                        <span class="emoji" aria-hidden="true">‚öì</span><span>Comms &amp; Budget</span>
                        </button>
                     </li>
                     <li>
                        <button class="nav-link" data-section="tips" type="button">
                        <span class="emoji" aria-hidden="true">üåä</span><span>Tips</span>
                        </button>
                     </li>
                     <li>
                        <!-- ‚úÖ FIX: This was incorrectly labeled "Tips" -->
                        <button class="nav-link" data-section="integrate" type="button">
                        <span class="emoji" aria-hidden="true">üëë</span><span>VIP</span>
                        </button>
                     </li>
                  </ul>
               </nav>
               <div class="header__meta" aria-label="Cruise highlights">
                  <span class="header__chip"><i class="fas fa-anchor" aria-hidden="true"></i>Embark 2:00 PM</span>
                  <span class="header__chip"><i class="fas fa-compass" aria-hidden="true"></i>Muster F6</span>
               </div>
               <!-- Header Actions -->
               <div class="header__actions">
                  <!-- Mobile drawer toggle -->
                  <button class="header__mobile-toggle" id="mobileMenuBtn" type="button" aria-label="Open navigation drawer">
                  <span class="header__mobile-icon" aria-hidden="true"></span>
                  </button>
                  <!-- Search -->
                  <button class="header__search-btn" id="searchBtn" type="button" aria-label="Open search">
                  <i class="fas fa-search" aria-hidden="true"></i>
                  </button>
               </div>
            </div>
         </div>
      </header>
      <!-- Mode Toggle Bar -->
      <div class="mode-toggle-bar" role="toolbar" aria-label="View mode selection">
         <div class="container">
            <div class="mode-toggle-content">
               <span class="mode-label">View Mode:</span>
               <div class="mode-buttons" role="radiogroup" aria-label="Select view mode">
                  <button class="mode-btn active" data-mode="today" role="radio" aria-checked="true" type="button">
                     <i class="fas fa-calendar-day" aria-hidden="true"></i>
                     <span>Today</span>
                  </button>
                  <button class="mode-btn" data-mode="first-timer" role="radio" aria-checked="false" type="button">
                     <i class="fas fa-route" aria-hidden="true"></i>
                     <span>First-Timer</span>
                  </button>
                  <button class="mode-btn" data-mode="veteran" role="radio" aria-checked="false" type="button">
                     <i class="fas fa-list" aria-hidden="true"></i>
                     <span>All Details</span>
                  </button>
               </div>
            </div>
         </div>
      </div>
      <!-- Sticky Top Bar Hint -->
      <div class="top-bar-hint is-hidden" id="topBarHint" role="status" aria-live="polite" aria-atomic="true">
         <div class="container">
            <div class="top-bar-hint__content">
               <div class="top-bar-hint__left">
                  <div class="top-bar-hint__title" id="topBarHintTitleWrap">
                     <i class="fas fa-sun" aria-hidden="true"></i>
                     <span id="topBarHintTitle">Today: Preparation</span>
                     <span class="top-bar-hint__badge" id="topBarHintBadge" aria-hidden="true">LIVE</span>
                  </div>
                  <div class="top-bar-hint__detail" id="topBarHintDetail">
                     Tap a day to see port highlights and all-aboard times.
                  </div>
                  <div class="top-bar-hint__meta" aria-hidden="true">
                     <span class="top-bar-hint__meta-item">
                     <i class="fas fa-mouse-pointer" aria-hidden="true"></i> Tap
                     </span>
                     <span class="top-bar-hint__meta-dot">‚Ä¢</span>
                     <span class="top-bar-hint__meta-item">
                     <i class="fas fa-keyboard" aria-hidden="true"></i> Use ‚Üê ‚Üí
                     </span>
                  </div>
               </div>
               <button class="top-bar-hint__close" id="topBarHintClose" type="button" aria-label="Hide today hint">
               <i class="fas fa-times" aria-hidden="true"></i>
               </button>
            </div>
         </div>
      </div>
      <!-- Search Overlay -->
      <div class="search-overlay" id="searchOverlay" role="dialog" aria-modal="true" aria-labelledby="searchTitle" aria-hidden="true">
         <div class="search-container" role="document">
            <div class="search-header">
               <div class="search-header__title">
                  <i class="fas fa-search" aria-hidden="true"></i>
                  <span id="searchTitle">Search Cruise Guide</span>
               </div>
               <div class="search-header__hint" aria-hidden="true">
                  <kbd>Esc</kbd> to close
               </div>
            </div>
            <form class="search-form" id="searchForm" role="search" aria-label="Search the cruise guide">
               <input
                  type="search"
                  class="search-input"
                  id="searchInput"
                  placeholder="Search ports, dining, rooms, eMuster, budget‚Ä¶"
                  aria-label="Search cruise information"
                  autocomplete="off"
                  inputmode="search"
                  enterkeyhint="search"
                  >
               <button type="submit" class="search-submit" aria-label="Search">
               <i class="fas fa-search" aria-hidden="true"></i>
               </button>
               <button type="button" class="search-close" id="searchClose" aria-label="Close search">
               <i class="fas fa-times" aria-hidden="true"></i>
               </button>
            </form>
            <div class="search-chips" aria-label="Quick search shortcuts">
               <div class="search-suggestions__title">Quick</div>
               <div class="search-suggestion-chips">
                  <button type="button" class="search-chip" data-query="critical info">
                  <i class="fas fa-triangle-exclamation" aria-hidden="true"></i> Critical Info
                  </button>
                  <button type="button" class="search-chip" data-query="today plan">
                  <i class="fas fa-calendar-day" aria-hidden="true"></i> Today's Plan
                  </button>
                  <button type="button" class="search-chip" data-query="emergency">
                  <i class="fas fa-phone" aria-hidden="true"></i> Emergency
                  </button>
               </div>
            </div>
            <div class="search-suggestions" id="searchSuggestions" aria-live="polite" aria-atomic="false">
               <div class="search-suggestions__group">
                  <div class="search-suggestions__title">Suggested</div>
                  <div class="search-suggestion-chips" id="suggestedSearchChips">
                     <button type="button" class="search-chip" data-query="What time do I board?">What time do I board?</button>
                     <button type="button" class="search-chip" data-query="Where is my room?">Where is my room?</button>
                     <button type="button" class="search-chip" data-query="eMuster Station F6">eMuster Station F6</button>
                     <button type="button" class="search-chip" data-query="Dining reservations">Dining reservations</button>
                     <button type="button" class="search-chip" data-query="Shore excursions">Shore excursions</button>
                  </div>
               </div>
               <div class="search-suggestions__group" id="recentSearchesGroup" hidden>
                  <div class="search-suggestions__title">Recent</div>
                  <div class="search-suggestion-chips" id="recentSearchChips"></div>
               </div>
            </div>
            <div class="search-results" id="searchResults" aria-live="polite">
               <div class="no-results">
                  <p>Type to search for cruise information‚Ä¶</p>
               </div>
            </div>
         </div>
      </div>
      <!-- Section Drawer (Mobile Navigation) -->
      <div class="section-drawer-overlay" id="sectionDrawerOverlay" aria-hidden="true"></div>
      <aside
         class="section-drawer"
         id="sectionDrawer"
         role="dialog"
         aria-modal="true"
         aria-hidden="true"
         aria-labelledby="sectionDrawerTitle"
         tabindex="-1"
         >
         <div class="section-drawer__header">
            <div class="section-drawer__title-wrap">
               <span class="section-drawer__title" id="sectionDrawerTitle">Navigate</span>
               <span class="section-drawer__subtitle" aria-hidden="true">Cruise Companion</span>
            </div>
            <button
               class="section-drawer__close"
               id="sectionDrawerClose"
               type="button"
               aria-label="Close navigation drawer"
               >
            <i class="fas fa-times" aria-hidden="true"></i>
            </button>
         </div>
         <nav class="section-drawer__list" aria-label="Sections">
            <button class="drawer-nav-item" type="button" data-section="overview">
            <span class="drawer-label"><i class="fas fa-home" aria-hidden="true"></i>Start Here</span>
            <span class="drawer-badge" aria-hidden="true">Home</span>
            </button>
            <button class="drawer-nav-item" type="button" data-section="operations">
            <span class="drawer-label"><i class="fas fa-compass" aria-hidden="true"></i>Operations Manual</span>
            <span class="drawer-badge drawer-badge--critical">Critical</span>
            </button>
            <button class="drawer-nav-item" type="button" data-section="itinerary">
            <span class="drawer-label"><i class="fas fa-calendar-alt" aria-hidden="true"></i>Itinerary</span>
            <span class="drawer-badge" aria-hidden="true">Daily</span>
            </button>
            <button class="drawer-nav-item" type="button" data-section="rooms">
            <span class="drawer-label"><i class="fas fa-bed" aria-hidden="true"></i>Rooms</span>
            <span class="drawer-badge" aria-hidden="true">Keys</span>
            </button>
            <button class="drawer-nav-item" type="button" data-section="deck-plans">
            <span class="drawer-label"><i class="fas fa-map" aria-hidden="true"></i>Deck Plans</span>
            <span class="drawer-badge" aria-hidden="true">Maps</span>
            </button>
            <button class="drawer-nav-item" type="button" data-section="dining">
            <span class="drawer-label"><i class="fas fa-utensils" aria-hidden="true"></i>Dining</span>
            <span class="drawer-badge" aria-hidden="true">Plan</span>
            </button>
            <button class="drawer-nav-item" type="button" data-section="communication">
            <span class="drawer-label"><i class="fas fa-comments-dollar" aria-hidden="true"></i>Comms &amp; Budget</span>
            <span class="drawer-badge" aria-hidden="true">Money</span>
            </button>
            <button class="drawer-nav-item" type="button" data-section="tips">
            <span class="drawer-label"><i class="fas fa-lightbulb" aria-hidden="true"></i>Pro Tips</span>
            <span class="drawer-badge" aria-hidden="true">Smart</span>
            </button>
            <button class="drawer-nav-item" type="button" data-section="integrate">
            <span class="drawer-label"><i class="fas fa-star" aria-hidden="true"></i>VIP Upgrades</span>
            <span class="drawer-badge drawer-badge--vip">VIP</span>
            </button>
         </nav>
         <div class="section-drawer__footer" aria-hidden="true">
            <div class="section-drawer__footer-row">
               <i class="fas fa-ship" aria-hidden="true"></i>
               Adventure of the Seas ‚Ä¢ Feb 14‚Äì20, 2026
            </div>
            <div class="section-drawer__footer-row">
               <i class="fas fa-circle-info" aria-hidden="true"></i>
               Tap a section to jump instantly.
            </div>
         </div>
      </aside>
      <!-- Hero Section -->
      <section class="hero" aria-labelledby="heroTitle">
         <div class="container">
            <div class="hero__content">
               <div class="hero__badge-row" aria-hidden="true">
                  <span class="hero__badge"><span class="emoji" aria-hidden="true">üö¢</span> Adventure of the Seas</span>
                  <span class="hero__badge"><span class="emoji" aria-hidden="true">üå¥</span> Western Caribbean</span>
                  <span class="hero__badge hero__badge--gold"><span class="emoji" aria-hidden="true">üóìÔ∏è</span> Feb 14‚Äì20, 2026</span>
               </div>
               <h1 id="heroTitle" class="hero__title">Your Caribbean Cruise Adventure</h1>
               <p class="hero__subtitle">
                  Rahe Family &amp; Friends ‚Ä¢ Adventure of the Seas ‚Ä¢ February 14‚Äì20, 2026
               </p>
               <!-- Countdown Timer -->
               <div class="countdown" role="timer" aria-live="polite" aria-label="Countdown to cruise departure">
                  <div class="countdown-item">
                     <span class="countdown-number" id="days">12</span>
                     <span class="countdown-label">Days</span>
                  </div>
                  <div class="countdown-item">
                     <span class="countdown-number" id="hours">1</span>
                     <span class="countdown-label">Hours</span>
                  </div>
                  <div class="countdown-item">
                     <span class="countdown-number" id="minutes">52</span>
                     <span class="countdown-label">Minutes</span>
                  </div>
               </div>
               <!-- Quick Actions -->
               <div class="hero__actions" role="group" aria-label="Quick actions">
                  <button class="btn btn--primary" id="criticalChecklistBtn" type="button">
                  <i class="fas fa-clipboard-check" aria-hidden="true"></i>
                  Complete Pre-Cruise Checklist
                  </button>
                  <button class="btn btn--primary" id="printBtn" type="button">
                  <i class="fas fa-print" aria-hidden="true"></i>
                  Print Itinerary
                  </button>
                  <button class="btn btn--ghost" id="offlineBtn" type="button">
                  <i class="fas fa-download" aria-hidden="true"></i>
                  Save Offline
                  </button>
                  <button class="btn btn--ghost" id="shareBtn" type="button">
                  <i class="fas fa-share-alt" aria-hidden="true"></i>
                  Share
                  </button>
               </div>
               <div class="hero__stats" aria-label="Cruise summary">
                  <span class="stat"><strong>14</strong> Travelers</span>
                  <span class="stat"><strong>5</strong> Staterooms</span>
                  <span class="stat"><strong>3</strong> Ports</span>
                  <span class="stat"><strong>6</strong> Nights</span>
               </div>
               <div class="rc-key-benefits" aria-label="Royal Caribbean The Key benefits">
                  <div class="key-benefit">
                     <span class="emoji" aria-hidden="true">üîë</span>
                     <span>The Key¬Æ ‚Ä¢ Priority Boarding ‚Ä¢ 11:00 AM</span>
                  </div>
                  <div class="key-benefit">
                     <span class="emoji" aria-hidden="true">üì∂</span>
                     <span>VOOM¬Æ Surf + Stream ‚Ä¢ 1 Device</span>
                  </div>
               </div>
            </div>
         </div>
         <div class="rc-wave-bg" aria-hidden="true"></div>
      </section>
      <!-- Day Selector -->
      <div class="day-selector day-selector--hidden" id="daySelector">
         <div class="container">
            <nav class="day-nav" aria-label="Day navigation">
               <button class="day-btn active" data-day="all">All Days</button>
               <button class="day-btn" data-day="1">Day 1: Port Canaveral</button>
               <button class="day-btn" data-day="2">Day 2: Cruising</button>
               <button class="day-btn" data-day="3">Day 3: George Town</button>
               <button class="day-btn" data-day="4">Day 4: Falmouth</button>
               <button class="day-btn" data-day="5">Day 5: Cruising</button>
               <button class="day-btn" data-day="6">Day 6: Perfect Day at CocoCay</button>
               <button class="day-btn" data-day="7">Day 7: Return</button>
            </nav>
         </div>
      </div>
      <!-- Traveler Selector -->
      <div class="traveler-selector" id="travelerSelector">
         <div class="container">
            <label for="travelerSelect" class="traveler-label">View for:</label>
            <select id="travelerSelect" aria-label="Select traveler view">
               <option value="all">üë• All Travelers</option>
               <option value="family">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family View</option>
               <option value="adults">üë®‚Äçüë©‚Äçüë¶ Adults Only</option>
               <option value="kids">üßí Kids Activities</option>
            </select>
         </div>
      </div>
      <!-- Main Content -->
      <main id="main-content" class="main" role="main">
         <div class="container">
            <div class="main-layout">
               <!-- Left Column - Main Content -->
               <div class="main-content">
                  <!-- Toast Notification -->
                  <div class="toast" id="toast" role="alert" aria-live="polite" aria-atomic="true">
                     <span class="toast__message" id="toastMessage">Welcome to your Cruise Companion Hub! üö¢</span>
                     <button class="toast__close" id="toastClose" aria-label="Close notification">
                     <i class="fas fa-times" aria-hidden="true"></i>
                     </button>
                  </div>
                  <!-- TODAY SECTION (Dynamic - Changes based on current date) -->
                  <section id="today" class="section section--pinned section--critical" aria-labelledby="todayTitle">
                     <div class="card card--featured">
                        <div class="card__header">
                           <div class="card__icon" aria-hidden="true">
                              <i class="fas fa-calendar-day"></i>
                           </div>
                           <div>
                              <h2 id="todayTitle" class="card__title">Today: Preparation Mode</h2>
                              <p class="card__subtitle">12 days until embarkation ‚Ä¢ Focus on these essentials</p>
                           </div>
                        </div>
                        <div class="card__content">
                           <div class="today-timeline">
                              <div class="today-task today-task--critical">
                                 <div class="task-time">This Week</div>
                                 <div class="task-content">
                                    <h3>Complete Online Check-in</h3>
                                    <p>Opens ~Dec 31. Upload photos, select 11:00 AM arrival time</p>
                                    <button class="btn btn--outline btn--sm">
                                       <i class="fas fa-external-link-alt" aria-hidden="true"></i>
                                       Open Check-in
                                    </button>
                                 </div>
                              </div>
                              <div class="today-task today-task--important">
                                 <div class="task-time">This Week</div>
                                 <div class="task-content">
                                    <h3>Link All Bookings in Royal App</h3>
                                    <p>Ensure all 5 staterooms appear. Enable notifications.</p>
                                    <div class="task-checklist">
                                       <label><input type="checkbox"> Downloaded Royal Caribbean app</label>
                                       <label><input type="checkbox"> Linked booking #12345678</label>
                                       <label><input type="checkbox"> Created family chat group</label>
                                    </div>
                                 </div>
                              </div>
                              <div class="today-task">
                                 <div class="task-time">Before Feb 1</div>
                                 <div class="task-content">
                                    <h3>Reserve Shore Excursions</h3>
                                    <p>Priority: Dunn's River Falls + Dragon's Breath zip-line</p>
                                    <button class="btn btn--outline btn--sm" data-section="itinerary" type="button">
                                       View Port Details
                                    </button>
                                 </div>
                              </div>
                              <div class="today-task">
                                 <div class="task-time">Before Feb 1</div>
                                 <div class="task-content">
                                    <h3>Book Specialty Dining</h3>
                                    <p>Chops Grille, Izumi, Giovanni's ‚Ä¢ 2 formal nights</p>
                                    <button class="btn btn--outline btn--sm" data-section="dining" type="button">
                                       See Dining Options
                                    </button>
                                 </div>
                              </div>
                              <div class="comm-block">
                                 <h3>üßæ Policies &amp; Gratuities</h3>
                                 <ul class="list list--icon">
                                    <li>
                                       <i class="fas fa-dollar-sign" aria-hidden="true"></i>
                                       <span><strong>Gratuities:</strong> $18.50 pp/day ($21 suites)</span>
                                    </li>
                                    <li>
                                       <i class="fas fa-wine-bottle" aria-hidden="true"></i>
                                       <span><strong>Alcohol:</strong> 1 sealed 750ml wine per adult</span>
                                    </li>
                                    <li>
                                       <i class="fas fa-smoking" aria-hidden="true"></i>
                                       <span><strong>Smoking:</strong> Port side Deck 11 + Casino</span>
                                    </li>
                                 </ul>
                              </div>
                           </div>
                           <div class="note note--info mt-8">
                              <strong>Budget Tip:</strong> Review SeaPass charges nightly via app or cabin TV. Use shared Google Sheet for real-time expense tracking.
                           </div>
                        </div>
                     </div>
                  </section>
                  <!-- Quick Start Guide -->
                  <section id="quick-start" class="section section--critical" aria-labelledby="quickStartTitle">
                     <div class="card quick-start">
                        <div class="card__header">
                           <div class="card__icon" aria-hidden="true">
                              <i class="fas fa-bolt"></i>
                           </div>
                           <div>
                              <h2 id="quickStartTitle" class="card__title">Quick Start Guide</h2>
                              <p class="card__subtitle">Five essentials to handle first, with fewer clicks</p>
                           </div>
                        </div>
                        <ul class="quick-start__list">
                           <li class="quick-start__item">
                              <span class="quick-start__item-showcase" aria-hidden="true">üß≠</span>
                              <div>
                                 <strong>Confirm embarkation timeline.</strong>
                                 <p class="text-sm mb-0">Arrive early, regroup before lunch, departure at 2:00 PM.</p>
                              </div>
                           </li>
                           <li class="quick-start__item">
                              <span class="quick-start__item-showcase" aria-hidden="true">üõü</span>
                              <div>
                                 <strong>Complete eMuster &amp; safety checklist.</strong>
                                 <p class="text-sm mb-0">Finish the important checklist in the Guide highlights.</p>
                              </div>
                           </li>
                           <li class="quick-start__item">
                              <span class="quick-start__item-showcase" aria-hidden="true">üè∑Ô∏è</span>
                              <div>
                                 <strong>Verify rooms and muster stations.</strong>
                                 <p class="text-sm mb-0">Confirm stateroom assignments and station F6 in the Rooms section.</p>
                              </div>
                           </li>
                           <li class="quick-start__item">
                              <span class="quick-start__item-showcase" aria-hidden="true">üóìÔ∏è</span>
                              <div>
                                 <strong>Scan the day-by-day itinerary.</strong>
                                 <p class="text-sm mb-0">Check port plans and all-aboard times for each day.</p>
                              </div>
                           </li>
                           <li class="quick-start__item">
                              <span class="quick-start__item-showcase" aria-hidden="true">üì∂</span>
                              <div>
                                 <strong>Get connected fast.</strong>
                                 <p class="text-sm mb-0">Join the Royal app chat + connect to Royal-WiFi.</p>
                              </div>
                           </li>
                        </ul>
                        <div class="quick-start__actions">
                           <button class="btn btn--primary quick-start__link" data-section="operations">
                           <i class="fas fa-clipboard-check" aria-hidden="true"></i>
                           Open Important Checklist
                           </button>
                           <button class="btn btn--outline quick-start__link" data-section="itinerary">
                           <i class="fas fa-route" aria-hidden="true"></i>
                           View Itinerary
                           </button>
                           <button class="btn btn--outline quick-start__link" data-section="rooms">
                           <i class="fas fa-bed" aria-hidden="true"></i>
                           Rooms &amp; Muster
                           </button>
                           <div class="critical-toggle" aria-live="polite">
                              <button class="btn btn--outline" id="criticalToggleBtn" aria-pressed="false">
                              <i class="fas fa-filter" aria-hidden="true"></i>
                              Important Info Only
                              </button>
                              <span class="critical-toggle__status" id="criticalToggleStatus">Showing all sections</span>
                           </div>
                        </div>
                     </div>
                  </section>
                  <!-- Overview Section -->
                  <section id="overview" class="section" aria-labelledby="overviewTitle">
                     <div class="card">
                        <div class="card__header">
                           <div class="card__icon" aria-hidden="true">
                              <i class="fas fa-info-circle"></i>
                           </div>
                           <div>
                              <h2 id="overviewTitle" class="card__title">Cruise Overview &amp; Details</h2>
                              <p class="card__subtitle">Complete trip information and booking details</p>
                           </div>
                           <button class="card__toggle" aria-expanded="false" aria-controls="overviewContent">
                              <i class="fas fa-chevron-down" aria-hidden="true"></i>
                              <span class="sr-only">Toggle section</span>
                           </button>
                        </div>
                        <div id="overviewContent" class="card__content collapsed">
                           <div class="grid-2">
                              <div class="rc-card">
                                 <span class="rc-badge">Royal Amplified‚Ñ¢ ‚Ä¢ Voyager Class</span>
                                 <h3 class="rc-headline" style="margin:14px 0 8px;">Official Booking Snapshot</h3>
                                 <p class="rc-body mb-0">SeaPass¬Æ linked ‚Ä¢ Adventure of the Seas ‚Ä¢ Booking #: 12345678</p>
                                 <p class="rc-caption" style="margin:8px 0 0;">Health &amp; Safety ‚Ä¢ eMuster¬Æ required by 4:00 PM</p>
                              </div>
                              <div class="perfect-day-card">
                                 <div style="position:relative;z-index:1;margin-top:40px;">
                                    <p class="rc-body" style="color:rgba(255,255,255,.9);margin:0 0 12px;">Thrill Waterpark + Oasis Lagoon access included for Day 6.</p>
                                    <span class="rc-badge">Perfect Day at CocoCay¬Æ</span>
                                 </div>
                              </div>
                           </div>
                           <div class="grid-2 mt-8">
                              <div class="overview-block">
                                 <h3 class="overview-block__title">Trip Essentials</h3>
                                 <ul class="list list--icon">
                                    <li>
                                       <i class="fas fa-map-marked-alt" aria-hidden="true"></i>
                                       <span>Ports: George Town, Grand Cayman ‚Ä¢ Falmouth, Jamaica ‚Ä¢ Perfect Day at CocoCay</span>
                                    </li>
                                    <li>
                                       <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                                       <span>Feb 14-20, 2026 ‚Ä¢ 6 nights ‚Ä¢ Round-trip Port Canaveral</span>
                                    </li>
                                    <li>
                                       <i class="fas fa-ship" aria-hidden="true"></i>
                                       <span>Adventure of the Seas ‚Ä¢ Voyager Class ‚Ä¢ 137,276 GT ‚Ä¢ Amplified 2018</span>
                                    </li>
                                 </ul>
                              </div>
                              <div class="overview-block">
                                 <h3 class="overview-block__title">Why This Sailing?</h3>
                                 <ul class="list list--icon">
                                    <li>
                                       <i class="fas fa-umbrella-beach" aria-hidden="true"></i>
                                       <span>Perfect Day thrills: Thrill Waterpark + Oasis Lagoon</span>
                                    </li>
                                    <li>
                                       <i class="fas fa-hiking" aria-hidden="true"></i>
                                       <span>Bucket-list: Dunn's River Falls + Dragon's Breath zip-line</span>
                                    </li>
                                    <li>
                                       <i class="fas fa-bolt" aria-hidden="true"></i>
                                       <span>Amplified ship: Typhoon &amp; Cyclone racers, FlowRider, laser-tag</span>
                                    </li>
                                 </ul>
                              </div>
                           </div>
                           <div class="rc-app-integration mt-8">
                              <div class="app-qr-code">
                                 <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 160 160'><defs><linearGradient id='bg' x1='0' y1='0' x2='1' y2='1'><stop offset='0%25' stop-color='%230b2c4a'/><stop offset='100%25' stop-color='%23144a7a'/></linearGradient><linearGradient id='screen' x1='0' y1='0' x2='0' y2='1'><stop offset='0%25' stop-color='%232a6ea6'/><stop offset='100%25' stop-color='%230b2c4a'/></linearGradient></defs><rect width='160' height='160' rx='24' fill='url(%23bg)'/><rect x='46' y='18' width='68' height='124' rx='18' fill='%2306192b' stroke='rgba(255,255,255,0.35)' stroke-width='2'/><rect x='56' y='34' width='48' height='76' rx='12' fill='url(%23screen)'/><circle cx='80' cy='118' r='8' fill='%2336c2ff'/><path d='M60 78c8-10 28-10 36 0' stroke='%23ffffff' stroke-width='3' fill='none' stroke-linecap='round' opacity='0.8'/><path d='M60 90c8-10 28-10 36 0' stroke='%23ffce6b' stroke-width='3' fill='none' stroke-linecap='round' opacity='0.9'/><text x='80' y='148' font-family='Montserrat, Arial, sans-serif' font-size='12' fill='%23d9f3ff' text-anchor='middle'>Royal Caribbean App</text></svg>" alt="Royal Caribbean App">
                              </div>
                              <div class="app-features">
                                 <h3><span class="emoji" aria-hidden="true">üì±</span> Royal Caribbean App</h3>
                                 <ul>
                                    <li><span class="emoji" aria-hidden="true">‚úÖ</span> Linked to your booking</li>
                                    <li><span class="emoji" aria-hidden="true">üí¨</span> Free onboard messaging</li>
                                    <li><span class="emoji" aria-hidden="true">üóìÔ∏è</span> Daily schedule updates</li>
                                    <li><span class="emoji" aria-hidden="true">üó∫Ô∏è</span> Interactive deck plans</li>
                                 </ul>
                                 <button class="rc-btn" type="button">
                                    <span class="emoji" aria-hidden="true">üîó</span> Open in Royal App
                                 </button>
                              </div>
                           </div>
                           <div class="official-muster-info mt-8">
                              <div class="muster-header">
                                 <h3><span class="emoji" aria-hidden="true">‚öì</span> Official Muster Station</h3>
                                 <div class="muster-badge">F6</div>
                              </div>
                              <div class="muster-details">
                                 <p><strong>Deck 4 ‚Ä¢ Starboard Side</strong></p>
                                 <p>Complete eMuster¬Æ in Royal App before 4:00 PM on embarkation day.</p>
                                 <div class="muster-progress">
                                    <div class="progress-track">
                                       <div class="progress-bar" style="width: 75%"></div>
                                    </div>
                                    <span>3/4 Guests Complete</span>
                                 </div>
                              </div>
                           </div>
                           <div class="rc-progress-tracker mt-8">
                              <h4><span class="emoji" aria-hidden="true">‚úÖ</span> Cruise Checklist</h4>
                              <div class="tracker-item">
                                 <span>Online Check-in</span>
                                 <div class="tracker-status completed">
                                    <span class="emoji" aria-hidden="true">‚úÖ</span> Complete
                                 </div>
                              </div>
                              <div class="tracker-item">
                                 <span>Excursions Booked</span>
                                 <div class="tracker-status in-progress" style="--progress: 60%">
                                    <div class="progress-bar"></div>
                                    3/5 Booked
                                 </div>
                              </div>
                              <div class="tracker-item">
                                 <span>Dining Reservations</span>
                                 <div class="tracker-status pending">
                                    <span class="emoji" aria-hidden="true">‚è≥</span> Opens Dec 31
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                  </section>
                  <!-- Deck Plans Section -->
                  <section id="deck-plans" class="section" aria-labelledby="deckPlansTitle">
                     <div class="card">
                        <div class="card__header">
                           <div class="card__icon" aria-hidden="true">
                              <i class="fas fa-map"></i>
                           </div>
                           <div>
                              <h2 id="deckPlansTitle" class="card__title">Deck Plans &amp; Ship Maps</h2>
                              <p class="card__subtitle">Interactive maps and offline reference</p>
                           </div>
                           <button class="card__toggle" aria-expanded="false" aria-controls="deckPlansContent">
                              <i class="fas fa-chevron-down" aria-hidden="true"></i>
                              <span class="sr-only">Toggle section</span>
                           </button>
                        </div>
                        <div id="deckPlansContent" class="card__content collapsed">
                           <p class="mb-4">Recommended: Open the Royal Caribbean app and tap <strong>Deck Plans</strong> for interactive zoom, venue search, and real-time navigation.</p>
                           <div class="deck-plan-actions">
                              <a class="btn btn--primary" href="https://apps.apple.com/us/app/royal-caribbean-international/id1260728016" target="_blank" rel="noopener noreferrer">
                                 <i class="fas fa-mobile-alt" aria-hidden="true"></i>
                                 Open Royal App
                              </a>
                              <button class="btn btn--outline" id="deckPlanClearBtn" type="button">
                                 <i class="fas fa-trash-alt" aria-hidden="true"></i>
                                 Clear Saved Plans
                              </button>
                           </div>
                           <div class="deck-plan-upload mt-6">
                              <strong>Add deck plan images for offline reference</strong>
                              <p class="text-sm mb-4">Upload deck plan images and they will be saved on this device for quick access.</p>
                              <input type="file" id="deckPlanUpload" accept="image/*" multiple>
                              <p class="deck-plan-meta">Tip: Upload smaller images for faster loading.</p>
                           </div>
                           <div class="deck-plans-grid" id="deckPlansGrid" aria-live="polite">
                              <div class="deck-plan-card deck-plan-card--placeholder">
                                 <strong>No deck plans saved yet.</strong>
                                 <p class="mb-0">Upload images above, or use the Royal Caribbean app for the official interactive map.</p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </section>
                  <!-- Guide Section -->
                  <section id="operations" class="section section--critical print-section" data-print-title="Critical Operations Guide" aria-labelledby="operationsTitle">
                     <div class="card card--featured">
                        <div class="card__header">
                           <div class="card__icon" aria-hidden="true">
                              <i class="fas fa-compass"></i>
                           </div>
                           <div>
                              <h2 id="operationsTitle" class="card__title">Operations Manual</h2>
                              <p class="card__subtitle">Essential protocols and checklists</p>
                           </div>
                        </div>
                        <div class="card__content">
                           <div class="critical-checklist" id="critical-checklist">
                              <h3 class="text-2xl font-bold mb-6">
                                 <i class="fas fa-exclamation-triangle text-warning" aria-hidden="true"></i>
                                 Embarkation Day Must-Dos (In Order)
                              </h3>
                              <div class="checklist-timeline">
                                 <div class="checklist-item critical-item">
                                    <span class="checklist-time">11:00 AM</span>
                                    <span class="checklist-icon" aria-hidden="true">
                                       <i class="fas fa-ship"></i>
                                    </span>
                                    <div class="checklist-content">
                                       <div class="checklist-title">Arrive at Terminal</div>
                                       <p class="checklist-description">SetSail pass + passport ready. The Key¬Æ allows 11:00 AM arrival.</p>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="card mt-8">
                              <div id="critical-checklist" tabindex="-1"></div>
                              <h3 class="text-2xl font-bold mb-6">Embarkation Day Must-Dos (In Order)</h3>
                              <div class="checklist" id="criticalChecklist">
                                 <div class="checklist-item critical-item">
                                    <span class="checklist-time">12:00 PM</span>
                                    <span class="checklist-icon" aria-hidden="true">
                                       <i class="fas fa-users"></i>
                                    </span>
                                    <div class="checklist-content">
                                       <div class="checklist-title">The Huddle - Deck 4/5 Promenade</div>
                                       <p class="checklist-description">Group meetup. No dispersing until all tasks complete.</p>
                                    </div>
                                 </div>
                                 <div class="checklist-item critical-item">
                                    <span class="checklist-time">12:05 PM</span>
                                    <span class="checklist-icon" aria-hidden="true">
                                       <i class="fas fa-wifi"></i>
                                    </span>
                                    <div class="checklist-content">
                                       <div class="checklist-title">Connect to ROYAL-WIFI + App Chat</div>
                                       <p class="checklist-description">Create family group chat; confirm all bookings linked</p>
                                    </div>
                                 </div>
                                 <div class="checklist-item critical-item">
                                    <span class="checklist-time">12:10 PM</span>
                                    <span class="checklist-icon" aria-hidden="true">
                                       <i class="fas fa-utensils"></i>
                                    </span>
                                    <div class="checklist-content">
                                       <div class="checklist-title">Priority Dining Reservations</div>
                                       <p class="checklist-description">Book specialty dining + any reservable shows at Promenade desk</p>
                                    </div>
                                 </div>
                                 <div class="checklist-item critical-item">
                                    <span class="checklist-time">12:30 PM</span>
                                    <span class="checklist-icon" aria-hidden="true">
                                       <i class="fas fa-life-ring"></i>
                                    </span>
                                    <div class="checklist-content">
                                       <div class="checklist-title">Complete eMuster 2.0</div>
                                       <p class="checklist-description">Watch safety video in app, then scan SeaPass at Station F6 (Deck 4). Due by 4:00 PM.</p>
                                    </div>
                                 </div>
                                 <div class="checklist-item critical-item">
                                    <span class="checklist-time">1:00 PM</span>
                                    <span class="checklist-icon" aria-hidden="true">
                                       <i class="fas fa-check-circle"></i>
                                    </span>
                                    <div class="checklist-content">
                                       <div class="checklist-title">Golden Hour Complete</div>
                                       <p class="checklist-description">Lunch + explore. Cabins ready ~1:30 PM. Regroup at 3:00 PM.</p>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="operations-block mt-8">
                              <h3 class="operations-block__title">Pre-Cruise Checklist</h3>
                              <div class="checklist">
                                 <div class="checklist-item">
                                    <span class="checklist-icon" aria-hidden="true">
                                       <i class="fas fa-check-circle"></i>
                                    </span>
                                    <div class="checklist-content">
                                       <div class="checklist-title">Royal App Access</div>
                                       <p class="checklist-description">All adults downloaded + linked to booking</p>
                                    </div>
                                 </div>
                                 <div class="checklist-item">
                                    <span class="checklist-icon" aria-hidden="true">
                                       <i class="fas fa-id-card"></i>
                                    </span>
                                    <div class="checklist-content">
                                       <div class="checklist-title">Online Check-in</div>
                                       <p class="checklist-description">Upload photos + select 11:00 AM arrival</p>
                                    </div>
                                 </div>
                                 <div class="checklist-item">
                                    <span class="checklist-icon" aria-hidden="true">
                                       <i class="fas fa-link"></i>
                                    </span>
                                    <div class="checklist-content">
                                       <div class="checklist-title">Link Bookings</div>
                                       <p class="checklist-description">Confirm all staterooms appear in the app</p>
                                    </div>
                                 </div>
                                 <div class="checklist-item">
                                    <span class="checklist-icon" aria-hidden="true">
                                       <i class="fas fa-passport"></i>
                                    </span>
                                    <div class="checklist-content">
                                       <div class="checklist-title">Documents &amp; Backup</div>
                                       <p class="checklist-description">Passports valid past Aug 2026. Print SetSail + luggage tags</p>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="operations-block mt-8">
                              <h3 class="operations-block__title">Daily Rhythm</h3>
                              <ul class="list list--icon">
                                 <li>
                                    <i class="fas fa-coffee" aria-hidden="true"></i>
                                    <span><strong>7:30‚Äì9:00 AM</strong> Breakfast + plan review</span>
                                 </li>
                                 <li>
                                    <i class="fas fa-route" aria-hidden="true"></i>
                                    <span><strong>10:00 AM</strong> Choose Path (Adventure/Culture/Chill)</span>
                                 </li>
                                 <li>
                                    <i class="fas fa-sun" aria-hidden="true"></i>
                                    <span><strong>1:00‚Äì4:00 PM</strong> Lunch + flex time</span>
                                 </li>
                                 <li>
                                    <i class="fas fa-glass-martini-alt" aria-hidden="true"></i>
                                    <span><strong>6:45 PM</strong> R Bar meetup (mandatory)</span>
                                 </li>
                                 <li>
                                    <i class="fas fa-moon" aria-hidden="true"></i>
                                    <span><strong>7:30 PM+</strong> Dinner, show, or music</span>
                                 </li>
                              </ul>
                           </div>
                           <div class="operations-block mt-8">
                              <h3 class="operations-block__title">Port Strategy</h3>
                              <div class="port-cards-horizontal">
                                 <div class="port-card">
                                    <div class="port-card__image" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                       <div class="port-card__icon">ü™Ç</div>
                                    </div>
                                    <div class="port-card__content">
                                       <h4>Perfect Day at CocoCay</h4>
                                       <p>Thrill Waterpark early, beach afternoon. All-day access included.</p>
                                       <div class="port-card__tags">
                                          <span class="tag tag--essential">All-Day Access</span>
                                          <span class="tag tag--time">7:30 AM - 4:30 PM</span>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="note note--info mt-8">
                              <strong>Golden Hour Protocol:</strong> Onboard control within 60 minutes of boarding. Follow the timeline above to maximize Day 1.
                           </div>
                        </div>
                     </div>
                  </section>
                  <!-- Rooms Section -->
                  <section id="rooms" class="section section--critical" aria-labelledby="roomsTitle">
                     <div class="card">
                        <div class="card__header">
                           <div class="card__icon" aria-hidden="true">
                              <i class="fas fa-door-closed"></i>
                           </div>
                           <div>
                              <h2 id="roomsTitle" class="card__title">Your Staterooms</h2>
                              <p class="card__subtitle">Where everyone will stay during the cruise</p>
                           </div>
                           <button class="card__toggle" aria-expanded="false" aria-controls="roomsContent">
                           <i class="fas fa-chevron-down" aria-hidden="true"></i>
                           <span class="sr-only">Toggle section</span>
                           </button>
                        </div>
                        <div id="roomsContent" class="card__content collapsed">
                           <p class="mb-6">Here's where everyone will be staying during the cruise. All rooms include interactive TV, a mini-safe, and Royal Dream bedding. Suites add an espresso maker and concierge access.</p>
                           <div class="table-responsive mb-8">
                              <table class="info-table">
                                 <thead>
                                    <tr>
                                       <th>Stateroom</th>
                                       <th>Type &amp; Size</th>
                                       <th>Deck &amp; Notes</th>
                                       <th>Guests</th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr>
                                       <td><strong>6650</strong></td>
                                       <td>Balcony ‚Ä¢ 198 sq ft + 46 sq ft deck</td>
                                       <td>Deck 6 ‚Ä¢ Connecting to 6652</td>
                                       <td>Bill, Melissa, Owen, Declan</td>
                                    </tr>
                                    <tr>
                                       <td><strong>6443</strong></td>
                                       <td>Interior ‚Ä¢ 160 sq ft</td>
                                       <td>Deck 6 ‚Ä¢ Opposite laundry</td>
                                       <td>Abel, Amy</td>
                                    </tr>
                                    <tr>
                                       <td><strong>4B 8528</strong></td>
                                       <td>Balcony</td>
                                       <td>Deck 8 ‚Ä¢ Midship access</td>
                                       <td>Aimee, Karin</td>
                                    </tr>
                                    <tr>
                                       <td><strong>2D 8612</strong></td>
                                       <td>Ocean View Balcony</td>
                                       <td>Deck 8 ‚Ä¢ Quiet aft corridor</td>
                                       <td>Bella, TJ</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <div class="note note--info mb-8">
                              <strong>Final stateroom numbers</strong> can be updated once assigned. Keep the Royal app current so all guests see onboard chat and daily schedules.
                           </div>
                           <div class="room-grid">
                              <!-- Room 1 - Primary Room -->
                              <div class="room-card featured">
                                 <div class="room-header">
                                    <div>
                                       <div class="room-number">6650</div>
                                       <div class="room-location">
                                          <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                                          Deck 6 ‚Ä¢ Connecting to 6652
                                       </div>
                                    </div>
                                    <span class="tag tag--info">Primary Room</span>
                                 </div>
                                 <div class="room-guests">
                                    <p class="room-label">Guests:</p>
                                    <ul class="guest-list">
                                       <li>Bill</li>
                                       <li>Melissa</li>
                                       <li>Owen</li>
                                       <li>Declan</li>
                                    </ul>
                                 </div>
                                 <p><strong>Room Type:</strong> Balcony ‚Ä¢ 198 sq ft + 46 sq ft deck</p>
                                 <p class="mt-2"><strong>Location Tip:</strong> Easy access to aft elevators for dinner runs</p>
                              </div>
                              <!-- Room 2 - Interior Room -->
                              <div class="room-card">
                                 <div class="room-header">
                                    <div>
                                       <div class="room-number">6443</div>
                                       <div class="room-location">
                                          <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                                          Deck 6 ‚Ä¢ Opposite laundry
                                       </div>
                                    </div>
                                    <span class="tag tag--info">Interior Room</span>
                                 </div>
                                 <div class="room-guests">
                                    <p class="room-label">Guests:</p>
                                    <ul class="guest-list">
                                       <li>Abel</li>
                                       <li>Amy</li>
                                    </ul>
                                 </div>
                                 <p><strong>Room Type:</strong> Interior ‚Ä¢ 160 sq ft</p>
                                 <p class="mt-2"><strong>Note:</strong> Great for quick laundry swaps and mid-day breaks</p>
                              </div>
                              <!-- Room 3 - Pool Access -->
                              <div class="room-card">
                                 <div class="room-header">
                                    <div>
                                       <div class="room-number">4B 8528</div>
                                       <div class="room-location">
                                          <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                                          Deck 8 ‚Ä¢ Midship access
                                       </div>
                                    </div>
                                    <span class="tag tag--info">Pool Access</span>
                                 </div>
                                 <div class="room-guests">
                                    <p class="room-label">Guests:</p>
                                    <ul class="guest-list">
                                       <li>Aimee</li>
                                       <li>Karin</li>
                                    </ul>
                                 </div>
                                 <p><strong>Room Type:</strong> Balcony</p>
                                 <p class="mt-2"><strong>Location Tip:</strong> Quick walk to Royal Promenade elevators</p>
                              </div>
                              <!-- Room 4 - Ocean View -->
                              <div class="room-card">
                                 <div class="room-header">
                                    <div>
                                       <div class="room-number">8370</div>
                                       <div class="room-location">
                                          <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                                          Deck 8 ‚Ä¢ Ocean view balcony
                                       </div>
                                    </div>
                                    <span class="tag tag--info">Ocean View</span>
                                 </div>
                              <!-- Room 5 - Ocean View -->
                              <div class="room-card">
                                 <div class="room-header">
                                    <div>
                                       <div class="room-number">2D 8612</div>
                                       <div class="room-location">
                                          <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                                          Deck 8 ‚Ä¢ Quiet aft corridor
                                       </div>
                                    </div>
                                    <span class="tag tag--info">Ocean View</span>
                                 </div>
                                 <div class="room-guests">
                                    <p class="room-label">Guests:</p>
                                    <ul class="guest-list">
                                       <li>Bella</li>
                                       <li>TJ</li>
                                    </ul>
                                 </div>
                                 <p><strong>Room Type:</strong> Ocean View Balcony</p>
                                 <p class="mt-2"><strong>Location Tip:</strong> Peaceful evenings away from promenade traffic</p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </section>
                  <!-- ITINERARY SECTION -->
                  <section id="itinerary" class="section section--critical" aria-labelledby="itineraryTitle">
                     <div class="card">
                        <div class="card__header">
                           <div class="card__icon" aria-hidden="true">
                              <i class="fas fa-calendar-alt"></i>
                           </div>
                           <div>
                              <h2 id="itineraryTitle" class="card__title">7-Day Itinerary</h2>
                              <p class="card__subtitle">Day-by-day adventure schedule</p>
                           </div>
                        </div>
                        <div class="card__content">
                           <div class="day-tabs" role="tablist" aria-label="Day selection">
                              <button class="day-tab active" role="tab" aria-selected="true" aria-controls="day-all-panel" data-day="all">All Days</button>
                              <button class="day-tab" role="tab" aria-selected="false" aria-controls="day-1-panel" data-day="1">Day 1</button>
                              <button class="day-tab" role="tab" aria-selected="false" aria-controls="day-2-panel" data-day="2">Day 2</button>
                              <button class="day-tab" role="tab" aria-selected="false" aria-controls="day-3-panel" data-day="3">Day 3</button>
                              <button class="day-tab" role="tab" aria-selected="false" aria-controls="day-4-panel" data-day="4">Day 4</button>
                              <button class="day-tab" role="tab" aria-selected="false" aria-controls="day-5-panel" data-day="5">Day 5</button>
                              <button class="day-tab" role="tab" aria-selected="false" aria-controls="day-6-panel" data-day="6">Day 6</button>
                              <button class="day-tab" role="tab" aria-selected="false" aria-controls="day-7-panel" data-day="7">Day 7</button>
                           </div>
                           <div class="timeline-vertical">
                              <div class="timeline-step" data-day="1">
                                 <div class="step-indicator step-indicator--port">
                                    <span class="step-day">Day 1</span>
                                    <span class="step-date">Feb 14</span>
                                 </div>
                                 <div class="step-content">
                                    <div class="step-header">
                                       <h3>Orlando (Port Canaveral), FL</h3>
                                       <span class="step-badge step-badge--departure">Departure 2:00 PM</span>
                                    </div>
                                    <div class="step-details">
                                       <div class="step-highlight">
                                          <strong>Embarkation Tips:</strong> Arrive by 10:30 AM for smoothest boarding
                                       </div>
                                       <div class="step-tasks">
                                          <h4>First Hour Tasks</h4>
                                          <ul>
                                             <li>Complete eMuster 2.0 before 4:00 PM</li>
                                             <li>Set up app chat with family group</li>
                                             <li>Book specialty dining at Promenade desk</li>
                                             <li>Grab lunch at Solarium Bistro (skip Windjammer crowds)</li>
                                          </ul>
                                       </div>
                                       <button class="btn btn--outline btn--sm step-expand" type="button">
                                          <i class="fas fa-chevron-down" aria-hidden="true"></i>
                                          Show More Details
                                       </button>
                                    </div>
                                 </div>
                              </div>
                              <div class="timeline-step" data-day="2">
                                 <div class="step-indicator step-indicator--sea">
                                    <span class="step-day">Day 2</span>
                                    <span class="step-date">Feb 15</span>
                                 </div>
                                 <div class="step-content">
                                    <div class="step-header">
                                       <h3>Cruising</h3>
                                       <span class="step-badge step-badge--sea">Sea Day</span>
                                    </div>
                                    <div class="step-details">
                                       <div class="step-highlight">
                                          <strong>Today's Signature:</strong> FlowRider clinic, Ice show "Cool Art", Cupcake decorating 3:00 PM
                                       </div>
                                       <button class="btn btn--outline btn--sm step-expand" type="button">
                                          <i class="fas fa-chevron-down" aria-hidden="true"></i>
                                          Show Activities
                                       </button>
                                    </div>
                                 </div>
                              </div>
                              <div class="timeline-step" data-day="3">
                                 <div class="step-indicator step-indicator--port">
                                    <span class="step-day">Day 3</span>
                                    <span class="step-date">Feb 16</span>
                                 </div>
                                 <div class="step-content">
                                    <div class="step-header">
                                       <h3>George Town, Grand Cayman</h3>
                                       <span class="step-badge step-badge--all-aboard">All Aboard 5:15 PM</span>
                                    </div>
                                    <div class="step-details">
                                       <div class="step-highlight">
                                          <strong>‚ö†Ô∏è Tender Port:</strong> Gangway 11:00 AM - 5:15 PM. Early tender recommended.
                                       </div>
                                       <div class="step-excursions">
                                          <h4>Top Excursions</h4>
                                          <ul>
                                             <li>Stingray City (3 hours)</li>
                                             <li>Seven Mile Beach (all day)</li>
                                             <li>Georgetown waterfront shopping</li>
                                          </ul>
                                       </div>
                                       <button class="btn btn--outline btn--sm step-expand" type="button">
                                          <i class="fas fa-chevron-down" aria-hidden="true"></i>
                                          Port Details
                                       </button>
                                    </div>
                                 </div>
                              </div>
                              <div class="timeline-step" data-day="4">
                                 <div class="step-indicator step-indicator--port">
                                    <span class="step-day">Day 4</span>
                                    <span class="step-date">Feb 17</span>
                                 </div>
                                 <div class="step-content">
                                    <div class="step-header">
                                       <h3>Falmouth, Jamaica</h3>
                                       <span class="step-badge step-badge--all-aboard">All Aboard 4:30 PM</span>
                                    </div>
                                    <div class="step-details">
                                       <div class="step-highlight">
                                          <strong>Must Pack:</strong> Water shoes, quick-dry gear. Gangway 8:30 AM - 4:30 PM
                                       </div>
                                       <div class="step-excursions">
                                          <h4>Recommended Combo</h4>
                                          <ul>
                                             <li>Dunn's River Falls + Blue Hole (6 hours)</li>
                                             <li>Dragon's Breath Flight Line</li>
                                             <li>Local cuisine at port area</li>
                                          </ul>
                                       </div>
                                       <button class="btn btn--outline btn--sm step-expand" type="button">
                                          <i class="fas fa-chevron-down" aria-hidden="true"></i>
                                          Port Details
                                       </button>
                                    </div>
                                 </div>
                              </div>
                              <div class="timeline-step" data-day="5">
                                 <div class="step-indicator step-indicator--sea">
                                    <span class="step-day">Day 5</span>
                                    <span class="step-date">Feb 18</span>
                                 </div>
                                 <div class="step-content">
                                    <div class="step-header">
                                       <h3>Cruising</h3>
                                       <span class="step-badge step-badge--formal">Formal Night #2</span>
                                    </div>
                                    <div class="step-details">
                                       <div class="step-highlight">
                                          <strong>Tonight:</strong> Captain's Gala, formal portraits, farewell events
                                       </div>
                                       <button class="btn btn--outline btn--sm step-expand" type="button">
                                          <i class="fas fa-chevron-down" aria-hidden="true"></i>
                                          Show Activities
                                       </button>
                                    </div>
                                 </div>
                              </div>
                              <div class="timeline-step" data-day="6">
                                 <div class="step-indicator step-indicator--port step-indicator--featured">
                                    <span class="step-day">Day 6</span>
                                    <span class="step-date">Feb 19</span>
                                 </div>
                                 <div class="step-content">
                                    <div class="step-header">
                                       <h3>Perfect Day at CocoCay</h3>
                                       <span class="step-badge step-badge--all-aboard">All Aboard 4:30 PM</span>
                                    </div>
                                    <div class="step-details">
                                       <div class="step-highlight">
                                          <strong>Strategy:</strong> Thrill Waterpark early morning, beach in afternoon. Gangway 7:30 AM - 4:30 PM
                                       </div>
                                       <div class="step-excursions">
                                          <h4>Included Experiences</h4>
                                          <ul>
                                             <li>Thrill Waterpark (Daredevil's Peak, slides)</li>
                                             <li>Oasis Lagoon (wave pool, swim-up bar)</li>
                                             <li>Chill Island beach access</li>
                                             <li>Complimentary lunch options</li>
                                          </ul>
                                       </div>
                                       <button class="btn btn--outline btn--sm step-expand" type="button">
                                          <i class="fas fa-chevron-down" aria-hidden="true"></i>
                                          CocoCay Guide
                                       </button>
                                    </div>
                                 </div>
                              </div>
                              <div class="timeline-step" data-day="7">
                                 <div class="step-indicator step-indicator--return">
                                    <span class="step-day">Day 7</span>
                                    <span class="step-date">Feb 20</span>
                                 </div>
                                 <div class="step-content">
                                    <div class="step-header">
                                       <h3>Orlando (Port Canaveral), FL</h3>
                                       <span class="step-badge step-badge--departure">Disembark 7:30 AM</span>
                                    </div>
                                    <div class="step-details">
                                       <div class="step-highlight">
                                          <strong>Reminder:</strong> Luggage outside cabin by midnight. Facial-recognition customs (~10 min).
                                       </div>
                                       <ul>
                                          <li>Early breakfast available in dining room</li>
                                          <li>Keep carry-on for medications & valuables</li>
                                          <li>Check out via Royal app or TV</li>
                                       </ul>
                                    </div>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                  </section>

                  <!-- ROOMS SECTION -->
                  <section id="rooms" class="section section--critical" aria-labelledby="roomsTitle">
                     <div class="card">
                        <div class="card__header">
                           <div class="card__icon" aria-hidden="true">
                              <i class="fas fa-door-closed"></i>
                           </div>
                           <div>
                              <h2 id="roomsTitle" class="card__title">Your Staterooms</h2>
                              <p class="card__subtitle">Where everyone will stay during the cruise</p>
                           </div>
                        </div>
                        <div class="card__content">
                           <div class="view-toggle" role="tablist" aria-label="Room view selection">
                              <button class="view-toggle__btn active" role="tab" aria-selected="true" data-view="cards">
                                 <i class="fas fa-th-large" aria-hidden="true"></i> Card View
                              </button>
                              <button class="view-toggle__btn" role="tab" aria-selected="false" data-view="table">
                                 <i class="fas fa-table" aria-hidden="true"></i> Table View
                              </button>
                           </div>
                           <div class="room-view room-view--cards active" id="roomCardsView">
                              <div class="room-grid">
                                 <div class="room-card room-card--featured">
                                    <div class="room-header">
                                       <div>
                                          <div class="room-number">6650</div>
                                          <div class="room-location">
                                             <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                                             Deck 6 ‚Ä¢ Connecting to 6652
                                          </div>
                                       </div>
                                       <span class="tag tag--info">Primary</span>
                                    </div>
                                    <div class="room-guests">
                                       <p class="room-label">Guests:</p>
                                       <ul class="guest-list">
                                          <li>Bill</li>
                                          <li>Melissa</li>
                                          <li>Owen</li>
                                          <li>Declan</li>
                                       </ul>
                                    </div>
                                    <p><strong>Type:</strong> Balcony ‚Ä¢ 198 sq ft + 46 sq ft deck</p>
                                    <p class="room-tip"><strong>Muster:</strong> Station F6 (Deck 4)</p>
                                    <p class="room-tip"><strong>Tip:</strong> Easy access to aft elevators for dinner runs</p>
                                 </div>
                                 <div class="room-card">
                                    <div class="room-header">
                                       <div>
                                          <div class="room-number">6443</div>
                                          <div class="room-location">
                                             <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                                             Deck 6 ‚Ä¢ Opposite laundry
                                          </div>
                                       </div>
                                       <span class="tag tag--info">Interior</span>
                                    </div>
                                    <div class="room-guests">
                                       <p class="room-label">Guests:</p>
                                       <ul class="guest-list">
                                          <li>Abel</li>
                                          <li>Amy</li>
                                       </ul>
                                    </div>
                                    <p><strong>Type:</strong> Interior ‚Ä¢ 160 sq ft</p>
                                    <p class="room-tip"><strong>Muster:</strong> Station F6 (Deck 4)</p>
                                    <p class="room-tip"><strong>Tip:</strong> Quick laundry access</p>
                                 </div>
                                 <div class="room-card">
                                    <div class="room-header">
                                       <div>
                                          <div class="room-number">4B 8528</div>
                                          <div class="room-location">
                                             <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                                             Deck 8 ‚Ä¢ Midship
                                          </div>
                                       </div>
                                       <span class="tag tag--info">Balcony</span>
                                    </div>
                                    <div class="room-guests">
                                       <p class="room-label">Guests:</p>
                                       <ul class="guest-list">
                                          <li>Aimee</li>
                                          <li>Karin</li>
                                       </ul>
                                    </div>
                                    <p><strong>Type:</strong> Balcony</p>
                                    <p class="room-tip"><strong>Muster:</strong> Station F6 (Deck 4)</p>
                                    <p class="room-tip"><strong>Tip:</strong> Quick walk to Royal Promenade</p>
                                 </div>
                                 <div class="room-card">
                                    <div class="room-header">
                                       <div>
                                          <div class="room-number">2D 8612</div>
                                          <div class="room-location">
                                             <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                                             Deck 8 ‚Ä¢ Aft
                                          </div>
                                       </div>
                                       <span class="tag tag--info">Ocean View</span>
                                    </div>
                                    <div class="room-guests">
                                       <p class="room-label">Guests:</p>
                                       <ul class="guest-list">
                                          <li>Bella</li>
                                          <li>TJ</li>
                                       </ul>
                                    </div>
                                    <p><strong>Type:</strong> Ocean View Balcony</p>
                                    <p class="room-tip"><strong>Muster:</strong> Station F6 (Deck 4)</p>
                                    <p class="room-tip"><strong>Tip:</strong> Quiet corridor away from traffic</p>
                                 </div>
                              </div>
                           </div>
                           <div class="room-view room-view--table" id="roomTableView">
                              <div class="table-responsive">
                                 <table class="info-table">
                                    <thead>
                                       <tr>
                                          <th>Stateroom</th>
                                          <th>Type &amp; Size</th>
                                          <th>Deck &amp; Location</th>
                                          <th>Guests</th>
                                          <th>Muster</th>
                                       </tr>
                                    </thead>
                                    <tbody>
                                       <tr>
                                          <td><strong>6650</strong></td>
                                          <td>Balcony ‚Ä¢ 198 sq ft + 46 sq ft deck</td>
                                          <td>Deck 6 ‚Ä¢ Connecting to 6652</td>
                                          <td>Bill, Melissa, Owen, Declan</td>
                                          <td>F6</td>
                                       </tr>
                                       <tr>
                                          <td><strong>6443</strong></td>
                                          <td>Interior ‚Ä¢ 160 sq ft</td>
                                          <td>Deck 6 ‚Ä¢ Opposite laundry</td>
                                          <td>Abel, Amy</td>
                                          <td>F6</td>
                                       </tr>
                                       <tr>
                                          <td><strong>4B 8528</strong></td>
                                          <td>Balcony</td>
                                          <td>Deck 8 ‚Ä¢ Midship access</td>
                                          <td>Aimee, Karin</td>
                                          <td>F6</td>
                                       </tr>
                                       <tr>
                                          <td><strong>2D 8612</strong></td>
                                          <td>Ocean View Balcony</td>
                                          <td>Deck 8 ‚Ä¢ Quiet aft corridor</td>
                                          <td>Bella, TJ</td>
                                          <td>F6</td>
                                       </tr>
                                    </tbody>
                                 </table>
                              </div>
                           </div>
                           <div class="note note--info mt-8">
                              <strong>Muster Station F6:</strong> All staterooms assigned to Station F6 on Deck 4, Starboard Side. Complete eMuster¬Æ in Royal App before 4:00 PM on embarkation day.
                           </div>
                        </div>
                     </div>
                  </section>
<!-- Dining Section -->
                  <section id="dining" class="section" aria-labelledby="diningTitle">
                     <div class="card">
                        <div class="card__header">
                           <div class="card__icon" aria-hidden="true">
                              <i class="fas fa-utensils"></i>
                           </div>
                           <div>
                              <h2 id="diningTitle" class="card__title">Dining &amp; Restaurants</h2>
                              <p class="card__subtitle">Culinary experiences onboard</p>
                           </div>
                           <button class="card__toggle" aria-expanded="false" aria-controls="diningContent">
                           <i class="fas fa-chevron-down" aria-hidden="true"></i>
                           <span class="sr-only">Toggle section</span>
                           </button>
                        </div>
                        <div id="diningContent" class="card__content collapsed">
                           <div class="dining-grid">
                              <!-- Specialty Dining -->
                              <div class="dining-card featured">
                                 <h3>Specialty Favorites</h3>
                                 <p class="mb-4">Reserve early for the most popular venues:</p>
                                 <ul class="guest-list mb-6">
                                    <li><strong>Chops Grille¬Æ:</strong> Prime steaks ‚Ä¢ $54 pp ‚Ä¢ ask for secret chimichurri</li>
                                    <li><strong>Izumi Hibachi &amp; Sushi:</strong> Teppanyaki + rolls ‚Ä¢ √† la carte ‚Ä¢ shout "Arigato" for bonus fried rice</li>
                                    <li><strong>Giovanni's Table:</strong> Rustic Italian ‚Ä¢ $46 pp ‚Ä¢ half-price lunch on port days</li>
                                    <li><strong>Izumi Sushi Roulette:</strong> Ask the chef for a surprise roll</li>
                                    <li><strong>Chef's Table Backstage:</strong> Tip ~$50 for a kitchen tour</li>
                                 </ul>
                                 <p class="text-sm text-light mb-4">Plan specialty dining around at-sea evenings to maximize time in port</p>
                                 <div class="dining-type">Premium Experience</div>
                              </div>
                              <!-- Main Dining -->
                              <div class="dining-card">
                                 <h3>Main Dining Room</h3>
                                 <p class="mb-4">Dress Code: 2 formal nights; smart casual other evenings</p>
                                 <p class="mb-2"><strong>My Time Dining:</strong> Pre-book or expect a wait</p>
                                 <p class="mb-6"><strong>Tip:</strong> Captain's Gala and formal portraits on the final sea day</p>
                                 <div class="dining-type">Included</div>
                              </div>
                              <!-- Casual Options -->
                              <div class="dining-card">
                                 <h3>Casual Dining &amp; Snacks</h3>
                                 <ul class="guest-list mb-6">
                                    <li><strong>Windjammer Caf√©:</strong> Global buffet ‚Ä¢ complimentary</li>
                                    <li><strong>Caf√© Promenade:</strong> 24/7 snacks and coffee</li>
                                    <li><strong>Room Service:</strong> Free continental breakfast (order via TV), $7.95 fee after 6 PM</li>
                                    <li><strong>Johnny Rockets:</strong> Classic burgers &amp; shakes ‚Ä¢ √† la carte</li>
                                    <li><strong>Ben &amp; Jerry's:</strong> Ice cream treats ‚Ä¢ extra charge</li>
                                 </ul>
                                 <div class="dining-type">Included</div>
                              </div>
                           </div>
                        </div>
                     </div>
                  </section>
                  <!-- Communication & Budget Section -->
                  <section id="communication" class="section" aria-labelledby="communicationTitle">
                     <div class="card">
                        <div class="card__header">
                           <div class="card__icon" aria-hidden="true">
                              <i class="fas fa-comments-dollar"></i>
                           </div>
                           <div>
                              <h2 id="communicationTitle" class="card__title">Communication &amp; Budget Plan</h2>
                              <p class="card__subtitle">Stay connected and manage expenses</p>
                           </div>
                           <button class="card__toggle" aria-expanded="false" aria-controls="communicationContent">
                           <i class="fas fa-chevron-down" aria-hidden="true"></i>
                           <span class="sr-only">Toggle section</span>
                           </button>
                        </div>
                        <div id="communicationContent" class="card__content collapsed">
                           <div class="tips-grid">
                              <!-- Connectivity Plan -->
                              <div class="tip-card">
                                 <div class="tip-header">
                                    <div class="tip-icon">üì±</div>
                                    <h4>Connectivity Plan</h4>
                                 </div>
                                 <ul class="guest-list">
                                    <li><strong>Royal app chat:</strong> Free on ship Wi-Fi for group updates</li>
                                    <li><strong>VOOM Surf + Stream:</strong> From ~$16 pp/day (pre-cruise)</li>
                                    <li><strong>In port:</strong> WhatsApp if on cellular or local Wi-Fi</li>
                                    <li><strong>Best Wi-Fi signal:</strong> Deck 4 library zones</li>
                                    <li><strong>Before sailaway:</strong> Set airplane mode to avoid roaming fees</li>
                                 </ul>
                                 <div class="chips mt-4">
                                    <span class="tag tag--info">110V/220V Outlets + USB</span>
                                    <span class="tag tag--recommended">WhatsApp: RaheCruise2026</span>
                                 </div>
                              </div>
                              <!-- Policies & Gratuities -->
                              <div class="tip-card">
                                 <div class="tip-header">
                                    <div class="tip-icon">üßæ</div>
                                    <h4>Policies &amp; Gratuities</h4>
                                 </div>
                                 <ul class="guest-list">
                                    <li><strong>Daily gratuities:</strong> $18.50 pp/day ($21 suites) auto-charge or pre-pay</li>
                                    <li><strong>Alcohol policy:</strong> 1 sealed 750 ml wine/champagne per adult at embarkation</li>
                                    <li><strong>Smoking areas:</strong> Port side Deck 11 + Casino Royale designated zone</li>
                                    <li><strong>Dress code:</strong> 2 formal nights, smart casual other nights</li>
                                    <li><strong>Age restrictions:</strong> Must be 21 to drink, 18 to gamble</li>
                                 </ul>
                                 <div class="chips mt-4">
                                    <span class="tag tag--recommended">Review SeaPass Charges Nightly</span>
                                 </div>
                              </div>
                              <!-- Budget Dashboard -->
                              <div class="tip-card">
                                 <div class="tip-header">
                                    <div class="tip-icon">üí≥</div>
                                    <h4>Budget Dashboard</h4>
                                 </div>
                                 <ul class="guest-list">
                                    <li><strong>Excursions:</strong> $800 (Stingray City, Dunn's River Falls, CocoCay)</li>
                                    <li><strong>Specialty Dining:</strong> $300 (3 restaurants for 2 people)</li>
                                    <li><strong>Drinks Package:</strong> $400 (Deluxe Beverage for 2)</li>
                                    <li><strong>VOOM Wi-Fi:</strong> $150 (2 devices for 6 nights)</li>
                                    <li><strong>Souvenirs:</strong> $300 (gifts, photos, keepsakes)</li>
                                    <li><strong>Onboard Credits:</strong> $200 (applied to SeaPass)</li>
                                 </ul>
                                 <p class="text-sm text-light mt-4">Use a shared Google Sheet for real-time expense tracking</p>
                                 <div class="chips mt-4">
                                    <span class="tag tag--essential">Track Totals Nightly</span>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                  </section>
                  <!-- Tips Section -->
                  <section id="tips" class="section" aria-labelledby="tipsTitle">
                     <div class="card">
                        <div class="card__header">
                           <div class="card__icon" aria-hidden="true">
                              <i class="fas fa-lightbulb"></i>
                           </div>
                           <div>
                              <h2 id="tipsTitle" class="card__title">Pro Tips &amp; Recommendations</h2>
                              <p class="card__subtitle">Expert advice for the perfect cruise</p>
                           </div>
                           <button class="card__toggle" aria-expanded="false" aria-controls="tipsContent">
                              <i class="fas fa-chevron-down" aria-hidden="true"></i>
                              <span class="sr-only">Toggle section</span>
                           </button>
                        </div>
                        <div id="tipsContent" class="card__content collapsed">
                           <div class="tips-priority">
                              <div class="tip-card tip-card--large">
                                 <div class="tip-header">
                                    <div class="tip-icon">üì±</div>
                                    <h3>Royal App is Essential</h3>
                                 </div>
                                 <p>Download before you sail. Use for daily schedules, onboard chat, and account monitoring. Enable notifications for important announcements.</p>
                                 <div class="chips mt-4">
                                    <span class="tag tag--essential">Must Do</span>
                                    <span class="tag tag--info">Free Onboard</span>
                                 </div>
                              </div>
                              <div class="tip-card tip-card--large">
                                 <div class="tip-header">
                                    <div class="tip-icon">üëï</div>
                                    <h3>Packing Essentials</h3>
                                 </div>
                                 <p>Mid-Feb temps: 75-82¬∞F days, 68¬∞F nights. Pack light layers, reef-safe SPF 50, quick-dry swimwear, water shoes, and two formal outfits.</p>
                                 <ul class="guest-list mt-2">
                                    <li>Passports valid beyond Aug 2026</li>
                                    <li>Magnetic hooks, USB-C hub, night-light</li>
                                    <li>Motion sickness remedies</li>
                                    <li>Non-surge power strip</li>
                                 </ul>
                                 <div class="chips mt-4">
                                    <span class="tag tag--recommended">Print This</span>
                                 </div>
                              </div>
                           </div>
                           <div class="tips-grid mt-8">
                              <div class="tip-card">
                                 <div class="tip-header">
                                    <div class="tip-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
                                    <h4>Family Programs</h4>
                                 </div>
                                 <p>Adventure Ocean (3-12), Teen Lounge (13-17), Royal Babies &amp; Tots (6-36 mo, reservation-only), Splashaway Bay for littles.</p>
                              </div>
                              <div class="tip-card">
                                 <div class="tip-header">
                                    <div class="tip-icon">üïê</div>
                                    <h4>Ship Time Critical</h4>
                                 </div>
                                 <p>Always follow ship time, not local port time. Set watches to ship time before leaving ship to avoid missing departure.</p>
                                 <div class="chips mt-4">
                                    <span class="tag tag--essential">Critical</span>
                                 </div>
                              </div>
                              <div class="tip-card">
                                 <div class="tip-header">
                                    <div class="tip-icon">üì∏</div>
                                    <h4>Photo Packages</h4>
                                 </div>
                                 <p>Unlimited Digital Package $249. Video recap $149 if pre-ordered. Best photos on formal nights.</p>
                              </div>
                              <div class="tip-card">
                                 <div class="tip-header">
                                    <div class="tip-icon">üëë</div>
                                    <h4>Crown &amp; Anchor</h4>
                                 </div>
                                 <p>Earn 1 point per night (2 in suites). Benefits include priority check-in and exclusive events at higher tiers.</p>
                              </div>
                              <div class="tip-card">
                                 <div class="tip-header">
                                    <div class="tip-icon">üõå</div>
                                    <h4>Cabin Hacks</h4>
                                 </div>
                                 <ul class="guest-list">
                                    <li>Magnetic hooks for schedules</li>
                                    <li>USB nightlight for late walks</li>
                                    <li>Close balcony curtains at night</li>
                                    <li>Interior: use bridge cam TV</li>
                                 </ul>
                              </div>
                              <div class="tip-card">
                                 <div class="tip-header">
                                    <div class="tip-icon">üó∫Ô∏è</div>
                                    <h4>Deck Shortcuts</h4>
                                 </div>
                                 <ul class="guest-list">
                                    <li><strong>Deck 11:</strong> Pools + Windjammer</li>
                                    <li><strong>Deck 5:</strong> Royal Promenade 24/7 snacks</li>
                                    <li><strong>Deck 13:</strong> FlowRider¬Æ (early AM = no lines)</li>
                                 </ul>
                              </div>
                              <div class="tip-card">
                                 <div class="tip-header">
                                    <div class="tip-icon">üí∞</div>
                                    <h4>Budget Hacks</h4>
                                 </div>
                                 <ul class="guest-list">
                                    <li>Free champagne at art auction</li>
                                    <li>Shop clearance on Day 6</li>
                                    <li>Half-price specialty lunch on port days</li>
                                    <li>Diamond: free drinks 5-8 PM</li>
                                 </ul>
                              </div>
                              <div class="tip-card">
                                 <div class="tip-header">
                                    <div class="tip-icon">üö®</div>
                                    <h4>Safety Prep</h4>
                                 </div>
                                 <ul class="guest-list">
                                    <li>Passports in cabin safe</li>
                                    <li>Closed-toe shoes for excursions</li>
                                    <li>Carry $200 in small bills</li>
                                    <li>Upload vaccine cards pre-cruise</li>
                                 </ul>
                              </div>
                           </div>
                        </div>
                     </div>
                  </section>
                  <section id="integrate" class="section" aria-labelledby="integrateTitle">
                     <div class="card card--highlight">
                        <div class="card__header">
                           <div class="card__icon" aria-hidden="true">
                              <i class="fas fa-star"></i>
                           </div>
                           <div>
                              <h2 id="integrateTitle" class="card__title">VIP Upgrades &amp; Premium Experiences</h2>
                              <p class="card__subtitle">Enhance your cruise with exclusive options</p>
                           </div>
                           <button class="card__toggle" aria-expanded="false" aria-controls="integrateContent">
                              <i class="fas fa-chevron-down" aria-hidden="true"></i>
                              <span class="sr-only">Toggle section</span>
                           </button>
                        </div>
                        <div id="integrateContent" class="card__content collapsed">
                           <div class="vip-grid">
                              <div class="vip-card">
                                 <div class="vip-header">
                                    <div class="vip-icon">‚öì</div>
                                    <h3>The Key¬Æ Benefits</h3>
                                 </div>
                                 <ul class="guest-list">
                                    <li>Priority boarding at 11:00 AM</li>
                                    <li>Reserved seating at shows</li>
                                    <li>Exclusive lounge access</li>
                                    <li>Complimentary VOOM for 1 device</li>
                                    <li>Priority departure</li>
                                 </ul>
                                 <p class="vip-price">~$25/person/day</p>
                              </div>
                              <div class="vip-card">
                                 <div class="vip-header">
                                    <div class="vip-icon">üó∫Ô∏è</div>
                                    <h3>Hero Moments</h3>
                                 </div>
                                 <ul class="guest-list">
                                    <li>Sunrise zip line at CocoCay</li>
                                    <li>Blue Hole secret lagoon with LED lights</li>
                                    <li>Floating cabana with butler service</li>
                                    <li>Private FlowRider lesson</li>
                                    <li>Behind-the-scenes kitchen tour</li>
                                 </ul>
                              </div>
                              <div class="vip-card">
                                 <div class="vip-header">
                                    <div class="vip-icon">üç∑</div>
                                    <h3>Dining Upgrades</h3>
                                 </div>
                                 <ul class="guest-list">
                                    <li>Chef's Table wine pairing</li>
                                    <li>Chops Grille truffle mac off-menu</li>
                                    <li>Giovanni's limoncello experience</li>
                                    <li>Windjammer 6:30 AM cronuts</li>
                                    <li>Suite room service extended hours</li>
                                 </ul>
                              </div>
                              <div class="vip-card">
                                 <div class="vip-header">
                                    <div class="vip-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
                                    <h3>Family Experiences</h3>
                                 </div>
                                 <ul class="guest-list">
                                    <li>Themed character night for tots</li>
                                    <li>Junior mixology mocktail class</li>
                                    <li>Teen Instagram scavenger hunt</li>
                                    <li>Adult mixology with master bartender</li>
                                    <li>Family talent show night</li>
                                 </ul>
                              </div>
                              <div class="vip-card">
                                 <div class="vip-header">
                                    <div class="vip-icon">üõå</div>
                                    <h3>Stateroom Enhancements</h3>
                                 </div>
                                 <ul class="guest-list">
                                    <li>Premium pillow menu</li>
                                    <li>Complimentary pressing service</li>
                                    <li>Sunrise yoga sessions</li>
                                    <li>Mini projector cinema night</li>
                                    <li>Espresso maker (suites)</li>
                                 </ul>
                              </div>
                              <div class="vip-card">
                                 <div class="vip-header">
                                    <div class="vip-icon">üåç</div>
                                    <h3>Sustainability</h3>
                                 </div>
                                 <ul class="guest-list">
                                    <li>Journey Mode AI itinerary tuning</li>
                                    <li>Memory Maker 4K drone footage</li>
                                    <li>Green Anchor recycling rewards</li>
                                    <li>Carbon offset contributions</li>
                                    <li>Support local artisan markets</li>
                                 </ul>
                              </div>
                           </div>
                           <div class="note note--accent mt-8">
                              <strong>VIP Digital Passport:</strong> Access exclusive content, captain's videos, and crew secrets via the Royal app.
                           </div>
                        </div>
                     </div>
                  </section>

               <!-- Right Column - Sidebar -->
               <aside class="sidebar" aria-label="Supplementary information">
                  <!-- Emergency Info (Always Visible) -->
                  <div class="sidebar-card sidebar-card--critical">
                     <h3 class="sidebar-card__title">
                        <i class="fas fa-exclamation-triangle" aria-hidden="true"></i>
                        Emergency Info
                     </h3>
                     <ul class="list list--icon">
                        <li>
                           <i class="fas fa-hospital" aria-hidden="true"></i>
                           <span>Medical Center: Deck 1 (24/7)</span>
                        </li>
                        <li>
                           <i class="fas fa-phone-alt" aria-hidden="true"></i>
                           <span>Emergency: Dial 911 from cabin</span>
                        </li>
                        <li>
                           <i class="fas fa-user-friends" aria-hidden="true"></i>
                           <span>eMuster Station: F6 (Deck 4)</span>
                        </li>
                        <li>
                           <i class="fas fa-life-ring" aria-hidden="true"></i>
                           <span>Life Jackets: Under bed storage</span>
                        </li>
                     </ul>
                  </div>
                  <!-- Focus This Week -->
                  <div class="sidebar-card sidebar-card--highlight">
                     <h3 class="sidebar-card__title">
                        <i class="fas fa-bullseye" aria-hidden="true"></i>
                        Focus This Week
                     </h3>
                     <ul class="list list--icon">
                        <li>
                           <i class="fas fa-check-circle text-success" aria-hidden="true"></i>
                           <span>Finalize 11:00 AM check-in</span>
                        </li>
                        <li>
                           <i class="fas fa-link text-primary" aria-hidden="true"></i>
                           <span>Link bookings in Royal app</span>
                        </li>
                        <li>
                           <i class="fas fa-calendar text-accent" aria-hidden="true"></i>
                           <span>Reserve Dunn's River + Dragon's Breath</span>
                        </li>
                        <li>
                           <i class="fas fa-utensils text-warning" aria-hidden="true"></i>
                           <span>Lock dining plans</span>
                        </li>
                        <li>
                           <i class="fas fa-passport text-info" aria-hidden="true"></i>
                           <span>Check passport expiration</span>
                        </li>
                     </ul>
                  </div>
                  <!-- Key Dates -->
                  <div class="sidebar-card">
                     <h3 class="sidebar-card__title">
                        <i class="fas fa-calendar-check" aria-hidden="true"></i>
                        Key Dates
                     </h3>
                     <ul class="date-list">
                        <li class="date-item">
                           <span class="date-label">Online Check-in Opens</span>
                           <span class="date-value">~Dec 31, 2025</span>
                        </li>
                        <li class="date-item">
                           <span class="date-label">Cruise Departure</span>
                           <span class="date-value">Feb 14, 2026</span>
                        </li>
                        <li class="date-item">
                           <span class="date-label">George Town</span>
                           <span class="date-value">Feb 16, 2026</span>
                        </li>
                        <li class="date-item">
                           <span class="date-label">Falmouth, Jamaica</span>
                           <span class="date-value">Feb 17, 2026</span>
                        </li>
                        <li class="date-item">
                           <span class="date-label">Perfect Day at CocoCay</span>
                           <span class="date-value">Feb 19, 2026</span>
                        </li>
                        <li class="date-item">
                           <span class="date-label">Return to Port</span>
                           <span class="date-value">Feb 20, 2026</span>
                        </li>
                     </ul>
                  </div>
                  <!-- Weather Widget -->
                  <div class="sidebar-card">
                     <h3 class="sidebar-card__title">
                        <i class="fas fa-sun" aria-hidden="true"></i>
                        Caribbean Weather
                     </h3>
                     <div class="weather-widget">
                        <div class="weather-icon" role="img" aria-label="Partly Cloudy">üå§Ô∏è</div>
                        <div class="weather-temp" id="weatherTemp">82¬∞F</div>
                        <div class="weather-condition" id="weatherCondition">Partly Cloudy</div>
                        <p class="weather-summary" id="weatherSummary">
                           Loading the latest port-by-port forecast...
                        </p>
                        <ul class="weather-forecast-list" id="weatherForecastList" aria-live="polite"></ul>
                     </div>
                  </div>
               </aside>
            </div>
         </div>
      </main>
      <!-- Floating Actions -->
      <div class="floating-actions" aria-label="Quick actions">
         <button class="fab fab--critical" id="jumpToCriticalBtn" aria-label="Jump to critical checklist">
         <i class="fas fa-exclamation-triangle" aria-hidden="true"></i>
         </button>
         <button class="fab fab--compact active" id="compactToggleBtn" aria-pressed="true" aria-label="Toggle compact mode">
         <i class="fas fa-compress-alt" aria-hidden="true"></i>
         </button>
      </div>
      <!-- Bottom Navigation for Mobile -->
      <nav class="bottom-nav" aria-label="Mobile navigation">
         <button class="nav-item" data-section="overview">
         <span class="emoji" aria-hidden="true">üö¢</span>
         <span>Start Here</span>
         </button>
         <button class="nav-item" data-section="operations">
         <span class="emoji" aria-hidden="true">‚öì</span>
         <span>Guide</span>
         <span class="nav-badge" id="criticalCountBadge" style="display: inline-flex;">5</span>
         </button>
         <button class="nav-item" data-section="itinerary">
         <span class="emoji" aria-hidden="true">üå¥</span>
         <span>Schedule</span>
         </button>
         <button class="nav-item" data-section="tips">
         <span class="emoji" aria-hidden="true">üåä</span>
         <span>Tips</span>
         </button>
         <button class="nav-item" id="mobileMoreBtn">
         <span class="emoji" aria-hidden="true">üö¢</span>
         <span>More</span>
         </button>
      </nav>
      <!-- Official Royal Caribbean Footer -->
      <footer class="rc-official-footer" role="contentinfo">
         <div class="container">
            <div class="rc-footer-main">
               <div class="rc-logo-section">
                  <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 220 60'><rect width='220' height='60' fill='%230054a4'/><text x='12' y='34' font-family='Montserrat, Arial, sans-serif' font-size='20' fill='white'>Royal Caribbean</text><text x='12' y='52' font-family='Source Sans Pro, Arial, sans-serif' font-size='12' fill='white'>International</text></svg>" alt="Royal Caribbean International" height="40">
                  <p class="rc-tagline">World's Best Cruise Line<br>14 Years Running</p>
                  <a class="rc-footer-cta" href="#" aria-label="Open the Royal Caribbean app">Open the App</a>
               </div>
               <div class="rc-footer-column">
                  <p class="rc-footer-heading">Plan Links</p>
                  <ul class="rc-footer-list">
                     <li><a href="#overview">Start Here</a></li>
                     <li><a href="#itinerary">Daily Schedule</a></li>
                     <li><a href="#dining">Dining Guide</a></li>
                     <li><a href="#communication">Comms &amp; Budget</a></li>
                  </ul>
               </div>
               <div class="rc-footer-column">
                  <p class="rc-footer-heading">Onboard Essentials</p>
                  <ul class="rc-footer-list">
                     <li><a href="#operations">Check-in &amp; Documents</a></li>
                     <li><a href="#rooms">Room Details</a></li>
                     <li><a href="#tips">Packing Tips</a></li>
                     <li><a href="#integrate">VIP Upgrades</a></li>
                  </ul>
               </div>
               <div class="rc-contact-info">
                  <p><strong>Need Help?</strong></p>
                  <p><span class="emoji" aria-hidden="true">üìû</span> 1-866-562-7625</p>
                  <p><span class="emoji" aria-hidden="true">‚úâÔ∏è</span> guestservices@royalcaribbean.com</p>
                  <div class="rc-footer-social" aria-label="Royal Caribbean social links">
                     <a href="#" aria-label="Royal Caribbean on Instagram"><i class="fab fa-instagram" aria-hidden="true"></i></a>
                     <a href="#" aria-label="Royal Caribbean on Facebook"><i class="fab fa-facebook-f" aria-hidden="true"></i></a>
                     <a href="#" aria-label="Royal Caribbean on X"><i class="fab fa-x-twitter" aria-hidden="true"></i></a>
                  </div>
               </div>
            </div>
            <div class="rc-footer-disclaimer">
               <div class="rc-legal-links">
                  <a href="#">Privacy Policy</a> ‚Ä¢
                  <a href="#">Terms of Use</a> ‚Ä¢
                  <a href="#">Health &amp; Safety</a> ‚Ä¢
                  <a href="#">Accessibility</a>
               </div>
               <p>¬© 2026 Royal Caribbean International. Ships' Registry: The Bahamas. All dining, entertainment, and shore excursions are subject to change. Refer to the Royal Caribbean app for the most current information.</p>
               <p class="rc-copyright">ADVENTURE OF THE SEAS¬Æ ‚Ä¢ VOYAGER CLASS ‚Ä¢ AMPLIFIED 2018</p>
            </div>
         </div>
      </footer>
      <!-- Complete JavaScript -->
      <script>
         // ============================================================================
         // CRUISE COMPANION APPLICATION - PRODUCTION READY
         // Version: 2.0.0
         // Date: 2026-01-15
         // ============================================================================
         
         'use strict';
         
         // ============================================================================
         // CONFIGURATION & CONSTANTS
         // ============================================================================
         
         const CONFIG = {
          // Application
          APP_NAME: 'Cruise Companion',
          APP_VERSION: '2.0.0',
          
          // Cruise Details
          CRUISE_DATE: '2026-02-14T14:00:00-05:00',
          CRUISE_DURATION: 6,
          SHIP_NAME: 'Adventure of the Seas',
          SAILING_NUMBER: '12345678',
          MUSTER_STATION: 'F6',
          EMBARKATION_TIME: '2:00 PM',
          
          // Ports
          PORTS: [
              { id: 'georgetown', name: 'George Town, Grand Cayman', day: 3, arrival: '11:00 AM', departure: '5:15 PM', latitude: 19.2866, longitude: -81.3744 },
              { id: 'falmouth', name: 'Falmouth, Jamaica', day: 4, arrival: '8:30 AM', departure: '4:30 PM', latitude: 18.4937, longitude: -77.6559 },
              { id: 'cococay', name: 'Perfect Day at CocoCay', day: 6, arrival: '7:30 AM', departure: '4:30 PM', latitude: 25.8186, longitude: -77.9520 }
          ],
          
          // Styling
          BREAKPOINTS: {
              MOBILE: 768,
              TABLET: 1024,
              DESKTOP: 1280
          },
          
          // Performance
          DEBOUNCE_DELAY: 300,
          TOAST_DURATION: 3000,
          LOADING_DELAY: 1000,
          
         // Offline Caching
         OFFLINE_CACHE_NAME: 'cruise_companion_offline_v1',
         
         // Storage Keys
         STORAGE_KEYS: {
              PREFERENCES: 'cruise_preferences_v2',
              SEARCH_HISTORY: 'cruise_search_history_v2',
              COMPACT_MODE: 'cruise_compact_mode',
              CRITICAL_FILTER: 'cruise_critical_filter',
              HINT_DISMISSED: 'cruise_hint_dismissed',
              DECK_PLANS: 'cruise_deck_plans_v1',
              OFFLINE_READY: 'cruise_offline_ready_v1'
         },
          
          // API Endpoints (Placeholders for future expansion)
          API_ENDPOINTS: {
              WEATHER: 'https://api.example.com/weather',
              UPDATES: 'https://api.example.com/cruise-updates',
              SYNC: 'https://api.example.com/sync'
          }
         };
         
         // ============================================================================
         // ERROR HANDLER
         // ============================================================================
         
         class ErrorHandler {
          constructor() {
              this.errors = [];
              this.maxErrors = 50;
          }
          
          log(error, context = 'Unknown') {
              const errorObj = {
                  timestamp: new Date().toISOString(),
                  context: context,
                  message: error.message || String(error),
                  stack: error.stack,
                  userAgent: navigator.userAgent,
                  url: window.location.href
              };
              
              console.error(`[${context}]`, error);
              this.errors.push(errorObj);
              
              // Keep only recent errors
              if (this.errors.length > this.maxErrors) {
                  this.errors.shift();
              }
              
              // Send to analytics if available
              this.sendToAnalytics(errorObj);
              
              return errorObj;
          }
          
          sendToAnalytics(error) {
              // Google Analytics
              if (typeof gtag === 'function') {
                  gtag('event', 'exception', {
                      description: `${error.context}: ${error.message}`,
                      fatal: false
                  });
              }
              
              // Sentry.io (example)
              if (typeof Sentry !== 'undefined') {
                  Sentry.captureException(new Error(`${error.context}: ${error.message}`));
              }
          }
          
          getErrors() {
              return [...this.errors];
          }
          
          clearErrors() {
              this.errors = [];
          }
          
          showUserFriendlyError(message, duration = 5000) {
              const errorDiv = document.createElement('div');
              errorDiv.className = 'error-toast';
              errorDiv.innerHTML = `
                  <div class="error-content">
                      <i class="fas fa-exclamation-circle"></i>
                      <span>${message}</span>
                      <button class="error-close"><i class="fas fa-times"></i></button>
                  </div>
              `;
              
              document.body.appendChild(errorDiv);
              
              setTimeout(() => {
                  errorDiv.classList.add('show');
              }, 10);
              
              const closeBtn = errorDiv.querySelector('.error-close');
              closeBtn.addEventListener('click', () => {
                  errorDiv.classList.remove('show');
                  setTimeout(() => {
                      if (errorDiv.parentNode) {
                          errorDiv.parentNode.removeChild(errorDiv);
                      }
                  }, 300);
              });
              
              if (duration > 0) {
                  setTimeout(() => {
                      if (errorDiv.parentNode) {
                          errorDiv.classList.remove('show');
                          setTimeout(() => {
                              if (errorDiv.parentNode) {
                                  errorDiv.parentNode.removeChild(errorDiv);
                              }
                          }, 300);
                      }
                  }, duration);
              }
              
              return errorDiv;
          }
         }
         
         // ============================================================================
         // STORAGE MANAGER
         // ============================================================================
         
         class StorageManager {
          constructor() {
              this.errorHandler = new ErrorHandler();
              this.isAvailable = this.checkAvailability();
          }
          
          checkAvailability() {
              try {
                  const testKey = '__storage_test__';
                  localStorage.setItem(testKey, testKey);
                  localStorage.removeItem(testKey);
                  return true;
              } catch (e) {
                  this.errorHandler.log(e, 'StorageManager.checkAvailability');
                  return false;
              }
          }
          
          set(key, value) {
              if (!this.isAvailable) {
                  console.warn('LocalStorage is not available');
                  return false;
              }
              
              try {
                  const serialized = JSON.stringify(value);
                  localStorage.setItem(key, serialized);
                  return true;
              } catch (e) {
                  this.errorHandler.log(e, `StorageManager.set(${key})`);
                  return false;
              }
          }
          
          get(key, defaultValue = null) {
              if (!this.isAvailable) {
                  return defaultValue;
              }
              
              try {
                  const item = localStorage.getItem(key);
                  return item ? JSON.parse(item) : defaultValue;
              } catch (e) {
                  this.errorHandler.log(e, `StorageManager.get(${key})`);
                  return defaultValue;
              }
          }
          
          remove(key) {
              if (!this.isAvailable) return false;
              
              try {
                  localStorage.removeItem(key);
                  return true;
              } catch (e) {
                  this.errorHandler.log(e, `StorageManager.remove(${key})`);
                  return false;
              }
          }
          
          clear() {
              if (!this.isAvailable) return false;
              
              try {
                  localStorage.clear();
                  return true;
              } catch (e) {
                  this.errorHandler.log(e, 'StorageManager.clear');
                  return false;
              }
          }
          
          // Application-specific methods
          savePreferences(preferences) {
              return this.set(CONFIG.STORAGE_KEYS.PREFERENCES, preferences);
          }
          
          loadPreferences() {
              return this.get(CONFIG.STORAGE_KEYS.PREFERENCES, {
                  compactMode: false,
                  criticalFilter: false,
                  theme: 'light',
                  fontSize: 'medium',
                  notifications: true
              });
          }
          
          saveSearchHistory(history) {
              return this.set(CONFIG.STORAGE_KEYS.SEARCH_HISTORY, history);
          }
          
          loadSearchHistory() {
              return this.get(CONFIG.STORAGE_KEYS.SEARCH_HISTORY, []);
          }

          saveDeckPlans(plans) {
              return this.set(CONFIG.STORAGE_KEYS.DECK_PLANS, plans);
          }
          
          loadDeckPlans() {
              return this.get(CONFIG.STORAGE_KEYS.DECK_PLANS, []);
          }
          
          clearDeckPlans() {
              return this.remove(CONFIG.STORAGE_KEYS.DECK_PLANS);
          }
         }
         
         // ============================================================================
         // DEBOUNCE & THROTTLE UTILITIES
         // ============================================================================
         
         class PerformanceUtils {
          static debounce(func, wait, immediate = false) {
              let timeout;
              return function executedFunction(...args) {
                  const context = this;
                  const later = () => {
                      timeout = null;
                      if (!immediate) func.apply(context, args);
                  };
                  const callNow = immediate && !timeout;
                  clearTimeout(timeout);
                  timeout = setTimeout(later, wait);
                  if (callNow) func.apply(context, args);
              };
          }
          
          static throttle(func, limit) {
              let inThrottle;
              return function executedFunction(...args) {
                  const context = this;
                  if (!inThrottle) {
                      func.apply(context, args);
                      inThrottle = true;
                      setTimeout(() => inThrottle = false, limit);
                  }
              };
          }
          
          static async sleep(ms) {
              return new Promise(resolve => setTimeout(resolve, ms));
          }
         }
         
         // ============================================================================
         // DOM UTILITIES
         // ============================================================================
         
         class DOMUtils {
          static createElement(tag, classes = [], attributes = {}, content = '') {
              const element = document.createElement(tag);
              
              if (classes.length > 0) {
                  element.classList.add(...classes);
              }
              
              Object.entries(attributes).forEach(([key, value]) => {
                  element.setAttribute(key, value);
              });
              
              if (typeof content === 'string') {
                  element.innerHTML = content;
              } else if (content instanceof Node) {
                  element.appendChild(content);
              } else if (Array.isArray(content)) {
                  content.forEach(child => {
                      if (child instanceof Node) {
                          element.appendChild(child);
                      }
                  });
              }
              
              return element;
          }
          
          static removeAllChildren(element) {
              while (element.firstChild) {
                  element.removeChild(element.firstChild);
              }
          }
          
          static isElementInViewport(el, offset = 0) {
              const rect = el.getBoundingClientRect();
              return (
                  rect.top >= 0 &&
                  rect.left >= 0 &&
                  rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) + offset &&
                  rect.right <= (window.innerWidth || document.documentElement.clientWidth)
              );
          }
          
          static scrollToElement(element, offset = 0, behavior = 'smooth') {
              const elementRect = element.getBoundingClientRect();
              const absoluteTop = window.pageYOffset + elementRect.top;
              window.scrollTo({
                  top: absoluteTop - offset,
                  behavior: behavior
              });
          }
          
          static addClassToAll(elements, className) {
              elements.forEach(el => el.classList.add(className));
          }
          
          static removeClassFromAll(elements, className) {
              elements.forEach(el => el.classList.remove(className));
          }
          
          static toggleClassOnAll(elements, className, force) {
              elements.forEach(el => el.classList.toggle(className, force));
          }
         }
         
         // ============================================================================
         // SEARCH MANAGER
         // ============================================================================
         
         class SearchManager {
          constructor() {
              this.index = [];
              this.history = [];
              this.maxHistory = 10;
              this.storage = new StorageManager();
              this.errorHandler = new ErrorHandler();
              this.currentQuery = '';
              this.isIndexing = false;
              
              this.loadHistory();
          }
          
          loadHistory() {
              this.history = this.storage.loadSearchHistory();
          }
          
          saveHistory() {
              this.storage.saveSearchHistory(this.history);
          }
          
          addToHistory(query) {
              if (!query || query.trim() === '') return;
              
              const trimmedQuery = query.trim();
              const existingIndex = this.history.findIndex(item => 
                  item.toLowerCase() === trimmedQuery.toLowerCase()
              );
              
              if (existingIndex > -1) {
                  this.history.splice(existingIndex, 1);
              }
              
              this.history.unshift(trimmedQuery);
              
              if (this.history.length > this.maxHistory) {
                  this.history = this.history.slice(0, this.maxHistory);
              }
              
              this.saveHistory();
          }
          
          clearHistory() {
              this.history = [];
              this.saveHistory();
              return true;
          }
          
          async buildIndex() {
              if (this.isIndexing) {
                  console.warn('Search index is already being built');
                  return;
              }
              
              this.isIndexing = true;
              
              try {
                  this.index = [];
                  
                  // Index sections
                  const sections = document.querySelectorAll('section[id]');
                  
                  for (const section of sections) {
                      await this.indexSection(section);
                  }
                  
                  // Index specific items
                  await this.indexSpecificItems();
                  
                  console.log(`Search index built with ${this.index.length} items`);
                  return this.index;
              } catch (error) {
                  this.errorHandler.log(error, 'SearchManager.buildIndex');
                  throw error;
              } finally {
                  this.isIndexing = false;
              }
          }
          
          async indexSection(section) {
              const id = section.id;
              const title = section.querySelector('h2, .card__title')?.textContent?.trim() || id;
              const content = section.textContent || '';
              
              // Extract keywords from data attributes or content
              const keywords = this.extractKeywords(section, content);
              
              // Determine priority
              const priority = this.determinePriority(id, section);
              
              this.index.push({
                  id: id,
                  type: 'section',
                  title: title,
                  content: content.substring(0, 1000),
                  keywords: keywords,
                  priority: priority,
                  critical: section.classList.contains('section--critical') || 
                           id.includes('operations') || 
                           id.includes('critical'),
                  element: section,
                  timestamp: Date.now()
              });
          }
          
          async indexSpecificItems() {
              const specificItems = [
                  {
                      id: 'countdown-timer',
                      type: 'feature',
                      title: 'Countdown Timer',
                      content: 'Days until cruise departure. Shows days, hours, and minutes remaining until embarkation.',
                      keywords: ['countdown', 'timer', 'departure', 'days', 'hours', 'minutes', 'embarkation'],
                      priority: 2,
                      critical: false,
                      category: 'Hero'
                  },
                  {
                      id: 'cococay-perfect-day',
                      type: 'port',
                      title: 'Perfect Day at CocoCay',
                      content: 'Thrill Waterpark, Oasis Lagoon, Daredevils Peak. Docked access, no tender needed.',
                      keywords: ['cococay', 'perfect day', 'waterpark', 'beach', 'thrill', 'oasis lagoon', 'daredevils peak'],
                      priority: 3,
                      critical: true,
                      category: 'Itinerary'
                  },
                  {
                      id: 'george-town-port',
                      type: 'port',
                      title: 'George Town, Grand Cayman',
                      content: 'Tender port for Seven Mile Beach and Stingray City. Plan for extra tender time.',
                      keywords: ['george town', 'grand cayman', 'stingray city', 'seven mile beach', 'tender', 'port'],
                      priority: 3,
                      critical: true,
                      category: 'Itinerary'
                  },
                  {
                      id: 'dunns-river-falls',
                      type: 'excursion',
                      title: 'Dunns River Falls',
                      content: 'Jamaica waterfall climb. Water shoes required. Combo with Blue Hole recommended.',
                      keywords: ['dunns', 'river', 'falls', 'jamaica', 'waterfall', 'climb', 'blue hole', 'excursion'],
                      priority: 3,
                      critical: true,
                      category: 'Itinerary'
                  },
                  {
                      id: 'dragons-breath-zipline',
                      type: 'excursion',
                      title: 'Dragons Breath Zipline',
                      content: 'Perfect Day at CocoCay zipline. Longest over water zipline. Morning slots recommended.',
                      keywords: ['dragon', 'breath', 'zipline', 'labadee', 'haiti', 'excursion', 'adventure'],
                      priority: 3,
                      critical: true,
                      category: 'Itinerary'
                  },
                  {
                      id: 'flowrider',
                      type: 'activity',
                      title: 'FlowRider Surf Simulator',
                      content: 'Surf simulator on Adventure of the Seas. Early morning has shortest lines.',
                      keywords: ['flowrider', 'surf', 'simulator', 'activity', 'pool deck', 'adventure'],
                      priority: 2,
                      critical: false,
                      category: 'Onboard Activities'
                  },
                  {
                      id: 'emuster-station-f6',
                      type: 'safety',
                      title: 'eMuster Station F6',
                      content: 'Safety briefing location on Deck 4. Must complete before 4:00 PM on embarkation day.',
                      keywords: ['emuster', 'safety', 'drill', 'station', 'f6', 'deck 4', 'mandatory', 'critical'],
                      priority: 4,
                      critical: true,
                      category: 'Safety'
                  },
                  {
                      id: 'royal-caribbean-app',
                      type: 'tool',
                      title: 'Royal Caribbean App',
                      content: 'Essential app for schedules, chat, and bookings. Download before boarding.',
                      keywords: ['royal', 'app', 'mobile', 'download', 'chat', 'schedule', 'booking', 'essential'],
                      priority: 3,
                      critical: true,
                      category: 'Tools'
                  },
                  {
                      id: 'wifi-connectivity',
                      type: 'service',
                      title: 'Wi-Fi & Connectivity',
                      content: 'VOOM Surf + Stream, Royal-WIFI, internet packages. Best signal on Deck 4 library.',
                      keywords: ['wifi', 'internet', 'connectivity', 'vroom', 'online', 'signal', 'package'],
                      priority: 2,
                      critical: false,
                      category: 'Services'
                  }
              ];
              
              this.index.push(...specificItems);
          }
          
          extractKeywords(element, content) {
              const keywords = new Set();
              
              // Extract from data-keywords attribute
              const dataKeywords = element.dataset.keywords;
              if (dataKeywords) {
                  dataKeywords.split(',').forEach(kw => {
                      keywords.add(kw.trim().toLowerCase());
                  });
              }
              
              // Extract common cruise terms from content
              const commonTerms = [
                  'boarding', 'embarkation', 'disembarkation', 'muster', 'safety',
                  'dining', 'restaurant', 'reservation', 'excursion', 'port',
                  'sea day', 'formal night', 'captain', 'deck', 'cabin', 'room',
                  'stateroom', 'balcony', 'suite', 'promenade', 'pool', 'spa',
                  'gym', 'fitness', 'show', 'entertainment', 'kids', 'teen',
                  'adult', 'family', 'couple', 'group', 'booking', 'check-in'
              ];
              
              const contentLower = content.toLowerCase();
              commonTerms.forEach(term => {
                  if (contentLower.includes(term)) {
                      keywords.add(term);
                  }
              });
              
              return Array.from(keywords);
          }
          
          determinePriority(id, element) {
              // Higher number = higher priority
              if (id.includes('critical') || id.includes('emergency') || id.includes('safety')) {
                  return 5;
              }
              if (id.includes('operations') || id.includes('checklist')) {
                  return 4;
              }
              if (id.includes('itinerary') || id.includes('schedule')) {
                  return 3;
              }
              if (element.classList.contains('section--critical')) {
                  return 4;
              }
              return 2; // Default priority
          }
          
          async search(query, options = {}) {
              if (!query || query.trim() === '') {
                  return {
                      query: '',
                      results: [],
                      count: 0,
                      suggestions: this.getSuggestions('')
                  };
              }
              
              const normalizedQuery = query.toLowerCase().trim();
              this.currentQuery = normalizedQuery;
              
              // Add to history if not a repeat
              if (this.history[0] !== query) {
                  this.addToHistory(query);
              }
              
              // Filter and score results
              const results = this.index
                  .map(item => ({
                      ...item,
                      score: this.calculateScore(item, normalizedQuery)
                  }))
                  .filter(item => item.score > 0)
                  .sort((a, b) => {
                      // Sort by score (descending), then priority (descending)
                      if (b.score !== a.score) {
                          return b.score - a.score;
                      }
                      if (b.priority !== a.priority) {
                          return b.priority - a.priority;
                      }
                      if (a.critical && !b.critical) return -1;
                      if (!a.critical && b.critical) return 1;
                      return 0;
                  })
                  .slice(0, options.maxResults || 20);
              
              return {
                  query: query,
                  results: results,
                  count: results.length,
                  suggestions: this.getSuggestions(normalizedQuery),
                  timestamp: Date.now()
              };
          }
          
          calculateScore(item, query) {
              let score = 0;
              
              // Title match (highest weight)
              if (item.title.toLowerCase().includes(query)) {
                  score += 10;
                  
                  // Exact title match
                  if (item.title.toLowerCase() === query) {
                      score += 5;
                  }
              }
              
              // Content match
              if (item.content.toLowerCase().includes(query)) {
                  score += 5;
              }
              
              // Keyword matches
              if (item.keywords && item.keywords.some(kw => kw.includes(query))) {
                  score += 3;
              }
              
              // Priority boost
              score += item.priority;
              
              // Critical boost
              if (item.critical) {
                  score += 2;
              }
              
              // Recency boost (if applicable)
              if (item.timestamp) {
                  const age = Date.now() - item.timestamp;
                  const daysOld = age / (1000 * 60 * 60 * 24);
                  if (daysOld < 7) {
                      score += 1;
                  }
              }
              
              return score;
          }
          
          getSuggestions(query) {
              if (!query || query.length < 2) {
                  return this.getPopularSearches();
              }
              
              const suggestions = new Set();
              
              // Find matching items in index
              this.index.forEach(item => {
                  if (item.title.toLowerCase().includes(query)) {
                      suggestions.add(item.title);
                  }
                  
                  if (item.keywords) {
                      item.keywords.forEach(kw => {
                          if (kw.includes(query)) {
                              suggestions.add(kw);
                          }
                      });
                  }
              });
              
              // Add from history
              this.history.forEach(historyItem => {
                  if (historyItem.toLowerCase().includes(query)) {
                      suggestions.add(historyItem);
                  }
              });
              
              // Add common suggestions
              const common = [
                  'What time do I board?',
                  'Where is my room?',
                  'eMuster Station F6',
                  'Dining reservations',
                  'Shore excursions',
                  'Wi-Fi package',
                  'Formal night schedule',
                  'Kids activities',
                  'Drink package',
                  'Port shopping'
              ];
              
              common.forEach(item => {
                  if (item.toLowerCase().includes(query)) {
                      suggestions.add(item);
                  }
              });
              
              return Array.from(suggestions).slice(0, 8);
          }
          
          getPopularSearches() {
              return [
                  'eMuster Station F6',
                  'George Town, Grand Cayman',
                  'Perfect Day at CocoCay',
                  'Dunns River Falls',
                  'Formal night',
                  'Wi-Fi package',
                  'Dining reservations',
                  'What to pack'
              ];
          }
          
         highlightText(text, query) {
         if (!query || !text) return text;
         
         // Escape HTML in both text and query first
         const escapedText = this.escapeHtml(text);
         const escapedQuery = this.escapeRegExp(this.escapeHtml(query));
         
         const regex = new RegExp(`(${escapedQuery})`, 'gi');
         return escapedText.replace(regex, '<mark class="search-highlight">$1</mark>');
         }
         
         escapeHtml(text) {
         const div = document.createElement('div');
         div.textContent = text;
         return div.innerHTML;
         }
          
          escapeRegExp(string) {
              return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
          }
          
          getIndexStats() {
              return {
                  totalItems: this.index.length,
                  sections: this.index.filter(item => item.type === 'section').length,
                  features: this.index.filter(item => item.type === 'feature').length,
                  excursions: this.index.filter(item => item.type === 'excursion').length,
                  criticalItems: this.index.filter(item => item.critical).length,
                  lastIndexed: this.index.length > 0 ? 
                      new Date(Math.max(...this.index.map(i => i.timestamp || 0))) : null
              };
          }
         }
         
         // ============================================================================
         // NAVIGATION MANAGER
         // ============================================================================
         
         class NavigationManager {
          constructor() {
              this.currentSection = 'overview';
              this.currentDay = 'all';
              this.currentTravelerView = 'all';
              this.previousSection = null;
              this.sectionHistory = [];
              this.maxHistory = 10;
              this.observers = new Set();
              this.errorHandler = new ErrorHandler();
              this.isNavigating = false;
              
              this.availableSections = this.detectAvailableSections();
              this.availableDays = this.detectAvailableDays();
              this.availableTravelerViews = ['all', 'family', 'adults', 'kids'];
          }
          
          detectAvailableSections() {
              const sections = document.querySelectorAll('section[id]');
              return Array.from(sections).map(section => section.id);
          }
          
          detectAvailableDays() {
              const dayButtons = document.querySelectorAll('.day-btn[data-day]');
              return Array.from(dayButtons).map(btn => btn.dataset.day);
          }
          
          async navigateToSection(sectionId, options = {}) {
              if (this.isNavigating) {
                  console.warn('Navigation already in progress');
                  return false;
              }
              
              if (!this.availableSections.includes(sectionId)) {
                  this.errorHandler.log(new Error(`Invalid section: ${sectionId}`), 'NavigationManager.navigateToSection');
                  return false;
              }
              
              this.isNavigating = true;
              
              try {
                  // Store previous section
                  if (this.currentSection && options.addToHistory !== false) {
                      this.previousSection = this.currentSection;
                      this.sectionHistory.push({
                          section: this.currentSection,
                          timestamp: Date.now(),
                          scrollY: window.scrollY
                      });
                      
                      // Trim history if needed
                      if (this.sectionHistory.length > this.maxHistory) {
                          this.sectionHistory.shift();
                      }
                  }
                  
                  // Update current section
                  this.currentSection = sectionId;
                  
                  // Update UI
                  this.updateSectionVisibility(sectionId);
                  this.updateNavigationHighlights(sectionId);
                  this.updateURLHash(sectionId);
                  
                  // Scroll to section
                  if (options.scroll !== false) {
                      await this.scrollToSection(sectionId, options.scrollOptions);
                  }
                  
                  // Notify observers
                  this.notifyObservers({
                      type: 'sectionChange',
                      section: sectionId,
                      previous: this.previousSection,
                      timestamp: Date.now()
                  });
                  
                  return true;
              } catch (error) {
                  this.errorHandler.log(error, 'NavigationManager.navigateToSection');
                  return false;
              } finally {
                  this.isNavigating = false;
              }
          }
          
          updateSectionVisibility(sectionId) {
              document.querySelectorAll('section[id]').forEach(section => {
                  const isActive = section.id === sectionId;
                  
                  if (isActive) {
                      section.removeAttribute('hidden');
                      section.setAttribute('aria-hidden', 'false');
                      section.classList.add('active');
                  } else {
                      section.setAttribute('hidden', 'true');
                      section.setAttribute('aria-hidden', 'true');
                      section.classList.remove('active');
                  }
              });
              
              const currentSection = document.getElementById(sectionId);
              if (currentSection) {
                  this.expandSectionCard(currentSection);
                  
                  // If it's itinerary, apply day filter
                  if (sectionId === 'itinerary') {
                      this.applyDayFilter(this.currentDay);
                  }
              }
          }
          
          expandSectionCard(section) {
              const toggle = section.querySelector('.card__toggle');
              const content = section.querySelector('.card__content');
              
              if (!toggle || !content) return;
              
              toggle.setAttribute('aria-expanded', 'true');
              content.classList.remove('collapsed');
              content.classList.add('expanded');
              content.setAttribute('aria-hidden', 'false');
              content.style.maxHeight = 'none';
          }
          
          updateNavigationHighlights(sectionId) {
              // Update all navigation elements
              const navSelectors = [
                  '.nav-link',
                  '.sidebar-link',
                  '.drawer-nav-item',
                  '.bottom-nav .nav-item[data-section]',
                  '.quick-start__link'
              ];
              
              navSelectors.forEach(selector => {
                  document.querySelectorAll(selector).forEach(element => {
                      const isActive = element.dataset.section === sectionId;
                      element.classList.toggle('active', isActive);
                      element.setAttribute('aria-current', isActive ? 'page' : 'false');
                      
                      if (element.tagName === 'BUTTON') {
                          element.setAttribute('aria-pressed', isActive.toString());
                      }
                  });
              });
          }
          
          updateURLHash(sectionId) {
              const newHash = `#${sectionId}`;
              if (window.location.hash !== newHash) {
                  history.replaceState(null, '', newHash);
              }
          }
          
          async scrollToSection(sectionId, options = {}) {
         const section = document.getElementById(sectionId);
         if (!section) return false;
         
         const defaultOptions = {
         behavior: 'smooth',
         offset: this.calculateScrollOffset()
         };
         
         const { behavior, offset } = { ...defaultOptions, ...options };
         
         try {
         // Compute absolute scroll target with offset
         const rect = section.getBoundingClientRect();
         const targetTop = window.pageYOffset + rect.top - offset;
         
         // Perform scroll
         window.scrollTo({
         top: targetTop,
         behavior
         });
         
         // Wait for scroll to settle
         await new Promise(resolve => {
         let lastY = null;
         let stableFrames = 0;
         
         const checkScroll = () => {
         const currentY = window.pageYOffset;
         
         if (lastY !== null && Math.abs(currentY - lastY) < 1) {
          stableFrames++;
          if (stableFrames >= 3) {
            resolve();
            return;
          }
         } else {
          stableFrames = 0;
         }
         
         lastY = currentY;
         requestAnimationFrame(checkScroll);
         };
         
         requestAnimationFrame(checkScroll);
         });
         
         return true;
         } catch (error) {
         this.errorHandler.log(error, 'NavigationManager.scrollToSection');
         return false;
         }
         }
          
          calculateScrollOffset() {
         const elements = [
         document.querySelector('.header'),
         document.getElementById('topBarHint'),
         document.querySelector('.day-selector')
         ];
         
         let offset = 0;
         
         for (const el of elements) {
         if (!el) continue;
         
         const style = window.getComputedStyle(el);
         const isVisible =
         style.display !== 'none' &&
         style.visibility !== 'hidden' &&
         el.getBoundingClientRect().height > 0 &&
         !el.hasAttribute('aria-hidden');
         
         if (isVisible) {
         offset += el.getBoundingClientRect().height;
         }
         }
         
         // Add breathing room only when there is chrome to clear
         return offset > 0 ? offset + 16 : 0;
         }
          
          setCurrentDay(day) {
              if (!this.availableDays.includes(day)) {
                  console.warn(`Invalid day: ${day}`);
                  return false;
              }
              
              this.currentDay = day;
              
              // Update day buttons
              document.querySelectorAll('.day-btn').forEach(btn => {
                  const isActive = btn.dataset.day === day;
                  btn.classList.toggle('active', isActive);
                  btn.setAttribute('aria-pressed', isActive.toString());
              });
              
              // Apply filter if on itinerary
              if (this.currentSection === 'itinerary') {
                  this.applyDayFilter(day);
              }
              
              // Notify observers
              this.notifyObservers({
                  type: 'dayChange',
                  day: day,
                  timestamp: Date.now()
              });
              
              return true;
          }
          
          applyDayFilter(day) {
              const timelineItems = document.querySelectorAll('.timeline-item');
              
              timelineItems.forEach(item => {
                  const itemDay = item.dataset.day;
                  const shouldShow = day === 'all' || itemDay === day;
                  
                  item.style.display = shouldShow ? 'block' : 'none';
                  
                  if (shouldShow) {
                      item.removeAttribute('aria-hidden');
                  } else {
                      item.setAttribute('aria-hidden', 'true');
                  }
              });
          }
          
          setTravelerView(view) {
              if (!this.availableTravelerViews.includes(view)) {
                  console.warn(`Invalid traveler view: ${view}`);
                  return false;
              }
              
              this.currentTravelerView = view;
              
              // Update traveler selector
              const travelerSelect = document.getElementById('travelerSelect');
              if (travelerSelect) {
                  travelerSelect.value = view;
              }
              
              // Apply view filter
              this.applyTravelerViewFilter(view);
              
              // Notify observers
              this.notifyObservers({
                  type: 'travelerViewChange',
                  view: view,
                  timestamp: Date.now()
              });
              
              return true;
          }
          
          applyTravelerViewFilter(view) {
              // This is a simplified filter - in production you would
              // have data attributes on elements to filter by
              const elementsToFilter = document.querySelectorAll('[data-traveler-view]');
              
              elementsToFilter.forEach(element => {
                  const elementViews = element.dataset.travelerView.split(' ');
                  const shouldShow = view === 'all' || elementViews.includes(view);
                  
                  element.classList.toggle('hidden', !shouldShow);
                  element.setAttribute('aria-hidden', (!shouldShow).toString());
              });
          }
          
          goBack() {
              if (this.sectionHistory.length === 0) {
                  return false;
              }
              
              const previous = this.sectionHistory.pop();
              if (previous && previous.section) {
                  return this.navigateToSection(previous.section, {
                      scrollOptions: {
                          behavior: 'auto',
                          block: 'start'
                      }
                  });
              }
              
              return false;
          }
          
          addObserver(observer) {
              this.observers.add(observer);
          }
          
          removeObserver(observer) {
              this.observers.delete(observer);
          }
          
          notifyObservers(data) {
              this.observers.forEach(observer => {
                  try {
                      if (typeof observer === 'function') {
                          observer(data);
                      } else if (observer && typeof observer.update === 'function') {
                          observer.update(data);
                      }
                  } catch (error) {
                      this.errorHandler.log(error, 'NavigationManager.notifyObservers');
                  }
              });
          }
          
          getNavigationState() {
              return {
                  currentSection: this.currentSection,
                  currentDay: this.currentDay,
                  currentTravelerView: this.currentTravelerView,
                  previousSection: this.previousSection,
                  historyLength: this.sectionHistory.length,
                  availableSections: [...this.availableSections],
                  availableDays: [...this.availableDays]
              };
          }
         }
         
         // ============================================================================
         // UI COMPONENTS MANAGER
         // ============================================================================
         
         class UIComponentsManager {
          constructor() {
              this.errorHandler = new ErrorHandler();
              this.components = new Map();
              this.initialized = false;
          }
          
          async initialize() {
              if (this.initialized) return true;
              
              try {
                  await this.initializeAccordions();
                  await this.initializeModals();
                  await this.initializeToasts();
                  await this.initializeTabs();
                  await this.initializeTooltips();
                  
                  this.initialized = true;
                  return true;
              } catch (error) {
                  this.errorHandler.log(error, 'UIComponentsManager.initialize');
                  return false;
              }
          }
          
          async initializeAccordions() {
              const accordions = document.querySelectorAll('[data-accordion]');
              
              accordions.forEach(accordion => {
                  const toggle = accordion.querySelector('[data-accordion-toggle]');
                  const content = accordion.querySelector('[data-accordion-content]');
                  
                  if (!toggle || !content) return;
                  
                  const isExpanded = accordion.dataset.expanded === 'true';
                  
                  // Set initial state
                  toggle.setAttribute('aria-expanded', isExpanded.toString());
                  content.setAttribute('aria-hidden', (!isExpanded).toString());
                  
                  if (isExpanded) {
                      content.classList.add('expanded');
                      content.classList.remove('collapsed');
                      content.style.maxHeight = content.scrollHeight + 'px';
                  } else {
                      content.classList.add('collapsed');
                      content.classList.remove('expanded');
                      content.style.maxHeight = '0';
                  }
                  
                  // Add click handler
                  toggle.addEventListener('click', () => {
                      this.toggleAccordion(accordion);
                  });
                  
                  // Add keyboard support
                  toggle.addEventListener('keydown', (e) => {
                      if (e.key === 'Enter' || e.key === ' ') {
                          e.preventDefault();
                          this.toggleAccordion(accordion);
                      }
                  });
                  
                  this.components.set(`accordion-${accordion.id || Date.now()}`, {
                      type: 'accordion',
                      element: accordion,
                      toggle: toggle,
                      content: content
                  });
              });
          }
          
          toggleAccordion(accordion) {
              const component = this.components.get(`accordion-${accordion.id}`);
              if (!component) return;
              
              const isExpanded = component.toggle.getAttribute('aria-expanded') === 'true';
              const newState = !isExpanded;
              
              // Update toggle
              component.toggle.setAttribute('aria-expanded', newState.toString());
              
              // Update content
              component.content.setAttribute('aria-hidden', (!newState).toString());
              
              if (newState) {
                  // Expand
                  component.content.classList.remove('collapsed');
                  component.content.classList.add('expanded');
                  component.content.style.maxHeight = component.content.scrollHeight + 'px';
                  
                  // After transition, set to auto
                  setTimeout(() => {
                      if (component.content.classList.contains('expanded')) {
                          component.content.style.maxHeight = 'none';
                      }
                  }, 300);
              } else {
                  // Collapse
                  component.content.classList.remove('expanded');
                  component.content.classList.add('collapsed');
                  component.content.style.maxHeight = component.content.scrollHeight + 'px';
                  
                  // Trigger reflow
                  component.content.offsetHeight;
                  
                  // Animate collapse
                  component.content.style.maxHeight = '0';
              }
          }
          
         async initializeModals() {
         const modals = document.querySelectorAll('[data-modal]');
         
         modals.forEach(modal => {
         if (!modal.id) return;
         
         const openButtons = document.querySelectorAll(
         `[data-modal-open="${modal.id}"]`
         );
         const closeButtons = modal.querySelectorAll('[data-modal-close]');
         const overlay = modal.querySelector('[data-modal-overlay]');
         
         // Initial state
         modal.setAttribute('aria-hidden', 'true');
         modal.removeAttribute('aria-modal');
         
         // Prevent double-binding
         if (modal.dataset.initialized) return;
         modal.dataset.initialized = 'true';
         
         // Open handlers
         openButtons.forEach(button => {
         button.addEventListener('click', () => {
         this.openModal(modal.id, button);
         });
         });
         
         // Close handlers
         closeButtons.forEach(button => {
         button.addEventListener('click', () => {
         this.closeModal(modal.id);
         });
         });
         
         // Overlay click (only if actual overlay)
         if (overlay) {
         overlay.addEventListener('click', e => {
         if (e.target === overlay) {
          this.closeModal(modal.id);
         }
         });
         }
         
         // Global Escape handling (reliable)
         document.addEventListener('keydown', e => {
         if (
         e.key === 'Escape' &&
         modal.getAttribute('aria-hidden') === 'false'
         ) {
         this.closeModal(modal.id);
         }
         });
         
         this.components.set(`modal-${modal.id}`, {
         type: 'modal',
         element: modal,
         openButtons,
         closeButtons,
         overlay
         });
         });
         }
         openModal(modalId, opener = null) {
         const modal = document.getElementById(modalId);
         if (!modal) return false;
         
         // Store opener for correct focus restore
         modal.__opener = opener || document.activeElement;
         
         // ARIA state
         modal.setAttribute('aria-hidden', 'false');
         modal.setAttribute('aria-modal', 'true');
         modal.classList.add('active');
         
         // Lock scroll (iOS-safe)
         this._scrollY = window.scrollY;
         document.body.style.position = 'fixed';
         document.body.style.top = `-${this._scrollY}px`;
         document.body.style.width = '100%';
         
         // Trap focus once
         this.trapFocus(modal);
         
         // Move focus inside modal
         const focusTarget =
         modal.querySelector('[autofocus]') ||
         modal.querySelector(
         'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
         );
         
         focusTarget?.focus();
         
         this.announceToScreenReader('Modal opened');
         return true;
         }
         
         closeModal(modalId) {
         const modal = document.getElementById(modalId);
         if (!modal) return false;
         
         // ARIA state
         modal.setAttribute('aria-hidden', 'true');
         modal.removeAttribute('aria-modal');
         modal.classList.remove('active');
         
         // Restore scroll
         document.body.style.position = '';
         document.body.style.top = '';
         document.body.style.width = '';
         window.scrollTo(0, this._scrollY || 0);
         
         // Restore focus
         modal.__opener?.focus?.();
         delete modal.__opener;
         
         this.announceToScreenReader('Modal closed');
         return true;
         }
         
         trapFocus(element) {
         if (element.__focusTrapAttached) return;
         element.__focusTrapAttached = true;
         
         const focusableSelector =
         'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';
         
         element.addEventListener('keydown', e => {
         if (e.key !== 'Tab') return;
         
         const focusables = Array.from(
         element.querySelectorAll(focusableSelector)
         ).filter(el => !el.disabled && el.offsetParent !== null);
         
         if (focusables.length === 0) return;
         
         const first = focusables[0];
         const last = focusables[focusables.length - 1];
         
         if (e.shiftKey && document.activeElement === first) {
         e.preventDefault();
         last.focus();
         } else if (!e.shiftKey && document.activeElement === last) {
         e.preventDefault();
         first.focus();
         }
         });
         }
          
         async initializeToasts() {
         let toastContainer = document.getElementById('toast-container');
         if (!toastContainer) {
         toastContainer = DOMUtils.createElement('div', ['toast-container'], {
         id: 'toast-container',
         'aria-live': 'polite',
         'aria-atomic': 'true'
         });
         document.body.appendChild(toastContainer);
         }
         
         this.components.set('toast-container', {
         type: 'toast-container',
         element: toastContainer
         });
         }
          
         showToast(message, options = {}) {
         const container = this.components.get('toast-container')?.element;
         if (!container) return null;
         
         const toastId = `toast-${crypto.randomUUID?.() || Date.now() + Math.random()}`;
         
         const {
         type = 'info',
         duration = CONFIG.TOAST_DURATION,
         icon = this.getToastIcon(type),
         action = null,
         position = 'bottom-center'
         } = options;
         
         const toast = DOMUtils.createElement(
         'div',
         ['toast', `toast-${type}`, `toast-${position}`],
         {
         id: toastId,
         role: 'status',
         'aria-atomic': 'true'
         },
         `
         <div class="toast-content">
         <div class="toast-icon">${icon}</div>
         <div class="toast-message">${message}</div>
         ${action ? `<button class="toast-action">${action.label}</button>` : ''}
         <button class="toast-close" aria-label="Close notification">
          <i class="fas fa-times"></i>
         </button>
         </div>
         `
         );
         
         container.appendChild(toast);
         
         requestAnimationFrame(() => {
         toast.classList.add('show');
         });
         
         const hide = () => this.hideToast(toastId);
         
         toast.querySelector('.toast-close')?.addEventListener('click', hide);
         
         if (action) {
         toast.querySelector('.toast-action')?.addEventListener('click', () => {
         action.callback?.();
         hide();
         });
         }
         
         const timeoutId =
         duration > 0 ? setTimeout(hide, duration) : null;
         
         this.components.set(toastId, {
         type: 'toast',
         element: toast,
         timeoutId
         });
         
         return toastId;
         }
          
          hideToast(toastId) {
              const component = this.components.get(toastId);
              if (!component) return false;
              
              // Clear timeout if exists
              if (component.timeoutId) {
                  clearTimeout(component.timeoutId);
              }
              
              // Animate out
              component.element.classList.remove('show');
              
              // Remove from DOM after animation
              setTimeout(() => {
                  if (component.element.parentNode) {
                      component.element.parentNode.removeChild(component.element);
                  }
                  this.components.delete(toastId);
              }, 300);
              
              return true;
          }
          
          getToastIcon(type) {
              const icons = {
                  info: '<i class="fas fa-info-circle"></i>',
                  success: '<i class="fas fa-check-circle"></i>',
                  warning: '<i class="fas fa-exclamation-triangle"></i>',
                  error: '<i class="fas fa-exclamation-circle"></i>'
              };
              return icons[type] || icons.info;
          }
          
          async initializeTabs() {
              const tabContainers = document.querySelectorAll('[data-tabs]');
              
              tabContainers.forEach(container => {
                  const tabList = container.querySelector('[role="tablist"]');
                  const tabs = container.querySelectorAll('[role="tab"]');
                  const tabPanels = container.querySelectorAll('[role="tabpanel"]');
                  
                  if (!tabList || tabs.length === 0 || tabPanels.length === 0) return;
                  
                  // Set initial state
                  tabs.forEach((tab, index) => {
                      const isSelected = index === 0;
                      tab.setAttribute('aria-selected', isSelected.toString());
                      tab.setAttribute('tabindex', isSelected ? '0' : '-1');
                      
                      if (isSelected) {
                          tab.classList.add('active');
                      }
                      
                      // Add click handler
                      tab.addEventListener('click', () => {
                          this.activateTab(tab, container);
                      });
                      
                      // Add keyboard navigation
                      tab.addEventListener('keydown', (e) => {
                          this.handleTabKeydown(e, tab, tabs, container);
                      });
                  });
                  
                  // Set initial tabpanel state
                  tabPanels.forEach((panel, index) => {
                      const isSelected = index === 0;
                      panel.setAttribute('aria-hidden', (!isSelected).toString());
                      
                      if (isSelected) {
                          panel.classList.add('active');
                      } else {
                          panel.classList.add('hidden');
                      }
                  });
                  
                  this.components.set(`tabs-${container.id || Date.now()}`, {
                      type: 'tabs',
                      element: container,
                      tabList: tabList,
                      tabs: tabs,
                      tabPanels: tabPanels
                  });
              });
          }
          
          activateTab(selectedTab, container) {
              const component = this.components.get(`tabs-${container.id}`);
              if (!component) return;
              
              // Update all tabs
              component.tabs.forEach(tab => {
                  const isSelected = tab === selectedTab;
                  tab.setAttribute('aria-selected', isSelected.toString());
                  tab.setAttribute('tabindex', isSelected ? '0' : '-1');
                  tab.classList.toggle('active', isSelected);
                  
                  if (isSelected) {
                      tab.focus();
                  }
              });
              
              // Update all tabpanels
              component.tabPanels.forEach(panel => {
                  const controls = selectedTab.getAttribute('aria-controls');
                  const isSelected = panel.id === controls;
                  
                  panel.setAttribute('aria-hidden', (!isSelected).toString());
                  panel.classList.toggle('active', isSelected);
                  panel.classList.toggle('hidden', !isSelected);
              });
          }
          
          handleTabKeydown(event, currentTab, tabs, container) {
              let nextTab = null;
              
              switch (event.key) {
                  case 'ArrowLeft':
                  case 'ArrowUp':
                      event.preventDefault();
                      nextTab = currentTab.previousElementSibling || tabs[tabs.length - 1];
                      break;
                      
                  case 'ArrowRight':
                  case 'ArrowDown':
                      event.preventDefault();
                      nextTab = currentTab.nextElementSibling || tabs[0];
                      break;
                      
                  case 'Home':
                      event.preventDefault();
                      nextTab = tabs[0];
                      break;
                      
                  case 'End':
                      event.preventDefault();
                      nextTab = tabs[tabs.length - 1];
                      break;
              }
              
              if (nextTab) {
                  this.activateTab(nextTab, container);
              }
          }
          
          async initializeTooltips() {
              const tooltipElements = document.querySelectorAll('[data-tooltip]');
              
              tooltipElements.forEach(element => {
                  const tooltipText = element.dataset.tooltip;
                  
                  // Create tooltip element
                  const tooltip = DOMUtils.createElement('div', ['tooltip'], {
                      role: 'tooltip',
                      id: `tooltip-${element.id || Date.now()}`
                  }, tooltipText);
                  
                  // Position tooltip
                  const updatePosition = () => {
                      const rect = element.getBoundingClientRect();
                      const tooltipRect = tooltip.getBoundingClientRect();
                      
                      // Default position: bottom center
                      let top = rect.bottom + 8;
                      let left = rect.left + (rect.width / 2) - (tooltipRect.width / 2);
                      
                      // Adjust if out of viewport
                      if (top + tooltipRect.height > window.innerHeight) {
                          top = rect.top - tooltipRect.height - 8;
                      }
                      
                      if (left < 0) {
                          left = 8;
                      } else if (left + tooltipRect.width > window.innerWidth) {
                          left = window.innerWidth - tooltipRect.width - 8;
                      }
                      
                      tooltip.style.top = `${top}px`;
                      tooltip.style.left = `${left}px`;
                  };
                  
                  // Show tooltip
                  const showTooltip = () => {
                      if (!tooltip.parentNode) {
                          document.body.appendChild(tooltip);
                      }
                      
                      tooltip.classList.remove('hidden');
                      updatePosition();
                      
                      // Update position on resize
                      window.addEventListener('resize', updatePosition);
                  };
                  
                  // Hide tooltip
                  const hideTooltip = () => {
                      tooltip.classList.add('hidden');
                      window.removeEventListener('resize', updatePosition);
                      
                      // Remove from DOM after animation
                      setTimeout(() => {
                          if (tooltip.parentNode) {
                              tooltip.parentNode.removeChild(tooltip);
                          }
                      }, 300);
                  };
                  
                  // Add event listeners
                  element.addEventListener('mouseenter', showTooltip);
                  element.addEventListener('focus', showTooltip);
                  element.addEventListener('mouseleave', hideTooltip);
                  element.addEventListener('blur', hideTooltip);
                  
                  // Store reference
                  this.components.set(`tooltip-${element.id}`, {
                      type: 'tooltip',
                      element: tooltip,
                      target: element
                  });
              });
          }
          
          announceToScreenReader(message, priority = 'polite') {
              const announcement = DOMUtils.createElement('div', ['sr-announcement'], {
                  'aria-live': priority,
                  'aria-atomic': 'true'
              }, message);
              
              // Add to DOM
              document.body.appendChild(announcement);
              
              // Remove after announcement
              setTimeout(() => {
                  if (announcement.parentNode) {
                      announcement.parentNode.removeChild(announcement);
                  }
              }, 1000);
          }
          
          getComponent(id) {
              return this.components.get(id);
          }
          
          getAllComponents() {
              return Array.from(this.components.values());
          }
          
          destroyComponent(id) {
              const component = this.components.get(id);
              if (!component) return false;
              
              // Clean up based on component type
              switch (component.type) {
                  case 'modal':
                      this.closeModal(component.element.id);
                      break;
                  case 'toast':
                      this.hideToast(id);
                      break;
                  case 'tooltip':
                      if (component.element.parentNode) {
                          component.element.parentNode.removeChild(component.element);
                      }
                      break;
              }
              
              this.components.delete(id);
              return true;
          }
          
          destroyAllComponents() {
              const componentIds = Array.from(this.components.keys());
              componentIds.forEach(id => this.destroyComponent(id));
              this.components.clear();
          }
         }
         
         // ============================================================================
         // COUNTDOWN MANAGER
         // ============================================================================
         
         class CountdownManager {
          constructor(targetDate) {
              this.targetDate = new Date(targetDate);
              this.intervalId = null;
              this.isRunning = false;
              this.errorHandler = new ErrorHandler();
              this.observers = new Set();
              this.lastUpdate = null;
              
              // DOM elements
              this.daysElement = document.getElementById('days');
              this.hoursElement = document.getElementById('hours');
              this.minutesElement = document.getElementById('minutes');
              this.secondsElement = document.getElementById('seconds');
              
              // Check if date is valid
              if (isNaN(this.targetDate.getTime())) {
                  throw new Error('Invalid target date');
              }
          }
          
          start() {
              if (this.isRunning) {
                  console.warn('Countdown is already running');
                  return false;
              }
              
              this.isRunning = true;
              
              // Initial update
              this.update();
              
              // Start interval
              this.intervalId = setInterval(() => {
                  this.update();
              }, 1000);
              
              this.notifyObservers({
                  type: 'countdownStarted',
                  timestamp: Date.now()
              });
              
              return true;
          }
          
          stop() {
              if (!this.isRunning) return false;
              
              this.isRunning = false;
              
              if (this.intervalId) {
                  clearInterval(this.intervalId);
                  this.intervalId = null;
              }
              
              this.notifyObservers({
                  type: 'countdownStopped',
                  timestamp: Date.now()
              });
              
              return true;
          }
          
          update() {
              const now = new Date();
              const timeRemaining = this.targetDate - now;
              
              if (timeRemaining <= 0) {
                  this.handleCountdownComplete();
                  return;
              }
              
              // Calculate time units
              const days = Math.floor(timeRemaining / (1000 * 60 * 60 * 24));
              const hours = Math.floor((timeRemaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
              const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
              const seconds = Math.floor((timeRemaining % (1000 * 60)) / 1000);
              
              // Update DOM with animation
              this.updateElementWithAnimation(this.daysElement, days, 'days');
              this.updateElementWithAnimation(this.hoursElement, hours, 'hours');
              this.updateElementWithAnimation(this.minutesElement, minutes, 'minutes');
              
              if (this.secondsElement) {
                  this.updateElementWithAnimation(this.secondsElement, seconds, 'seconds');
              }
              
              // Store last update
              this.lastUpdate = {
                  timestamp: now,
                  days: days,
                  hours: hours,
                  minutes: minutes,
                  seconds: seconds,
                  totalSeconds: Math.floor(timeRemaining / 1000)
              };
              
              // Notify observers
              this.notifyObservers({
                  type: 'countdownUpdated',
                  data: this.lastUpdate,
                  timestamp: Date.now()
              });
          }
          
          updateElementWithAnimation(element, newValue, unit) {
              if (!element) return;
              
              const oldValue = parseInt(element.textContent) || 0;
              
              if (oldValue !== newValue) {
                  // Add animation class
                  element.classList.add('countdown-changing');
                  
                  // Update value
                  element.textContent = newValue.toString().padStart(2, '0');
                  element.setAttribute('aria-label', `${newValue} ${unit} remaining`);
                  
                  // Remove animation class after animation completes
                  setTimeout(() => {
                      element.classList.remove('countdown-changing');
                  }, 300);
              } else {
                  // Just update aria-label
                  element.setAttribute('aria-label', `${newValue} ${unit} remaining`);
              }
          }
          
          handleCountdownComplete() {
              this.stop();
              
              // Update display to show completion
              if (this.daysElement) this.daysElement.textContent = '00';
              if (this.hoursElement) this.hoursElement.textContent = '00';
              if (this.minutesElement) this.minutesElement.textContent = '00';
              if (this.secondsElement) this.secondsElement.textContent = '00';
              
              // Update hero title
              const heroTitle = document.getElementById('heroTitle');
              if (heroTitle) {
                  heroTitle.textContent = 'Bon Voyage! üö¢';
                  heroTitle.classList.add('countdown-complete');
              }
              
              // Show celebration message
              this.notifyObservers({
                  type: 'countdownComplete',
                  timestamp: Date.now(),
                  message: 'Countdown complete! The cruise has begun!'
              });
              
              // Play celebration sound (optional)
              this.playCelebrationSound();
          }
          
          playCelebrationSound() {
              // This is a placeholder - in production you would use actual audio
              console.log('üéâ Countdown complete! Playing celebration sound...');
              
              // Example with Web Audio API
              if (typeof Audio !== 'undefined') {
                  try {
                      const audio = new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAZGF0YQ');
                      audio.volume = 0.3;
                      audio.play().catch(e => console.log('Audio play failed:', e));
                  } catch (error) {
                      this.errorHandler.log(error, 'CountdownManager.playCelebrationSound');
                  }
              }
          }
          
          getTimeRemaining() {
              const now = new Date();
              const timeRemaining = this.targetDate - now;
              
              if (timeRemaining <= 0) {
                  return {
                      days: 0,
                      hours: 0,
                      minutes: 0,
                      seconds: 0,
                      totalSeconds: 0,
                      isComplete: true
                  };
              }
              
              return {
                  days: Math.floor(timeRemaining / (1000 * 60 * 60 * 24)),
                  hours: Math.floor((timeRemaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)),
                  minutes: Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60)),
                  seconds: Math.floor((timeRemaining % (1000 * 60)) / 1000),
                  totalSeconds: Math.floor(timeRemaining / 1000),
                  isComplete: false
              };
          }
          
          formatTimeRemaining(format = 'long') {
              const time = this.getTimeRemaining();
              
              if (time.isComplete) {
                  return 'The cruise has begun!';
              }
              
              switch (format) {
                  case 'short':
                      return `${time.days}d ${time.hours}h ${time.minutes}m`;
                  case 'compact':
                      return `${time.days}:${time.hours.toString().padStart(2, '0')}:${time.minutes.toString().padStart(2, '0')}`;
                  case 'verbose':
                      const parts = [];
                      if (time.days > 0) parts.push(`${time.days} day${time.days !== 1 ? 's' : ''}`);
                      if (time.hours > 0) parts.push(`${time.hours} hour${time.hours !== 1 ? 's' : ''}`);
                      if (time.minutes > 0) parts.push(`${time.minutes} minute${time.minutes !== 1 ? 's' : ''}`);
                      return parts.join(', ');
                  case 'long':
                  default:
                      return `${time.days} days, ${time.hours} hours, ${time.minutes} minutes`;
              }
          }
          
          addObserver(observer) {
              this.observers.add(observer);
          }
          
          removeObserver(observer) {
              this.observers.delete(observer);
          }
          
          notifyObservers(data) {
              this.observers.forEach(observer => {
                  try {
                      if (typeof observer === 'function') {
                          observer(data);
                      } else if (observer && typeof observer.update === 'function') {
                          observer.update(data);
                      }
                  } catch (error) {
                      this.errorHandler.log(error, 'CountdownManager.notifyObservers');
                  }
              });
          }
          
          destroy() {
              this.stop();
              this.observers.clear();
              
              // Clean up DOM references
              this.daysElement = null;
              this.hoursElement = null;
              this.minutesElement = null;
              this.secondsElement = null;
          }
         }
         
         // ============================================================================
         // WEATHER MANAGER
         // ============================================================================
         
         class WeatherManager {
          constructor() {
              this.currentWeather = null;
              this.forecast = [];
              this.intervalId = null;
              this.isFetching = false;
              this.errorHandler = new ErrorHandler();
              this.observers = new Set();
              this.useMockData = false; // Uses Open-Meteo when available; falls back to mock data
              
              // DOM elements
              this.tempElement = document.getElementById('weatherTemp');
              this.conditionElement = document.getElementById('weatherCondition');
              this.iconElement = document.querySelector('.weather-icon');
              this.summaryElement = document.getElementById('weatherSummary');
              this.forecastListElement = document.getElementById('weatherForecastList');
              
              // Mock weather data for Caribbean in February
              this.mockWeatherConditions = [
                  { temp: '84¬∞F', condition: 'Sunny', icon: '‚òÄÔ∏è', description: 'Perfect beach weather', humidity: '65%', wind: '12 mph' },
                  { temp: '82¬∞F', condition: 'Partly Cloudy', icon: 'üå§Ô∏è', description: 'Ideal for outdoor activities', humidity: '68%', wind: '10 mph' },
                  { temp: '81¬∞F', condition: 'Mostly Sunny', icon: '‚õÖ', description: 'Warm with light breeze', humidity: '70%', wind: '8 mph' },
                  { temp: '80¬∞F', condition: 'Light Showers', icon: 'üå¶Ô∏è', description: 'Brief rain, mostly sunny', humidity: '75%', wind: '15 mph' },
                  { temp: '83¬∞F', condition: 'Clear Skies', icon: '‚ú®', description: 'Beautiful stargazing tonight', humidity: '62%', wind: '6 mph' },
                  { temp: '79¬∞F', condition: 'Breezy', icon: 'üí®', description: 'Cooler with strong winds', humidity: '60%', wind: '20 mph' },
                  { temp: '85¬∞F', condition: 'Hot & Humid', icon: 'üî•', description: 'High humidity, stay hydrated', humidity: '80%', wind: '5 mph' }
              ];
          }
          
          async initialize() {
              try {
                  // Load initial weather
                  await this.fetchWeather();
                  
                  // Start periodic updates (every 15 minutes for real API, every 30 seconds for demo)
                  this.intervalId = setInterval(() => {
                      this.fetchWeather();
                  }, this.useMockData ? 30000 : 900000); // 30 seconds for demo, 15 minutes for production
                  
                  return true;
              } catch (error) {
                  this.errorHandler.log(error, 'WeatherManager.initialize');
                  return false;
              }
          }
          
          async fetchWeather() {
              if (this.isFetching) {
                  console.warn('Weather fetch already in progress');
                  return null;
              }
              
              this.isFetching = true;
              
              try {
                  let weatherData;
                  
                  if (this.useMockData) {
                      // Use mock data
                      weatherData = await this.fetchMockWeather();
                  } else {
                      // Fetch from real API
                      weatherData = await this.fetchApiWeather();
                  }
                  
                  if (weatherData) {
                      this.currentWeather = weatherData;
                      this.updateDisplay();
                      
                      this.notifyObservers({
                          type: 'weatherUpdated',
                          data: weatherData,
                          timestamp: Date.now()
                      });
                  }
                  
                  return weatherData;
              } catch (error) {
                  this.errorHandler.log(error, 'WeatherManager.fetchWeather');
                  
                  // Fallback to mock data
                  const fallbackData = await this.fetchMockWeather();
                  this.currentWeather = fallbackData;
                  this.updateDisplay();
                  
                  return fallbackData;
              } finally {
                  this.isFetching = false;
              }
          }
          
          async fetchMockWeather() {
              // Simulate API delay
              await PerformanceUtils.sleep(500);
              
              // Get random or sequential weather
              const weather = this.getRandomWeather();
              
              // Simulate forecast aligned to ports
              this.forecast = [];
              const cruiseStart = new Date(CONFIG.CRUISE_DATE);
              (CONFIG.PORTS || []).forEach(port => {
                  const forecastDay = new Date(cruiseStart);
                  forecastDay.setDate(cruiseStart.getDate() + (port.day - 1));
                  const mockCondition = this.mockWeatherConditions[Math.floor(Math.random() * this.mockWeatherConditions.length)];
                  const high = Math.floor(Math.random() * 10) + 78;
                  const low = Math.floor(Math.random() * 8) + 68;
                  
                  this.forecast.push({
                      date: forecastDay.toISOString().split('T')[0],
                      dayLabel: `Day ${port.day}`,
                      location: port.name,
                      high: `${high}¬∞F`,
                      low: `${low}¬∞F`,
                      condition: mockCondition.condition,
                      icon: mockCondition.icon,
                      precipitation: `${Math.floor(Math.random() * 40) + 10}%`
                  });
              });
              
              return {
                  ...weather,
                  forecast: this.forecast,
                  lastUpdated: new Date().toISOString(),
                  location: this.forecast[0]?.location || 'Caribbean Sea',
                  sunrise: '6:45 AM',
                  sunset: '6:15 PM',
                  uvIndex: '8 (Very High)',
                  visibility: '10 miles'
              };
          }
          
          async fetchApiWeather() {
              const ports = CONFIG.PORTS || [];
              if (!ports.length) {
                  throw new Error('No ports configured for weather lookup.');
              }
              
              const cruiseStart = new Date(CONFIG.CRUISE_DATE);
              const forecastRequests = ports.map(port => {
                  const portDate = new Date(cruiseStart);
                  portDate.setDate(cruiseStart.getDate() + (port.day - 1));
                  
                  const url = new URL('https://api.open-meteo.com/v1/forecast');
                  url.searchParams.set('latitude', port.latitude);
                  url.searchParams.set('longitude', port.longitude);
                  url.searchParams.set('daily', 'weathercode,temperature_2m_max,temperature_2m_min,precipitation_probability_max');
                  url.searchParams.set('forecast_days', '16');
                  url.searchParams.set('timezone', 'auto');
                  
                  return this.fetchPortForecast(url.toString(), port, portDate);
              });
              
              const results = await Promise.all(forecastRequests);
              const validResults = results.filter(Boolean);
              
              if (!validResults.length) {
                  throw new Error('No port forecasts returned.');
              }
              
              const currentWeather = validResults[0];
              return {
                  ...currentWeather,
                  forecast: validResults,
                  lastUpdated: new Date().toISOString(),
                  location: currentWeather.location
              };
          }
          
          async fetchPortForecast(url, port, portDate) {
              const response = await fetch(url, { method: 'GET' });
              
              if (!response.ok) {
                  throw new Error(`Weather API error: ${response.status}`);
              }
              
              const data = await response.json();
              const targetDate = portDate.toISOString().split('T')[0];
              const dayIndex = data?.daily?.time?.indexOf(targetDate);
              
              if (dayIndex === -1 || dayIndex == null) {
                  return null;
              }
              
              const weatherCode = data.daily.weathercode[dayIndex];
              const mapping = this.getWeatherFromCode(weatherCode);
              
              return {
                  date: targetDate,
                  dayLabel: `Day ${port.day}`,
                  location: port.name,
                  temp: `${Math.round(this.cToF(data.daily.temperature_2m_max[dayIndex]))}¬∞F`,
                  low: `${Math.round(this.cToF(data.daily.temperature_2m_min[dayIndex]))}¬∞F`,
                  high: `${Math.round(this.cToF(data.daily.temperature_2m_max[dayIndex]))}¬∞F`,
                  condition: mapping.label,
                  icon: mapping.icon,
                  precipitation: `${data.daily.precipitation_probability_max[dayIndex]}%`,
                  description: mapping.description
              };
          }
          
          getRandomWeather() {
              const randomIndex = Math.floor(Math.random() * this.mockWeatherConditions.length);
              return { ...this.mockWeatherConditions[randomIndex] };
          }
          
          getWeatherIcon(iconCode) {
              // Map OpenWeatherMap icons to emoji
              const iconMap = {
                  '01d': '‚òÄÔ∏è', '01n': 'üåô',
                  '02d': 'üå§Ô∏è', '02n': 'üå§Ô∏è',
                  '03d': '‚òÅÔ∏è', '03n': '‚òÅÔ∏è',
                  '04d': '‚òÅÔ∏è', '04n': '‚òÅÔ∏è',
                  '09d': 'üåßÔ∏è', '09n': 'üåßÔ∏è',
                  '10d': 'üå¶Ô∏è', '10n': 'üå¶Ô∏è',
                  '11d': '‚õàÔ∏è', '11n': '‚õàÔ∏è',
                  '13d': '‚ùÑÔ∏è', '13n': '‚ùÑÔ∏è',
                  '50d': 'üå´Ô∏è', '50n': 'üå´Ô∏è'
              };
              
              return iconMap[iconCode] || 'üå°Ô∏è';
          }
          
          getWeatherFromCode(code) {
              const mappings = {
                  0: { label: 'Clear', icon: '‚òÄÔ∏è', description: 'Clear skies' },
                  1: { label: 'Mainly Clear', icon: 'üå§Ô∏è', description: 'Mostly sunny' },
                  2: { label: 'Partly Cloudy', icon: '‚õÖ', description: 'Partly cloudy' },
                  3: { label: 'Overcast', icon: '‚òÅÔ∏è', description: 'Cloudy skies' },
                  45: { label: 'Fog', icon: 'üå´Ô∏è', description: 'Foggy conditions' },
                  48: { label: 'Rime Fog', icon: 'üå´Ô∏è', description: 'Low visibility fog' },
                  51: { label: 'Light Drizzle', icon: 'üå¶Ô∏è', description: 'Light drizzle' },
                  53: { label: 'Drizzle', icon: 'üå¶Ô∏è', description: 'Scattered drizzle' },
                  55: { label: 'Heavy Drizzle', icon: 'üåßÔ∏è', description: 'Steady drizzle' },
                  61: { label: 'Light Rain', icon: 'üåßÔ∏è', description: 'Light rain showers' },
                  63: { label: 'Rain', icon: 'üåßÔ∏è', description: 'Rainy conditions' },
                  65: { label: 'Heavy Rain', icon: 'üåßÔ∏è', description: 'Heavy rain' },
                  71: { label: 'Light Snow', icon: '‚ùÑÔ∏è', description: 'Light snow' },
                  73: { label: 'Snow', icon: '‚ùÑÔ∏è', description: 'Snow showers' },
                  75: { label: 'Heavy Snow', icon: '‚ùÑÔ∏è', description: 'Heavy snow' },
                  80: { label: 'Showers', icon: 'üå¶Ô∏è', description: 'Scattered showers' },
                  81: { label: 'Heavy Showers', icon: 'üåßÔ∏è', description: 'Heavy showers' },
                  82: { label: 'Thunder Showers', icon: '‚õàÔ∏è', description: 'Thunderstorms possible' },
                  95: { label: 'Thunderstorm', icon: '‚õàÔ∏è', description: 'Thunderstorms' }
              };
              
              return mappings[code] || { label: 'Mixed', icon: 'üå°Ô∏è', description: 'Variable conditions' };
          }
          
          cToF(celsius) {
              return (celsius * 9) / 5 + 32;
          }
          
          updateDisplay() {
         if (!this.currentWeather) return;
         
         // Animate changes
         this.animateWeatherChange();
         
         // Update DOM after animation
         setTimeout(() => {
         if (this.tempElement) {
            this.tempElement.textContent = this.currentWeather.temp;
            this.tempElement.setAttribute('aria-label', `Temperature: ${this.currentWeather.temp}`);
         }
         
         if (this.conditionElement) {
            this.conditionElement.textContent = this.currentWeather.condition;
            this.conditionElement.setAttribute('aria-label', `Conditions: ${this.currentWeather.condition}`);
         }
         
         if (this.iconElement) {
            this.iconElement.textContent = this.currentWeather.icon;
            this.iconElement.setAttribute('aria-label', this.currentWeather.description);
         }
         
         if (this.summaryElement) {
            this.summaryElement.textContent = `Latest forecast for ${this.currentWeather.location}.`;
         }
         
         if (this.forecastListElement) {
            this.forecastListElement.innerHTML = '';
            const forecastItems = this.currentWeather.forecast || [];
            if (forecastItems.length) {
                forecastItems.forEach(item => {
                    const listItem = document.createElement('li');
                    listItem.className = 'weather-forecast-item';
                    listItem.innerHTML = `
                        <span class="weather-forecast-icon" aria-hidden="true">${item.icon}</span>
                        <div>
                            <strong>${item.dayLabel}: ${item.location}</strong>
                            <div class="weather-forecast-meta">${item.condition} ‚Ä¢ ${item.precipitation} precip</div>
                        </div>
                        <div class="weather-forecast-temp">${item.high}/${item.low}</div>
                    `;
                    this.forecastListElement.appendChild(listItem);
                });
            } else {
                const fallback = document.createElement('li');
                fallback.className = 'weather-forecast-item';
                fallback.textContent = 'Forecast will appear closer to sailing.';
                this.forecastListElement.appendChild(fallback);
            }
         }
         }, 300);
         }
         
         animateWeatherChange() {
         if (this.tempElement) {
         this.tempElement.style.opacity = '0.3';
         this.tempElement.style.transform = 'scale(0.9)';
         }
         
         if (this.conditionElement) {
         this.conditionElement.style.opacity = '0.3';
         }
         
         if (this.iconElement) {
         this.iconElement.style.opacity = '0.3';
         this.iconElement.style.transform = 'rotate(-10deg)';
         }
         
         setTimeout(() => {
         if (this.tempElement) {
            this.tempElement.style.opacity = '1';
            this.tempElement.style.transform = 'scale(1)';
         }
         
         if (this.conditionElement) {
            this.conditionElement.style.opacity = '1';
         }
         
         if (this.iconElement) {
            this.iconElement.style.opacity = '1';
            this.iconElement.style.transform = 'rotate(0deg)';
         }
         }, 300);
         }
         
         addObserver(observer) {
         this.observers.add(observer);
         }
         
         removeObserver(observer) {
         this.observers.delete(observer);
         }
         
         notifyObservers(data) {
         this.observers.forEach(observer => {
         try {
            if (typeof observer === 'function') {
                observer(data);
            } else if (observer && typeof observer.update === 'function') {
                observer.update(data);
            }
         } catch (error) {
            this.errorHandler.log(error, 'WeatherManager.notifyObservers');
         }
         });
         }
         
         destroy() {
         if (this.intervalId) {
         clearInterval(this.intervalId);
         this.intervalId = null;
         }
         
         this.observers.clear();
         
         // Clean up DOM references
         this.tempElement = null;
         this.conditionElement = null;
         this.iconElement = null;
         this.summaryElement = null;
         this.forecastListElement = null;
         }
         }
         
         // ============================================================================
         // APPLICATION MAIN
         // ============================================================================
         
         class CruiseCompanionApp {
         constructor() {
         this.errorHandler = new ErrorHandler();
         this.storage = new StorageManager();
         this.navigation = new NavigationManager();
         this.search = new SearchManager();
         this.ui = new UIComponentsManager();
         this.countdown = new CountdownManager(CONFIG.CRUISE_DATE);
         this.weather = new WeatherManager();
         
         this.isInitialized = false;
         this.isLoading = false;
         this.offlineSaveInProgress = false;
         
         // Bind methods
         this.initialize = this.initialize.bind(this);
         this.handleError = this.handleError.bind(this);
         this.handleOnlineStatus = this.handleOnlineStatus.bind(this);
         }
         
         async initialize() {
         if (this.isInitialized) {
         console.warn('App is already initialized');
         return true;
         }
         
         if (this.isLoading) {
         console.warn('App is already loading');
         return false;
         }
         
         this.isLoading = true;
         
         try {
         // Show loading overlay
         this.showLoadingOverlay();
         
         // 1. Initialize error handling
         window.addEventListener('error', this.handleError);
         window.addEventListener('unhandledrejection', this.handleError);
         
         // 2. Initialize storage
         await this.initializeStorage();
         
         // 3. Initialize navigation
         await this.initializeNavigation();
         
         // 4. Initialize UI components
         await this.ui.initialize();
         
         // 5. Initialize search
         await this.search.buildIndex();
         
         // 6. Initialize countdown
         await this.initializeCountdown();
         
         // 7. Initialize weather
         await this.weather.initialize();
         
         // 8. Initialize event listeners
         await this.initializeEventListeners();
         
         // 9. Initialize deck plans
         await this.initializeDeckPlans();
         
         // 10. Initialize service worker (if available)
         await this.initializeServiceWorker();
         
         // 11. Finalize initialization
         await this.finalizeInitialization();
         
         this.isInitialized = true;
         
         // Hide loading overlay
         setTimeout(() => {
            this.hideLoadingOverlay();
         }, CONFIG.LOADING_DELAY);
         
         // Show welcome message
         setTimeout(() => {
            this.ui.showToast('Welcome to your Cruise Companion! üö¢', {
                type: 'success',
                duration: 3000
            });
         }, CONFIG.LOADING_DELAY + 500);
         
         console.log(`${CONFIG.APP_NAME} v${CONFIG.APP_VERSION} initialized successfully`);
         return true;
         
         } catch (error) {
         this.errorHandler.log(error, 'CruiseCompanionApp.initialize');
         
         // Show error screen
         this.showErrorScreen('Failed to initialize the app. Please refresh the page.');
         
         return false;
         } finally {
         this.isLoading = false;
         }
         }
         
         showLoadingOverlay() {
         const loadingOverlay = document.getElementById('loadingOverlay');
         if (loadingOverlay) {
         loadingOverlay.classList.remove('hidden');
         loadingOverlay.setAttribute('aria-busy', 'true');
         loadingOverlay.setAttribute('aria-label', 'Loading cruise companion');
         }
         }
         
         hideLoadingOverlay() {
         const loadingOverlay = document.getElementById('loadingOverlay');
         if (loadingOverlay) {
         loadingOverlay.classList.add('hidden');
         loadingOverlay.setAttribute('aria-busy', 'false');
         }
         }
         
         async initializeStorage() {
         // Load saved preferences
         const preferences = this.storage.loadPreferences();
         
         // Apply preferences
         if (preferences.compactMode) {
         this.toggleCompactMode(true);
         }
         
         if (preferences.criticalFilter) {
         this.toggleCriticalFilter(true);
         }
         
         // Check if hint was dismissed
         const hintDismissed = this.storage.get(CONFIG.STORAGE_KEYS.HINT_DISMISSED, false);
         if (hintDismissed) {
         this.hideTopBarHint();
         }
         }
         
         async initializeNavigation() {
         // Handle initial hash
         const hash = window.location.hash.replace('#', '');
         const initialSection = this.navigation.availableSections.includes(hash) ? hash : 'overview';
         
         await this.navigation.navigateToSection(initialSection, {
         scroll: false
         });
         
         // Handle hash changes
         window.addEventListener('hashchange', () => {
         const newHash = window.location.hash.replace('#', '');
         if (this.navigation.availableSections.includes(newHash)) {
            this.navigation.navigateToSection(newHash);
         }
         });
         
         // Add navigation observers
         this.navigation.addObserver((data) => {
         if (data.type === 'sectionChange') {
            // Update day selector visibility
            this.updateDaySelectorVisibility(data.section);
            
            // Update critical count badge
            this.updateCriticalCountBadge();
            
            // Announce to screen reader
            this.ui.announceToScreenReader(`Navigated to ${data.section} section`);
         }
         });
         }
         
         async initializeCountdown() {
         // Start countdown
         this.countdown.start();
         
         // Add observer for countdown updates
         this.countdown.addObserver((data) => {
         if (data.type === 'countdownComplete') {
            this.ui.showToast('Bon Voyage! Your cruise has begun! üö¢', {
                type: 'success',
                duration: 5000
            });
            
            // Update hero title
            const heroTitle = document.getElementById('heroTitle');
            if (heroTitle) {
                heroTitle.textContent = 'Bon Voyage! üö¢';
            }
         }
         });
         }
         
         async initializeEventListeners() {
         // Navigation buttons
         document.querySelectorAll('[data-section]').forEach(button => {
         button.addEventListener('click', (e) => {
            e.preventDefault();
            const section = button.dataset.section;
            this.navigation.navigateToSection(section);
         });
         });
         
         // Day selector buttons
         document.querySelectorAll('.day-btn').forEach(button => {
         button.addEventListener('click', () => {
            const day = button.dataset.day;
            this.navigation.setCurrentDay(day);
            
            // Update top bar hint
            this.updateTopBarHintForDay(day);
         });
         });

         // Itinerary day tabs
         const dayTabs = document.querySelectorAll('.day-tab');
         const timelineSteps = document.querySelectorAll('.timeline-step');
         if (dayTabs.length) {
         dayTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                dayTabs.forEach(btn => {
                    btn.classList.remove('active');
                    btn.setAttribute('aria-selected', 'false');
                });
                tab.classList.add('active');
                tab.setAttribute('aria-selected', 'true');
                
                const day = tab.dataset.day || 'all';
                this.navigation.setCurrentDay(day);
                this.updateTopBarHintForDay(day);
                
                timelineSteps.forEach(step => {
                    step.style.display = (day === 'all' || step.dataset.day === day) ? 'grid' : 'none';
                });
            });
         });
         }
         
         // Traveler selector
         const travelerSelect = document.getElementById('travelerSelect');
         if (travelerSelect) {
         travelerSelect.addEventListener('change', (e) => {
            this.navigation.setTravelerView(e.target.value);
         });
         }

         // Room view toggle
         const viewToggleButtons = document.querySelectorAll('.view-toggle__btn');
         const roomCardsView = document.getElementById('roomCardsView');
         const roomTableView = document.getElementById('roomTableView');
         if (viewToggleButtons.length && roomCardsView && roomTableView) {
         viewToggleButtons.forEach(button => {
            button.addEventListener('click', () => {
                const view = button.dataset.view || 'cards';
                viewToggleButtons.forEach(btn => {
                    btn.classList.remove('active');
                    btn.setAttribute('aria-selected', 'false');
                });
                button.classList.add('active');
                button.setAttribute('aria-selected', 'true');
                
                if (view === 'table') {
                    roomCardsView.classList.remove('active');
                    roomTableView.classList.add('active');
                } else {
                    roomTableView.classList.remove('active');
                    roomCardsView.classList.add('active');
                }
            });
         });
         }

         // Itinerary detail toggles
         document.querySelectorAll('.step-expand').forEach(button => {
         button.setAttribute('aria-expanded', 'false');
         button.addEventListener('click', () => {
            const details = button.closest('.step-details');
            if (!details) return;
            const expanded = details.classList.toggle('is-expanded');
            button.setAttribute('aria-expanded', expanded.toString());
            const icon = button.querySelector('i');
            if (icon) {
                icon.className = expanded ? 'fas fa-chevron-up' : 'fas fa-chevron-down';
            }
         });
         });
         
         // Search functionality
         this.initializeSearchListeners();
         
         // Card toggles
         document.querySelectorAll('.card__toggle').forEach(toggle => {
         toggle.addEventListener('click', () => {
            const card = toggle.closest('.card');
            const content = card.querySelector('.card__content');
            
            if (content.classList.contains('collapsed')) {
                // Expand
                content.classList.remove('collapsed');
                content.classList.add('expanded');
                content.style.maxHeight = content.scrollHeight + 'px';
                toggle.setAttribute('aria-expanded', 'true');
                toggle.querySelector('i').className = 'fas fa-chevron-up';
                
                // After transition, set to auto
                setTimeout(() => {
                    if (content.classList.contains('expanded')) {
                        content.style.maxHeight = 'none';
                    }
                }, 300);
            } else {
                // Collapse
                content.classList.remove('expanded');
                content.classList.add('collapsed');
                content.style.maxHeight = content.scrollHeight + 'px';
                
                // Trigger reflow
                content.offsetHeight;
                
                // Animate collapse
                content.style.maxHeight = '0';
                toggle.setAttribute('aria-expanded', 'false');
                toggle.querySelector('i').className = 'fas fa-chevron-down';
            }
         });
         });
         
         // Critical filter toggle
         const criticalToggleBtn = document.getElementById('criticalToggleBtn');
         if (criticalToggleBtn) {
         criticalToggleBtn.addEventListener('click', () => {
            const isActive = criticalToggleBtn.getAttribute('aria-pressed') === 'true';
            this.toggleCriticalFilter(!isActive);
         });
         }

         // View mode toggle
         const modeButtons = document.querySelectorAll('.mode-btn');
         if (modeButtons.length) {
         modeButtons.forEach(button => {
            button.addEventListener('click', () => {
                modeButtons.forEach(btn => {
                    btn.classList.remove('active');
                    btn.setAttribute('aria-checked', 'false');
                });
                button.classList.add('active');
                button.setAttribute('aria-checked', 'true');
                document.body.dataset.viewMode = button.dataset.mode || 'today';
            });
         });
         }
         
         // Compact mode toggle
         const compactToggleBtn = document.getElementById('compactToggleBtn');
         if (compactToggleBtn) {
         compactToggleBtn.addEventListener('click', () => {
            const isActive = compactToggleBtn.getAttribute('aria-pressed') === 'true';
            this.toggleCompactMode(!isActive);
         });
         }
         
         // Jump to critical button
         const jumpToCriticalBtn = document.getElementById('jumpToCriticalBtn');
         if (jumpToCriticalBtn) {
         jumpToCriticalBtn.addEventListener('click', () => {
            this.navigation.navigateToSection('operations');
         });
         }

         // Hero critical checklist button
         const criticalChecklistBtn = document.getElementById('criticalChecklistBtn');
         if (criticalChecklistBtn) {
         criticalChecklistBtn.addEventListener('click', () => {
            this.navigation.navigateToSection('operations');
            const checklistAnchor = document.getElementById('critical-checklist') || document.getElementById('criticalChecklist');
            if (checklistAnchor) {
                setTimeout(() => {
                    checklistAnchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    checklistAnchor.focus({ preventScroll: true });
                }, 350);
            }
         });
         }
         
         // Top bar hint close
         const topBarHintClose = document.getElementById('topBarHintClose');
         if (topBarHintClose) {
         topBarHintClose.addEventListener('click', () => {
            this.hideTopBarHint();
            this.storage.set(CONFIG.STORAGE_KEYS.HINT_DISMISSED, true);
         });
         }
         
         // Quick action buttons
         const printBtn = document.getElementById('printBtn');
         if (printBtn) {
         printBtn.addEventListener('click', () => {
            this.printItinerary();
         });
         }
         
         const offlineBtn = document.getElementById('offlineBtn');
         if (offlineBtn) {
         offlineBtn.addEventListener('click', () => {
            this.saveOffline();
         });
         }
         
         const shareBtn = document.getElementById('shareBtn');
         if (shareBtn) {
         shareBtn.addEventListener('click', () => {
            this.shareItinerary();
         });
         }
         
         // Mobile menu
         const mobileMenuBtn = document.getElementById('mobileMenuBtn');
         const mobileMoreBtn = document.getElementById('mobileMoreBtn');
         const sectionDrawerClose = document.getElementById('sectionDrawerClose');
         const sectionDrawerOverlay = document.getElementById('sectionDrawerOverlay');
         
         if (mobileMenuBtn) {
         mobileMenuBtn.addEventListener('click', () => {
            this.openSectionDrawer();
         });
         }
         
         if (mobileMoreBtn) {
         mobileMoreBtn.addEventListener('click', () => {
            this.openSectionDrawer();
         });
         }
         
         if (sectionDrawerClose) {
         sectionDrawerClose.addEventListener('click', () => {
            this.closeSectionDrawer();
         });
         }
         
         if (sectionDrawerOverlay) {
         sectionDrawerOverlay.addEventListener('click', () => {
            this.closeSectionDrawer();
         });
         }
         
         // Online/offline detection
         window.addEventListener('online', this.handleOnlineStatus);
         window.addEventListener('offline', this.handleOnlineStatus);
         
         // Keyboard shortcuts
         document.addEventListener('keydown', (e) => {
         this.handleKeyboardShortcuts(e);
         });
         }
         
         initializeSearchListeners() {
         const searchBtn = document.getElementById('searchBtn');
         const searchClose = document.getElementById('searchClose');
         const searchOverlay = document.getElementById('searchOverlay');
         const searchForm = document.getElementById('searchForm');
         const searchInput = document.getElementById('searchInput');
         const searchChips = document.querySelectorAll('.search-chip');
         
         if (searchBtn) {
         searchBtn.addEventListener('click', () => {
            this.openSearch();
         });
         }
         
         if (searchClose) {
         searchClose.addEventListener('click', () => {
            this.closeSearch();
         });
         }
         
         if (searchOverlay) {
         searchOverlay.addEventListener('click', (e) => {
            if (e.target === searchOverlay) {
                this.closeSearch();
            }
         });
         }
         
         if (searchForm) {
         searchForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const query = searchInput.value.trim();
            if (query) {
                this.performSearch(query);
            }
         });
         }
         
         // Search chips
         searchChips.forEach(chip => {
         chip.addEventListener('click', () => {
            const query = chip.dataset.query;
            if (query) {
                searchInput.value = query;
                this.performSearch(query);
            }
         });
         });
         
         // Search input events
         if (searchInput) {
         // Clear results when input is cleared
         searchInput.addEventListener('input', PerformanceUtils.debounce(() => {
            if (!searchInput.value.trim()) {
                this.clearSearchResults();
            }
         }, 300));
         
         // Handle Escape key
         searchInput.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (searchInput.value) {
                    searchInput.value = '';
                    this.clearSearchResults();
                } else {
                    this.closeSearch();
                }
            }
         });
         }
         }
         
         async initializeDeckPlans() {
         const deckPlansGrid = document.getElementById('deckPlansGrid');
         const deckPlanUpload = document.getElementById('deckPlanUpload');
         const deckPlanClearBtn = document.getElementById('deckPlanClearBtn');
         
         if (!deckPlansGrid) return;
         
         let currentPlans = this.storage.loadDeckPlans();
         this.renderDeckPlans(currentPlans, deckPlansGrid);
         
         if (deckPlanUpload) {
         deckPlanUpload.addEventListener('change', async (event) => {
            const files = Array.from(event.target.files || []);
            if (files.length === 0) return;
            
            const imageFiles = files.filter(file => file.type.startsWith('image/'));
            if (imageFiles.length === 0) {
                this.ui.showToast('Please upload image files for deck plans.', {
                    type: 'warning',
                    duration: 3000
                });
                deckPlanUpload.value = '';
                return;
            }
            
            const uploadedPlans = [];
            
            for (const file of imageFiles) {
                const dataUrl = await this.readFileAsDataUrl(file);
                uploadedPlans.push({
                    name: file.name,
                    dataUrl: dataUrl,
                    updatedAt: new Date().toISOString()
                });
            }
            
            const mergedPlans = [...currentPlans, ...uploadedPlans].slice(0, 10);
            this.storage.saveDeckPlans(mergedPlans);
            this.renderDeckPlans(mergedPlans, deckPlansGrid);
            currentPlans = mergedPlans;
            
            this.ui.showToast(`${uploadedPlans.length} deck plan(s) saved.`, {
                type: 'success',
                duration: 3000
            });
            
            deckPlanUpload.value = '';
         });
         }
         
         if (deckPlanClearBtn) {
         deckPlanClearBtn.addEventListener('click', () => {
            const confirmed = window.confirm('Clear all saved deck plans from this device?');
            if (!confirmed) return;
            
            this.storage.clearDeckPlans();
            this.renderDeckPlans([], deckPlansGrid);
            currentPlans = [];
            
            this.ui.showToast('Saved deck plans cleared.', {
                type: 'info',
                duration: 3000
            });
         });
         }
         }
         
         renderDeckPlans(plans, deckPlansGrid) {
         if (!deckPlansGrid) return;
         
         if (!plans || plans.length === 0) {
         deckPlansGrid.innerHTML = `
            <div class="deck-plan-card deck-plan-card--placeholder">
                <strong>No deck plans saved yet.</strong>
                <p class="mb-0">Upload the deck plan images above, or use the Royal Caribbean app for the official interactive map.</p>
            </div>
         `;
         return;
         }
         
         deckPlansGrid.innerHTML = '';
         
         plans.forEach((plan, index) => {
         const card = document.createElement('div');
         card.className = 'deck-plan-card';
         card.innerHTML = `
            <a href="${plan.dataUrl}" target="_blank" rel="noopener noreferrer">
                <img src="${plan.dataUrl}" alt="Deck plan ${index + 1} - ${plan.name}">
            </a>
            <strong>${plan.name}</strong>
            <span class="deck-plan-meta">Saved ${new Date(plan.updatedAt).toLocaleDateString()}</span>
         `;
         deckPlansGrid.appendChild(card);
         });
         }
         
         readFileAsDataUrl(file) {
         return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result);
            reader.onerror = () => reject(reader.error);
            reader.readAsDataURL(file);
         });
         }
         
         async initializeServiceWorker() {
         if ('serviceWorker' in navigator) {
         try {
            const registration = await navigator.serviceWorker.register('/sw.js');
            console.log('ServiceWorker registration successful with scope:', registration.scope);
         } catch (error) {
            console.warn('ServiceWorker registration failed:', error);
         }
         }
         }
         
         async finalizeInitialization() {
         // Update critical count badge
         this.updateCriticalCountBadge();
         
         // Update day selector visibility
         this.updateDaySelectorVisibility(this.navigation.currentSection);
         
         // Update top bar hint
         this.updateTopBarHint();
         
         // Check online status
         this.handleOnlineStatus();
         
         // Update offline button state
         this.updateOfflineButtonState();
         
         // Announce to screen readers
         this.ui.announceToScreenReader('Cruise Companion loaded successfully');
         }
         
         updateDaySelectorVisibility(section) {
         const daySelector = document.getElementById('daySelector');
         if (!daySelector) return;
         
         if (section === 'itinerary') {
         daySelector.classList.remove('day-selector--hidden');
         daySelector.removeAttribute('aria-hidden');
         } else {
         daySelector.classList.add('day-selector--hidden');
         daySelector.setAttribute('aria-hidden', 'true');
         }
         }
         
         updateCriticalCountBadge() {
         const criticalCount = document.querySelectorAll('.critical-item').length;
         const criticalCountBadge = document.getElementById('criticalCountBadge');
         
         if (criticalCountBadge) {
         criticalCountBadge.textContent = criticalCount.toString();
         
         if (criticalCount > 0) {
            criticalCountBadge.style.display = 'flex';
         } else {
            criticalCountBadge.style.display = 'none';
         }
         }
         }
         
         updateTopBarHint(day = null) {
         const topBarHint = document.getElementById('topBarHint');
         const topBarHintTitle = document.getElementById('topBarHintTitle');
         const topBarHintDetail = document.getElementById('topBarHintDetail');
         const topBarHintBadge = document.getElementById('topBarHintBadge');
         
         if (!topBarHint || !topBarHintTitle || !topBarHintDetail) return;
         
         const currentDay = day || this.navigation.currentDay;
         let title = 'Today: Preparation';
         let detail = 'Tap a day to see port highlights and all-aboard times.';
         let badge = 'LIVE';
         
         if (currentDay !== 'all') {
         const dayNumber = parseInt(currentDay);
         const dayNames = [
            '', // Index 0 not used
            'Day 1: Port Canaveral',
            'Day 2: Cruising',
            'Day 3: George Town',
            'Day 4: Falmouth',
            'Day 5: Cruising',
            'Day 6: Perfect Day at CocoCay',
            'Day 7: Return'
         ];
         
         if (dayNumber >= 1 && dayNumber <= 7) {
            title = dayNames[dayNumber];
            
            // Add specific details for each day
            const dayDetails = {
                1: 'Depart Port Canaveral at 2:00 PM',
                2: 'Cruising day with onboard highlights',
                3: 'George Town, Grand Cayman gangway 11:00 AM - 5:15 PM',
                4: 'Falmouth, Jamaica gangway 8:30 AM - 4:30 PM',
                5: 'Cruising day for formal night and gala',
                6: 'Perfect Day at CocoCay gangway 7:30 AM - 4:30 PM',
                7: 'Return morning, departure 7:30 AM'
            };
            
            detail = dayDetails[dayNumber] || detail;
            badge = 'DAY ' + dayNumber;
         }
         }
         
         topBarHintTitle.textContent = title;
         topBarHintDetail.textContent = detail;
         
         if (topBarHintBadge) {
         topBarHintBadge.textContent = badge;
         }
         
         // Show hint if not dismissed
         const hintDismissed = this.storage.get(CONFIG.STORAGE_KEYS.HINT_DISMISSED, false);
         if (!hintDismissed) {
         topBarHint.classList.remove('is-hidden');
         }
         }
         
         updateTopBarHintForDay(day) {
         this.updateTopBarHint(day);
         }
         
         hideTopBarHint() {
         const topBarHint = document.getElementById('topBarHint');
         if (topBarHint) {
         topBarHint.classList.add('is-hidden');
         }
         }
         
         toggleCriticalFilter(enable) {
         const criticalToggleBtn = document.getElementById('criticalToggleBtn');
         const criticalToggleStatus = document.getElementById('criticalToggleStatus');
         
         if (!criticalToggleBtn || !criticalToggleStatus) return;
         
         // Update button state
         criticalToggleBtn.setAttribute('aria-pressed', enable.toString());
         
         // Update status text
         criticalToggleStatus.textContent = enable ? 
         'Showing critical sections only' : 
         'Showing all sections';
         
         // Show/hide non-critical sections
         const nonCriticalSections = document.querySelectorAll('section:not(.section--critical)');
         nonCriticalSections.forEach(section => {
         if (enable) {
            section.style.display = 'none';
            section.setAttribute('aria-hidden', 'true');
         } else {
            section.style.display = 'block';
            section.removeAttribute('aria-hidden');
         }
         });
         
         // Save preference
         this.storage.set(CONFIG.STORAGE_KEYS.CRITICAL_FILTER, enable);
         }
         
         toggleCompactMode(enable) {
         const compactToggleBtn = document.getElementById('compactToggleBtn');
         const body = document.body;
         
         if (!compactToggleBtn) return;
         
         // Update button state
         compactToggleBtn.setAttribute('aria-pressed', enable.toString());
         
         // Toggle class on body
         body.classList.toggle('compact-mode', enable);
         
         // Save preference
         this.storage.set(CONFIG.STORAGE_KEYS.COMPACT_MODE, enable);
         }
         
         async openSearch() {
         const searchOverlay = document.getElementById('searchOverlay');
         const searchInput = document.getElementById('searchInput');
         
         if (!searchOverlay || !searchInput) return;
         
         // Open overlay
         searchOverlay.classList.add('open');
         searchOverlay.setAttribute('aria-hidden', 'false');
         
         // Focus input
         setTimeout(() => {
         searchInput.focus();
         searchInput.select();
         }, 100);
         
         // Load recent searches
         this.loadRecentSearches();
         
         // Update search results with popular searches
         this.clearSearchResults();
         
         this.ui.announceToScreenReader('Search opened. Type to search cruise information.');
         }
         
         async closeSearch() {
         const searchOverlay = document.getElementById('searchOverlay');
         const searchInput = document.getElementById('searchInput');
         
         if (!searchOverlay || !searchInput) return;
         
         // Clear input
         searchInput.value = '';
         
         // Clear results
         this.clearSearchResults();
         
         // Close overlay
         searchOverlay.classList.remove('open');
         searchOverlay.setAttribute('aria-hidden', 'true');
         
         // Return focus to search button
         const searchBtn = document.getElementById('searchBtn');
         if (searchBtn) {
         searchBtn.focus();
         }
         
         this.ui.announceToScreenReader('Search closed');
         }
         
         async performSearch(query) {
         const searchInput = document.getElementById('searchInput');
         const searchResults = document.getElementById('searchResults');
         
         if (!searchInput || !searchResults) return;
         
         // Show loading state
         this.showSearchLoading();
         
         try {
         // Perform search
         const searchResult = await this.search.search(query);
         
         // Display results
         this.displaySearchResults(searchResult);
         
         // Add to history
         this.search.addToHistory(query);
         
         // Update recent searches display
         this.loadRecentSearches();
         
         } catch (error) {
         this.errorHandler.log(error, 'CruiseCompanionApp.performSearch');
         this.showSearchError('Failed to perform search');
         }
         }
         
         showSearchLoading() {
         const searchResults = document.getElementById('searchResults');
         if (!searchResults) return;
         
         searchResults.innerHTML = `
         <div class="search-loading">
            <div class="loading-spinner"></div>
            <p>Searching cruise information...</p>
         </div>
         `;
         }
         
         showSearchError(message) {
         const searchResults = document.getElementById('searchResults');
         if (!searchResults) return;
         
         searchResults.innerHTML = `
         <div class="no-results">
            <p><i class="fas fa-exclamation-circle"></i> ${message}</p>
            <p>Please try again or check your connection.</p>
         </div>
         `;
         }
         
         displaySearchResults(searchResult) {
         const searchResults = document.getElementById('searchResults');
         if (!searchResults) return;
         
         if (searchResult.count === 0) {
         searchResults.innerHTML = `
            <div class="no-results">
                <p>No results found for "${searchResult.query}"</p>
                <p>Try different keywords or check the quick search chips above.</p>
            </div>
         `;
         return;
         }
         
         let resultsHTML = '';
         
         searchResult.results.forEach((result, index) => {
         const highlightedTitle = this.search.highlightText(result.title, searchResult.query);
         const highlightedContent = this.search.highlightText(
            result.content.substring(0, 200) + '...', 
            searchResult.query
         );
         
         resultsHTML += `
            <div class="search-result ${result.critical ? 'critical' : ''}" 
                 data-result-index="${index}"
                 data-target="${result.id}">
                <div class="search-result-header">
                    <div class="search-result-category">
                        <i class="fas fa-${this.getResultIcon(result.type)}"></i>
                        ${result.category || result.type}
                    </div>
                    ${result.critical ? '<span class="search-result-badge">Critical</span>' : ''}
                </div>
                <h3 class="search-result-title">${highlightedTitle}</h3>
                <p class="search-result-snippet">${highlightedContent}</p>
                <div class="search-result-footer">
                    <div class="search-result-priority">
                        <i class="fas fa-star"></i>
                        Priority: ${result.priority}/5
                    </div>
                    <button class="search-result-action" data-target="${result.id}">
                        <i class="fas fa-arrow-right"></i>
                        Go to ${result.type}
                    </button>
                </div>
            </div>
         `;
         });
         
         searchResults.innerHTML = resultsHTML;
         
         // Add click handlers to result items
         searchResults.querySelectorAll('.search-result').forEach(result => {
         result.addEventListener('click', (e) => {
            if (!e.target.closest('.search-result-action')) {
                const target = result.dataset.target;
                this.navigateToSearchResult(target);
                this.closeSearch();
            }
         });
         });
         
         // Add click handlers to action buttons
         searchResults.querySelectorAll('.search-result-action').forEach(button => {
         button.addEventListener('click', (e) => {
            e.stopPropagation();
            const target = button.dataset.target;
            this.navigateToSearchResult(target);
            this.closeSearch();
         });
         });
         }
         
         getResultIcon(type) {
         const iconMap = {
         'section': 'file-alt',
         'feature': 'star',
         'port': 'umbrella-beach',
         'excursion': 'hiking',
         'activity': 'gamepad',
         'safety': 'shield-alt',
         'tool': 'mobile-alt',
         'service': 'wifi'
         };
         
         return iconMap[type] || 'search';
         }
         
         navigateToSearchResult(target) {
         // Try to find the target element
         const targetElement = document.getElementById(target);
         
         if (targetElement) {
         // Navigate to the section containing this element
         const section = targetElement.closest('section[id]');
         if (section) {
            this.navigation.navigateToSection(section.id);
            
            // Scroll to the specific element
            setTimeout(() => {
                DOMUtils.scrollToElement(targetElement, 100);
                
                // Highlight the element
                targetElement.classList.add('search-result-highlight');
                setTimeout(() => {
                    targetElement.classList.remove('search-result-highlight');
                }, 2000);
            }, 300);
         }
         } else {
         // Fallback: search in sections
         const sections = document.querySelectorAll('section[id]');
         for (const section of sections) {
            if (section.textContent.includes(target)) {
                this.navigation.navigateToSection(section.id);
                break;
            }
         }
         }
         }
         
         loadRecentSearches() {
         const recentSearchesGroup = document.getElementById('recentSearchesGroup');
         const recentSearchChips = document.getElementById('recentSearchChips');
         
         if (!recentSearchesGroup || !recentSearchChips) return;
         
         const history = this.search.history;
         
         if (history.length === 0) {
         recentSearchesGroup.setAttribute('hidden', 'true');
         return;
         }
         
         recentSearchesGroup.removeAttribute('hidden');
         
         let chipsHTML = '';
         history.slice(0, 5).forEach(query => {
         chipsHTML += `
            <button type="button" class="search-chip" data-query="${query}">
                <i class="fas fa-history"></i>
                ${query}
            </button>
         `;
         });
         
         recentSearchChips.innerHTML = chipsHTML;
         
         // Add click handlers to recent search chips
         recentSearchChips.querySelectorAll('.search-chip').forEach(chip => {
         chip.addEventListener('click', () => {
            const query = chip.dataset.query;
            const searchInput = document.getElementById('searchInput');
            if (searchInput && query) {
                searchInput.value = query;
                this.performSearch(query);
            }
         });
         });
         }
         
         clearSearchResults() {
         const searchResults = document.getElementById('searchResults');
         if (!searchResults) return;
         
         searchResults.innerHTML = `
         <div class="no-results">
            <p>Type to search for cruise information‚Ä¶</p>
            <p>Try: "eMuster", "dining", "excursions", or "Wi-Fi"</p>
         </div>
         `;
         }
         
         openSectionDrawer() {
         const sectionDrawer = document.getElementById('sectionDrawer');
         const sectionDrawerOverlay = document.getElementById('sectionDrawerOverlay');
         
         if (!sectionDrawer || !sectionDrawerOverlay) return;
         
         sectionDrawer.classList.add('open');
         sectionDrawerOverlay.classList.add('open');
         sectionDrawer.setAttribute('aria-hidden', 'false');
         sectionDrawerOverlay.setAttribute('aria-hidden', 'false');
         
         // Trap focus in drawer
         setTimeout(() => {
         const firstFocusable = sectionDrawer.querySelector(
            'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
         );
         if (firstFocusable) {
            firstFocusable.focus();
         }
         }, 100);
         }
         
         closeSectionDrawer() {
         const sectionDrawer = document.getElementById('sectionDrawer');
         const sectionDrawerOverlay = document.getElementById('sectionDrawerOverlay');
         
         if (!sectionDrawer || !sectionDrawerOverlay) return;
         
         sectionDrawer.classList.remove('open');
         sectionDrawerOverlay.classList.remove('open');
         sectionDrawer.setAttribute('aria-hidden', 'true');
         sectionDrawerOverlay.setAttribute('aria-hidden', 'true');
         
         // Return focus to menu button
         const mobileMenuBtn = document.getElementById('mobileMenuBtn');
         const mobileMoreBtn = document.getElementById('mobileMoreBtn');
         const lastFocused = mobileMenuBtn || mobileMoreBtn;
         if (lastFocused) {
         lastFocused.focus();
         }
         }
         
         printItinerary() {
         this.ui.showToast('Preparing itinerary for printing...', {
         type: 'info',
         duration: 2000
         });
         
         setTimeout(() => {
         window.print();
         }, 500);
         }
         
         updateOfflineButtonState() {
         if (this.offlineSaveInProgress) return;
         
         const isOfflineReady = this.storage.get(CONFIG.STORAGE_KEYS.OFFLINE_READY, false);
         if (isOfflineReady) {
         this.setOfflineButtonState('saved');
         } else {
         this.setOfflineButtonState('default');
         }
         }
         
         setOfflineButtonState(state, { progress = 0, total = 0 } = {}) {
         const offlineBtn = document.getElementById('offlineBtn');
         if (!offlineBtn) return;
         
         if (!offlineBtn.dataset.defaultLabel) {
         offlineBtn.dataset.defaultLabel = offlineBtn.innerHTML;
         }
         
         switch (state) {
            case 'saving': {
                const progressLabel = total > 0 ? ` (${progress}/${total})` : '';
                offlineBtn.innerHTML = `<i class="fas fa-spinner fa-spin" aria-hidden="true"></i> Saving${progressLabel}`;
                offlineBtn.setAttribute('aria-busy', 'true');
                offlineBtn.setAttribute('aria-pressed', 'false');
                offlineBtn.disabled = true;
                break;
            }
            case 'saved':
                offlineBtn.innerHTML = '<i class="fas fa-check" aria-hidden="true"></i> Offline Ready';
                offlineBtn.removeAttribute('aria-busy');
                offlineBtn.setAttribute('aria-pressed', 'true');
                offlineBtn.disabled = false;
                break;
            case 'default':
            default:
                offlineBtn.innerHTML = offlineBtn.dataset.defaultLabel;
                offlineBtn.removeAttribute('aria-busy');
                offlineBtn.setAttribute('aria-pressed', 'false');
                offlineBtn.disabled = false;
                break;
         }
         }
         
         getOfflineAssetUrls() {
         const urls = new Set();
         const baseUrl = new URL('/', window.location.href);
         const currentUrl = new URL(window.location.href);
         currentUrl.hash = '';
         currentUrl.search = '';
         
         urls.add(currentUrl.href);
         urls.add(new URL('index.html', baseUrl).href);
         urls.add(new URL('sw.js', baseUrl).href);
         
         document.querySelectorAll('link[rel="stylesheet"], link[rel="icon"], script[src], img[src], source[src]').forEach((el) => {
         const attr = el.getAttribute('href') || el.getAttribute('src');
         if (!attr || attr.startsWith('data:')) return;
         urls.add(new URL(attr, window.location.href).href);
         });
         
         return Array.from(urls);
         }

         async fetchWithTimeout(url, options = {}, timeoutMs = 10000) {
         const controller = new AbortController();
         const timeoutId = window.setTimeout(() => controller.abort(), timeoutMs);

         try {
            return await fetch(url, { ...options, signal: controller.signal });
         } finally {
            window.clearTimeout(timeoutId);
         }
         }
         
         async cacheOfflineAssets(urls, onProgress) {
         const cache = await caches.open(CONFIG.OFFLINE_CACHE_NAME);
         let completed = 0;
         let cachedCount = 0;
         const failed = [];
         
         for (const url of urls) {
         try {
            const resolvedUrl = new URL(url, window.location.href);
            const isSameOrigin = resolvedUrl.origin === window.location.origin;
            const response = await this.fetchWithTimeout(resolvedUrl.href, {
                mode: isSameOrigin ? 'cors' : 'no-cors',
                cache: 'reload'
            });
            
            if (response.ok || response.type === 'opaque') {
                await cache.put(resolvedUrl.href, response.clone());
                cachedCount += 1;
            } else {
                failed.push(resolvedUrl.href);
            }
         } catch (error) {
            failed.push(url);
         }
         
         completed += 1;
         onProgress?.(completed, urls.length);
         }
         
         return { cachedCount, failed };
         }
         
         async saveOffline() {
         if (this.offlineSaveInProgress) return;
         
         if (!('serviceWorker' in navigator) || !('caches' in window)) {
         this.ui.showToast('Offline saving is not supported in this browser.', {
            type: 'error',
            duration: 4000
         });
         return;
         }
         
         const wasOfflineReady = this.storage.get(CONFIG.STORAGE_KEYS.OFFLINE_READY, false);
         if (!navigator.onLine && !wasOfflineReady) {
         this.ui.showToast('Connect to the internet to save for offline use.', {
            type: 'warning',
            duration: 4000
         });
         return;
         }
         
         const toastId = this.ui.showToast('Saving for offline access...', {
         type: 'info',
         duration: 0
         });
         
         this.offlineSaveInProgress = true;
         const assets = this.getOfflineAssetUrls();
         this.setOfflineButtonState('saving', { progress: 0, total: assets.length });
         
         try {
         await this.initializeServiceWorker();
         await navigator.serviceWorker.ready;
         
         const { cachedCount, failed } = await this.cacheOfflineAssets(
            assets,
            (completed, total) => {
                this.setOfflineButtonState('saving', { progress: completed, total });
            }
         );
         
         const isOfflineReady = cachedCount > 0;
         this.storage.set(CONFIG.STORAGE_KEYS.OFFLINE_READY, isOfflineReady);
         
         this.ui.hideToast(toastId);
         
         if (failed.length > 0) {
            this.ui.showToast(
                `Saved ${cachedCount} items for offline use. ${failed.length} file(s) could not be cached.`,
                {
                    type: 'warning',
                    duration: 5000
                }
            );
         } else {
            this.ui.showToast('Cruise guide saved for offline access!', {
                type: 'success',
                duration: 3000
            });
         }
         
         if (isOfflineReady) {
            this.setOfflineButtonState('saved');
         } else {
            this.setOfflineButtonState('default');
         }
         } catch (error) {
         console.error('Offline save failed:', error);
         this.storage.set(CONFIG.STORAGE_KEYS.OFFLINE_READY, false);
         this.ui.hideToast(toastId);
         this.ui.showToast('Unable to save offline. Please try again.', {
            type: 'error',
            duration: 4000
         });
         this.setOfflineButtonState('default');
         } finally {
         this.offlineSaveInProgress = false;
         }
         }
         
         async shareItinerary() {
         if (navigator.share) {
         try {
            await navigator.share({
                title: 'My Caribbean Cruise Itinerary',
                text: 'Check out my cruise itinerary for Adventure of the Seas!',
                url: window.location.href
            });
            
            this.ui.showToast('Itinerary shared successfully!', {
                type: 'success',
                duration: 3000
            });
         } catch (error) {
            if (error.name !== 'AbortError') {
                console.error('Error sharing:', error);
                this.ui.showToast('Could not share itinerary', {
                    type: 'error',
                    duration: 3000
                });
            }
         }
         } else {
         // Fallback: copy to clipboard
         try {
            await navigator.clipboard.writeText(window.location.href);
            this.ui.showToast('Link copied to clipboard!', {
                type: 'success',
                duration: 3000
            });
         } catch (error) {
            console.error('Error copying to clipboard:', error);
            this.ui.showToast('Could not copy link', {
                type: 'error',
                duration: 3000
            });
         }
         }
         }
         
         handleError(error) {
         const errorObj = this.errorHandler.log(error, 'GlobalErrorHandler');
         
         // Show user-friendly error
         this.ui.showToast('An error occurred. The app may not function correctly.', {
         type: 'error',
         duration: 5000
         });
         
         // Log to console in development
         if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
         console.error('Application error:', errorObj);
         }
         
         return false;
         }
         
         handleOnlineStatus() {
         const isOnline = navigator.onLine;
         
         if (isOnline) {
         this.ui.showToast('Back online! Syncing updates...', {
            type: 'success',
            duration: 3000
         });
         
         // Refresh data that may have changed
         setTimeout(() => {
            this.weather.fetchWeather();
         }, 1000);
         } else {
         this.ui.showToast('You are offline. Some features may be limited.', {
            type: 'warning',
            duration: 5000
         });
         }
         }
         
         handleKeyboardShortcuts(e) {
         // Don't trigger shortcuts when typing in inputs
         if (e.target.tagName === 'INPUT' || 
         e.target.tagName === 'TEXTAREA' || 
         e.target.isContentEditable) {
         return;
         }
         
         // Check for modifier keys
         const hasModifier = e.ctrlKey || e.metaKey || e.altKey || e.shiftKey;
         
         // Global shortcuts (with modifier)
         if (e.key === 'k' && (e.ctrlKey || e.metaKey)) {
         e.preventDefault();
         this.openSearch();
         return;
         }
         
         if (e.key === 'p' && (e.ctrlKey || e.metaKey)) {
         e.preventDefault();
         this.printItinerary();
         return;
         }
         
         // Navigation shortcuts (without modifier)
         if (!hasModifier) {
         switch (e.key) {
            case '1':
                e.preventDefault();
                this.navigation.navigateToSection('overview');
                break;
            case '2':
                e.preventDefault();
                this.navigation.navigateToSection('operations');
                break;
            case '3':
                e.preventDefault();
                this.navigation.navigateToSection('itinerary');
                break;
            case '4':
                e.preventDefault();
                this.navigation.navigateToSection('rooms');
                break;
            case '5':
                e.preventDefault();
                this.navigation.navigateToSection('dining');
                break;
            case '6':
                e.preventDefault();
                this.navigation.navigateToSection('communication');
                break;
            case '7':
                e.preventDefault();
                this.navigation.navigateToSection('tips');
                break;
            case '8':
                e.preventDefault();
                this.navigation.navigateToSection('integrate');
                break;
            case '?':
                e.preventDefault();
                this.showKeyboardShortcutsHelp();
                break;
            case 'Escape':
                // Close any open modals or drawers
                this.closeSearch();
                this.closeSectionDrawer();
                break;
         }
         }
         
         // Day navigation (when on itinerary)
         if (this.navigation.currentSection === 'itinerary' && !hasModifier) {
         switch (e.key) {
            case 'ArrowLeft':
                e.preventDefault();
                const currentDayIndex = this.navigation.availableDays.indexOf(this.navigation.currentDay);
                const prevDay = currentDayIndex > 0 ? 
                    this.navigation.availableDays[currentDayIndex - 1] : 
                    this.navigation.availableDays[this.navigation.availableDays.length - 1];
                this.navigation.setCurrentDay(prevDay);
                break;
                
            case 'ArrowRight':
                e.preventDefault();
                const currentDayIndex2 = this.navigation.availableDays.indexOf(this.navigation.currentDay);
                const nextDay = currentDayIndex2 < this.navigation.availableDays.length - 1 ? 
                    this.navigation.availableDays[currentDayIndex2 + 1] : 
                    this.navigation.availableDays[0];
                this.navigation.setCurrentDay(nextDay);
                break;
         }
         }
         }
         
         showKeyboardShortcutsHelp() {
         const shortcuts = [
         { key: 'Ctrl/Cmd + K', action: 'Open search' },
         { key: 'Ctrl/Cmd + P', action: 'Print itinerary' },
         { key: '1-8', action: 'Jump to sections 1-8' },
         { key: '?', action: 'Show this help' },
         { key: 'Escape', action: 'Close modals/search' },
         { key: '‚Üê ‚Üí', action: 'Navigate days (on itinerary)' }
         ];
         
         let helpHTML = '<div class="keyboard-shortcuts">';
         helpHTML += '<h4>Keyboard Shortcuts</h4>';
         
         shortcuts.forEach(shortcut => {
         helpHTML += `
            <div class="shortcut-item">
                <span>${shortcut.action}</span>
                <kbd>${shortcut.key}</kbd>
            </div>
         `;
         });
         
         helpHTML += '</div>';
         
         this.ui.showToast(helpHTML, {
         type: 'info',
         duration: 8000,
         position: 'bottom-right'
         });
         }
         
         showErrorScreen(message) {
         const errorScreen = document.createElement('div');
         errorScreen.className = 'error-screen';
         errorScreen.innerHTML = `
         <div class="error-content">
            <h1>‚ö†Ô∏è Oops!</h1>
            <p>${message}</p>
            <p>Please try refreshing the page or contact support if the problem persists.</p>
            <button id="refreshBtn" class="rc-btn">
                <i class="fas fa-redo"></i> Refresh Page
            </button>
         </div>
         `;
         
         document.body.appendChild(errorScreen);
         
         // Add refresh button handler
         const refreshBtn = document.getElementById('refreshBtn');
         if (refreshBtn) {
         refreshBtn.addEventListener('click', () => {
            window.location.reload();
         });
         }
         }
         
         destroy() {
         // Stop all managers
         this.countdown?.stop();
         this.countdown?.destroy();
         this.weather?.destroy();
         
         // Clean up UI components
         this.ui?.destroyAllComponents();
         
         // Remove event listeners
         window.removeEventListener('error', this.handleError);
         window.removeEventListener('unhandledrejection', this.handleError);
         window.removeEventListener('online', this.handleOnlineStatus);
         window.removeEventListener('offline', this.handleOnlineStatus);
         
         // Clear all intervals and timeouts
         // Note: This is a brute-force approach. In production, you'd track all timeouts.
         const highestTimeoutId = setTimeout(() => {}, 0);
         for (let i = 0; i < highestTimeoutId; i++) {
         clearTimeout(i);
         }
         
         this.isInitialized = false;
         console.log(`${CONFIG.APP_NAME} destroyed`);
         }
         }
         
         class MobileUXEnhancements {
         static init() {
         let lastTouchEnd = 0;
         document.addEventListener('touchend', (event) => {
         const now = Date.now();
         if (now - lastTouchEnd <= 300) {
         event.preventDefault();
         }
         lastTouchEnd = now;
         }, false);
         
         document.addEventListener('touchmove', (event) => {
         if (event.scale !== 1) {
         event.preventDefault();
         }
         }, { passive: false });
         
         this.addHapticFeedback();
         }
         
         static addHapticFeedback() {
         if ('vibrate' in navigator) {
         const elements = document.querySelectorAll('.btn--primary, .nav-item, .fab');
         elements.forEach(element => {
         element.addEventListener('touchstart', () => {
         navigator.vibrate(10);
         });
         });
         }
         }
         }
         
         // ============================================================================
         // APPLICATION INITIALIZATION
         // ============================================================================
         
         // Create and initialize the application
         document.addEventListener('DOMContentLoaded', async () => {
         try {
         // Create app instance
         const app = new CruiseCompanionApp();
         
         // Make app globally available for debugging
         window.cruiseApp = app;
         
         // Initialize app
         await app.initialize();
         
         MobileUXEnhancements.init();
         
         // Add beforeunload handler for cleanup
         window.addEventListener('beforeunload', () => {
         app.destroy();
         });
         
         } catch (error) {
         console.error('Failed to initialize Cruise Companion:', error);
         
         // Show error screen
         const errorScreen = document.createElement('div');
         errorScreen.className = 'error-screen';
         errorScreen.innerHTML = `
         <div class="error-content">
            <h1>üö® Critical Error</h1>
            <p>Failed to initialize the Cruise Companion application.</p>
            <p>Error: ${error.message}</p>
            <button onclick="window.location.reload()" class="rc-btn">
                <i class="fas fa-redo"></i> Reload Application
            </button>
         </div>
         `;
         
         document.body.appendChild(errorScreen);
         }
         });
         
         // Service Worker registration (simplified)
         if ('serviceWorker' in navigator) {
         window.addEventListener('load', () => {
         navigator.serviceWorker.register('/sw.js').catch(error => {
         console.log('ServiceWorker registration failed:', error);
         });
         });
         }
         
         // Add polyfills for older browsers
         if (!window.Promise) {
         console.warn('Promises not supported - loading polyfill');
         const script = document.createElement('script');
         script.src = 'https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js';
         document.head.appendChild(script);
         }
         
         // Console welcome message
         console.log(`
         ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
         ‚ïë                CRUISE COMPANION v2.0.0                   ‚ïë
         ‚ïë          Adventure of the Seas ‚Ä¢ Feb 14-20, 2026         ‚ïë
         ‚ïë                                                          ‚ïë
         ‚ïë   Type 'cruiseApp' in console for debugging controls.    ‚ïë
         ‚ïë   Press '?' to view keyboard shortcuts.                  ‚ïë
         ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
         `);
            
      </script>
   </body>
</html>
