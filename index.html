<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta name="theme-color" content="#0f172a">
  <title>ðŸš¢ Cruise Companion</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    :root {
      --primary: #3b82f6;
      --primary-dark: #2563eb;
      --secondary: #8b5cf6;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --bg: #0f172a;
      --bg-alt: #1e293b;
      --bg-card: #1e293b;
      --text: #f1f5f9;
      --text-muted: #94a3b8;
      --border: #334155;
      --shadow: rgba(0, 0, 0, 0.3);
      --radius: 12px;
      --radius-sm: 8px;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      overflow-x: hidden;
    }

    /* Mobile-First Header */
    .header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: var(--bg-alt);
      border-bottom: 1px solid var(--border);
      backdrop-filter: blur(20px);
      background: rgba(30, 41, 59, 0.95);
    }

    .header-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 16px;
      gap: 12px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 20px;
      font-weight: 700;
    }

    .logo-icon {
      font-size: 24px;
    }

    .header-actions {
      display: flex;
      gap: 8px;
    }

    .icon-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: none;
      background: var(--bg);
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }

    .icon-btn:active {
      transform: scale(0.95);
    }

    .icon-btn:hover {
      background: var(--primary);
    }

    .badge {
      position: absolute;
      top: -4px;
      right: -4px;
      background: var(--danger);
      color: white;
      font-size: 10px;
      font-weight: 700;
      padding: 2px 6px;
      border-radius: 10px;
      min-width: 18px;
      text-align: center;
    }

    /* Tabs Navigation */
    .tabs {
      display: flex;
      overflow-x: auto;
      padding: 0 16px;
      gap: 8px;
      scrollbar-width: none;
      -webkit-overflow-scrolling: touch;
    }

    .tabs::-webkit-scrollbar {
      display: none;
    }

    .tab {
      flex-shrink: 0;
      padding: 12px 20px;
      border: none;
      background: transparent;
      color: var(--text-muted);
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: all 0.2s;
      white-space: nowrap;
    }

    .tab.active {
      color: var(--primary);
      border-bottom-color: var(--primary);
    }

    .tab:active {
      transform: scale(0.97);
    }

    /* Main Content */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px;
    }

    /* Info Cards */
    .info-cards {
      display: grid;
      gap: 12px;
      margin-bottom: 24px;
    }

    .info-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px;
    }

    .info-card-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }

    .info-icon {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
    }

    .info-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .info-value {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .info-subtitle {
      font-size: 13px;
      color: var(--text-muted);
    }

    /* Stats Grid */
    .stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-bottom: 24px;
    }

    .stat-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px;
      text-align: center;
    }

    .stat-value {
      font-size: 32px;
      font-weight: 800;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 4px;
    }

    .stat-label {
      font-size: 13px;
      color: var(--text-muted);
    }

    /* Timeline */
    .timeline {
      margin-bottom: 24px;
    }

    .timeline-item {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px;
      margin-bottom: 12px;
      position: relative;
    }

    .timeline-item.active {
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
    }

    .timeline-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }

    .timeline-day {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 700;
      font-size: 16px;
    }

    .day-badge {
      background: var(--primary);
      color: white;
      width: 32px;
      height: 32px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: 700;
    }

    .timeline-status {
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      background: rgba(59, 130, 246, 0.1);
      color: var(--primary);
    }

    .timeline-port {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .timeline-time {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: 12px;
    }

    /* Tasks */
    .tasks {
      margin-bottom: 24px;
    }

    .task-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px;
      margin-bottom: 12px;
      display: flex;
      gap: 12px;
      align-items: flex-start;
    }

    .task-checkbox {
      width: 24px;
      height: 24px;
      border-radius: 6px;
      border: 2px solid var(--border);
      flex-shrink: 0;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .task-card.done .task-checkbox {
      background: var(--success);
      border-color: var(--success);
    }

    .task-checkbox i {
      color: white;
      font-size: 12px;
      opacity: 0;
    }

    .task-card.done .task-checkbox i {
      opacity: 1;
    }

    .task-content {
      flex: 1;
    }

    .task-title {
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .task-card.done .task-title {
      text-decoration: line-through;
      opacity: 0.5;
    }

    .task-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .task-tag {
      padding: 2px 8px;
      border-radius: 4px;
      font-weight: 600;
    }

    .task-tag.critical {
      background: rgba(239, 68, 68, 0.1);
      color: var(--danger);
    }

    .task-tag.warning {
      background: rgba(245, 158, 11, 0.1);
      color: var(--warning);
    }

    .task-tag.info {
      background: rgba(59, 130, 246, 0.1);
      color: var(--primary);
    }

    /* Quick Actions */
    .quick-actions {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-bottom: 24px;
    }

    .action-btn {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: all 0.2s;
      text-align: center;
    }

    .action-btn:active {
      transform: scale(0.97);
    }

    .action-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .action-label {
      font-size: 14px;
      font-weight: 600;
    }

    /* Bottom Navigation */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg-alt);
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: space-around;
      padding: 8px 0 calc(8px + env(safe-area-inset-bottom));
      z-index: 100;
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      padding: 8px 16px;
      border: none;
      background: transparent;
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }

    .nav-item.active {
      color: var(--primary);
    }

    .nav-item i {
      font-size: 20px;
    }

    .nav-label {
      font-size: 11px;
      font-weight: 600;
    }

    /* FAB */
    .fab {
      position: fixed;
      bottom: 80px;
      right: 16px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
      border: none;
      box-shadow: 0 4px 12px var(--shadow);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      cursor: pointer;
      z-index: 90;
      transition: all 0.3s;
    }

    .fab:active {
      transform: scale(0.95);
    }

    /* Drawer */
    .drawer-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 200;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
    }

    .drawer-overlay.active {
      opacity: 1;
      pointer-events: all;
    }

    .drawer {
      position: fixed;
      top: 0;
      right: 0;
      width: 85%;
      max-width: 400px;
      height: 100%;
      background: var(--bg-alt);
      z-index: 201;
      transform: translateX(100%);
      transition: transform 0.3s;
      overflow-y: auto;
      padding-bottom: env(safe-area-inset-bottom);
    }

    .drawer.active {
      transform: translateX(0);
    }

    .drawer-header {
      padding: 20px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .drawer-title {
      font-size: 20px;
      font-weight: 700;
    }

    .drawer-content {
      padding: 20px;
    }

    .filter-group {
      margin-bottom: 24px;
    }

    .filter-label {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-muted);
      margin-bottom: 12px;
      display: block;
    }

    .filter-option {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 0;
      cursor: pointer;
    }

    .checkbox {
      width: 20px;
      height: 20px;
      border-radius: 4px;
      border: 2px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .filter-option input:checked + .checkbox {
      background: var(--primary);
      border-color: var(--primary);
    }

    .filter-option input {
      display: none;
    }

    .checkbox i {
      color: white;
      font-size: 12px;
      opacity: 0;
    }

    .filter-option input:checked + .checkbox i {
      opacity: 1;
    }

    /* Toast */
    .toast {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px 24px;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: 0 4px 12px var(--shadow);
      z-index: 300;
      transition: transform 0.3s;
      max-width: calc(100% - 32px);
    }

    .toast.show {
      transform: translateX(-50%) translateY(0);
    }

    /* Responsive */
    @media (min-width: 640px) {
      .stats {
        grid-template-columns: repeat(4, 1fr);
      }

      .quick-actions {
        grid-template-columns: repeat(4, 1fr);
      }

      .info-cards {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (min-width: 768px) {
      .container {
        padding: 24px;
      }

      .bottom-nav {
        display: none;
      }

      .fab {
        bottom: 24px;
      }
    }

    /* Loading */
    .loading {
      position: fixed;
      inset: 0;
      background: var(--bg);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      gap: 20px;
      z-index: 1000;
      transition: opacity 0.3s;
    }

    .loading.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .spinner {
      width: 48px;
      height: 48px;
      border: 4px solid var(--border);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .section-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .empty-state {
      text-align: center;
      padding: 48px 16px;
      color: var(--text-muted);
    }

    .empty-icon {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.5;
    }
  </style>
</head>
<body>
  <!-- Loading Screen -->
  <div class="loading" id="loading">
    <div class="spinner"></div>
    <div>Loading your cruise...</div>
  </div>

  <!-- Header -->

  <header class="header">
    <div class="header-top">
      <div class="logo">
        <span class="logo-icon">ðŸš¢</span>
        <span>Cruise Companion</span>
      </div>
      <div class="header-actions">
        <button class="icon-btn" id="search-btn" aria-label="Search">
          <i class="fas fa-search"></i>
        </button>
        <button class="icon-btn" id="filter-btn" aria-label="Filters">
          <i class="fas fa-filter"></i>
          <span class="badge" id="filter-badge">3</span>
        </button>
        <button class="icon-btn" id="menu-btn" aria-label="Menu">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </div>
    <div class="tabs">
      <button class="tab active" data-tab="overview">Overview</button>
      <button class="tab" data-tab="timeline">Timeline</button>
      <button class="tab" data-tab="tasks">Tasks</button>
      <button class="tab" data-tab="actions">Actions</button>
    </div>
  </header>

  <!-- Main Content -->

  <div class="container">
    <!-- Overview Tab -->
    <div class="tab-content" id="overview-content">
      <!-- Info Cards -->
      <div class="info-cards">
        <div class="info-card">
          <div class="info-card-header">
            <div class="info-icon">ðŸš¢</div>
            <div class="info-title">Your Ship</div>
          </div>
          <div class="info-value">Adventure of the Seas</div>
          <div class="info-subtitle">Royal Caribbean â€¢ Stateroom 6650</div>
        </div>

        <div class="info-card">
          <div class="info-card-header">
            <div class="info-icon">ðŸ“…</div>
            <div class="info-title">Sailing Dates</div>
          </div>
          <div class="info-value">Feb 14-20, 2026</div>
          <div class="info-subtitle">7-day Caribbean cruise</div>
        </div>
      </div>

      <!-- Stats -->
      <div class="stats">
        <div class="stat-card">
          <div class="stat-value" id="days-until">14</div>
          <div class="stat-label">Days Until Cruise</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="tasks-total">24</div>
          <div class="stat-label">Total Tasks</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="tasks-done">8</div>
          <div class="stat-label">Completed</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="progress-pct">33%</div>
          <div class="stat-label">Progress</div>
        </div>
      </div>

      <h2 class="section-title">
        <i class="fas fa-exclamation-circle"></i>
        Critical Tasks
      </h2>
      <div class="tasks" id="critical-tasks"></div>

      <h2 class="section-title">
        <i class="fas fa-bolt"></i>
        Quick Actions
      </h2>
      <div class="quick-actions">
        <button class="action-btn">
          <div class="action-icon"><i class="fas fa-life-ring"></i></div>
          <div class="action-label">Muster</div>
        </button>
        <button class="action-btn">
          <div class="action-icon"><i class="fas fa-utensils"></i></div>
          <div class="action-label">Dining</div>
        </button>
        <button class="action-btn">
          <div class="action-icon"><i class="fas fa-suitcase"></i></div>
          <div class="action-label">Packing</div>
        </button>
        <button class="action-btn">
          <div class="action-icon"><i class="fas fa-map"></i></div>
          <div class="action-label">Ports</div>
        </button>
      </div>
    </div>

    <!-- Timeline Tab -->
    <div class="tab-content" id="timeline-content" style="display: none;">
      <div class="timeline" id="timeline"></div>
    </div>

    <!-- Tasks Tab -->
    <div class="tab-content" id="tasks-content" style="display: none;">
      <div class="tasks" id="all-tasks"></div>
    </div>

    <!-- Actions Tab -->
    <div class="tab-content" id="actions-content" style="display: none;">
      <div class="quick-actions">
        <button class="action-btn">
          <div class="action-icon"><i class="fas fa-file-pdf"></i></div>
          <div class="action-label">Export PDF</div>
        </button>
        <button class="action-btn">
          <div class="action-icon"><i class="fas fa-share-alt"></i></div>
          <div class="action-label">Share</div>
        </button>
        <button class="action-btn">
          <div class="action-icon"><i class="fas fa-download"></i></div>
          <div class="action-label">Download</div>
        </button>
        <button class="action-btn">
          <div class="action-icon"><i class="fas fa-sync"></i></div>
          <div class="action-label">Sync</div>
        </button>
      </div>
    </div>
  </div>

  <!-- Bottom Navigation -->

  <nav class="bottom-nav">
    <button class="nav-item active" data-nav="overview">
      <i class="fas fa-home"></i>
      <span class="nav-label">Overview</span>
    </button>
    <button class="nav-item" data-nav="timeline">
      <i class="fas fa-calendar"></i>
      <span class="nav-label">Timeline</span>
    </button>
    <button class="nav-item" data-nav="tasks">
      <i class="fas fa-check-circle"></i>
      <span class="nav-label">Tasks</span>
    </button>
    <button class="nav-item" data-nav="actions">
      <i class="fas fa-ellipsis-h"></i>
      <span class="nav-label">More</span>
    </button>
  </nav>

  <!-- FAB -->

  <button class="fab" id="fab" aria-label="Add">
    <i class="fas fa-plus"></i>
  </button>

  <!-- Filter Drawer -->

  <div class="drawer-overlay" id="drawer-overlay"></div>
  <div class="drawer" id="filter-drawer">
    <div class="drawer-header">
      <h2 class="drawer-title">Filters</h2>
      <button class="icon-btn" id="close-drawer" aria-label="Close filters">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="drawer-content">
      <div class="filter-group">
        <label class="filter-label">Priority</label>
        <label class="filter-option">
          <input type="checkbox" checked>
          <div class="checkbox"><i class="fas fa-check"></i></div>
          <span>ðŸ”´ Critical</span>
        </label>
        <label class="filter-option">
          <input type="checkbox" checked>
          <div class="checkbox"><i class="fas fa-check"></i></div>
          <span>ðŸŸ¡ Recommended</span>
        </label>
        <label class="filter-option">
          <input type="checkbox" checked>
          <div class="checkbox"><i class="fas fa-check"></i></div>
          <span>ðŸŸ¢ Info</span>
        </label>
      </div>
    </div>
  </div>

  <!-- Toast -->

  <div class="toast" id="toast" role="status" aria-live="polite">
    <i class="fas fa-check-circle"></i>
    <span id="toast-message">Task completed!</span>
  </div>

  <script>
    // Sample data
    const cruiseData = {
      sailDate: '2026-02-14',
      days: [
        { day: 1, port: 'Fort Lauderdale', arrive: 'â€”', depart: '16:00', status: 'Embarkation' },
        { day: 2, port: 'At Sea', arrive: 'â€”', depart: 'â€”', status: 'Sailing' },
        { day: 3, port: 'Cozumel, Mexico', arrive: '08:00', depart: '18:00', status: 'Port' },
        { day: 4, port: 'Grand Cayman', arrive: '07:00', depart: '16:00', status: 'Port' },
        { day: 5, port: 'Jamaica', arrive: '10:00', depart: '19:00', status: 'Port' },
        { day: 6, port: 'At Sea', arrive: 'â€”', depart: 'â€”', status: 'Sailing' },
        { day: 7, port: 'Fort Lauderdale', arrive: '06:00', depart: 'â€”', status: 'Disembarkation' }
      ],
      tasks: [
        { id: 1, title: 'Complete online check-in', priority: 'critical', done: false, day: 'Pre-cruise' },
        { id: 2, title: 'Book muster station time', priority: 'critical', done: false, day: 'Day 1' },
        { id: 3, title: 'Reserve specialty dining', priority: 'warning', done: false, day: 'Pre-cruise' },
        { id: 4, title: 'Pack carry-on essentials', priority: 'critical', done: true, day: 'Pre-cruise' },
        { id: 5, title: 'Print boarding documents', priority: 'warning', done: false, day: 'Pre-cruise' },
        { id: 6, title: 'Book Cozumel excursion', priority: 'info', done: false, day: 'Day 3' }
      ]
    };

    const toast = document.getElementById('toast');
    const toastMessage = document.getElementById('toast-message');

    function showToast(message) {
      toastMessage.textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 2000);
    }

    // Calculate days until cruise
    function updateCountdown() {
      const today = new Date();
      const sail = new Date(cruiseData.sailDate);
      const diff = Math.ceil((sail - today) / (1000 * 60 * 60 * 24));
      document.getElementById('days-until').textContent = diff > 0 ? diff : '0';
    }

    function updateStats() {
      const total = cruiseData.tasks.length;
      const done = cruiseData.tasks.filter(task => task.done).length;
      const progress = total ? Math.round((done / total) * 100) : 0;

      document.getElementById('tasks-total').textContent = total;
      document.getElementById('tasks-done').textContent = done;
      document.getElementById('progress-pct').textContent = `${progress}%`;
    }

    function taskTag(priority) {
      if (priority === 'critical') return 'Critical';
      if (priority === 'warning') return 'Recommended';
      return 'Info';
    }

    // Render tasks
    function renderTasks() {
      const criticalContainer = document.getElementById('critical-tasks');
      const allContainer = document.getElementById('all-tasks');

      const critical = cruiseData.tasks.filter(task => task.priority === 'critical' && !task.done);
      const all = cruiseData.tasks;

      criticalContainer.innerHTML = critical.length
        ? critical.map(task => `
          <div class="task-card ${task.done ? 'done' : ''}" data-id="${task.id}">
            <div class="task-checkbox"><i class="fas fa-check"></i></div>
            <div class="task-content">
              <div class="task-title">${task.title}</div>
              <div class="task-meta">
                <span class="task-tag ${task.priority}">${taskTag(task.priority)}</span>
                <span>${task.day}</span>
              </div>
            </div>
          </div>
        `).join('')
        : `
          <div class="empty-state">
            <div class="empty-icon">ðŸŽ‰</div>
            <div>All critical tasks are complete.</div>
          </div>
        `;

      allContainer.innerHTML = all.length
        ? all.map(task => `
          <div class="task-card ${task.done ? 'done' : ''}" data-id="${task.id}">
            <div class="task-checkbox"><i class="fas fa-check"></i></div>
            <div class="task-content">
              <div class="task-title">${task.title}</div>
              <div class="task-meta">
                <span class="task-tag ${task.priority}">${taskTag(task.priority)}</span>
                <span>${task.day}</span>
              </div>
            </div>
          </div>
        `).join('')
        : `
          <div class="empty-state">
            <div class="empty-icon">ðŸ§³</div>
            <div>No tasks yet.</div>
          </div>
        `;
    }

    function renderTimeline() {
      const timeline = document.getElementById('timeline');
      const activeDay = cruiseData.days[0]?.day ?? 1;

      timeline.innerHTML = cruiseData.days.map(day => `
        <div class="timeline-item ${day.day === activeDay ? 'active' : ''}">
          <div class="timeline-header">
            <div class="timeline-day">
              <span class="day-badge">${day.day}</span>
              Day ${day.day}
            </div>
            <span class="timeline-status">${day.status}</span>
          </div>
          <div class="timeline-port">${day.port}</div>
          <div class="timeline-time">
            <i class="fas fa-clock"></i>
            ${day.arrive} - ${day.depart}
          </div>
        </div>
      `).join('');
    }

    function updateFilterBadge() {
      const checked = Array.from(document.querySelectorAll('.filter-option input'))
        .filter(input => input.checked).length;
      document.getElementById('filter-badge').textContent = checked;
    }

    function handleTaskToggle(event) {
      const card = event.target.closest('.task-card');
      if (!card) return;

      const id = Number(card.dataset.id);
      const task = cruiseData.tasks.find(item => item.id === id);
      if (!task) return;

      task.done = !task.done;
      renderTasks();
      updateStats();
      showToast(task.done ? 'Task completed!' : 'Task marked as incomplete.');
    }

    function switchTab(tabName) {
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.toggle('active', tab.dataset.tab === tabName);
      });

      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.toggle('active', item.dataset.nav === tabName);
      });

      document.querySelectorAll('.tab-content').forEach(section => {
        section.style.display = section.id === `${tabName}-content` ? 'block' : 'none';
      });
    }

    function initTabs() {
      document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => switchTab(tab.dataset.tab));
      });

      document.querySelectorAll('.nav-item').forEach(nav => {
        nav.addEventListener('click', () => switchTab(nav.dataset.nav));
      });
    }

    function initDrawer() {
      const overlay = document.getElementById('drawer-overlay');
      const drawer = document.getElementById('filter-drawer');

      function openDrawer() {
        overlay.classList.add('active');
        drawer.classList.add('active');
      }

      function closeDrawer() {
        overlay.classList.remove('active');
        drawer.classList.remove('active');
      }

      document.getElementById('filter-btn').addEventListener('click', openDrawer);
      document.getElementById('close-drawer').addEventListener('click', closeDrawer);
      overlay.addEventListener('click', closeDrawer);

      document.querySelectorAll('.filter-option input').forEach(input => {
        input.addEventListener('change', updateFilterBadge);
      });
    }

    function initLoading() {
      const loading = document.getElementById('loading');
      window.addEventListener('load', () => {
        setTimeout(() => {
          loading.classList.add('hidden');
        }, 700);
      });
    }

    function init() {
      updateCountdown();
      updateStats();
      renderTasks();
      renderTimeline();
      updateFilterBadge();
      initTabs();
      initDrawer();
      initLoading();

      document.getElementById('critical-tasks').addEventListener('click', handleTaskToggle);
      document.getElementById('all-tasks').addEventListener('click', handleTaskToggle);
    }

    init();
  </script>
</body>
</html>
