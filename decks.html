<!DOCTYPE html>
<html lang="en" data-theme="light" data-theme-mode="light" data-cruise-mode="before" data-cruise-day="1" data-day-part="evening" data-port-theme="none"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.5, user-scalable=no">
  <meta name="theme-color" content="#0a2e4a">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Deck Navigator · Adventure of the Seas</title>

  <!-- Fonts & Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,400;14..32,500;14..32,600&amp;family=Plus+Jakarta+Sans:wght@500;600;700;800&amp;display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800;900&amp;family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/base.css?v=3">
  <link rel="stylesheet" href="css/utilities.css?v=3">
  <link rel="stylesheet" href="css/components.css?v=3">
    <link rel="stylesheet" href="css/feature-modules.css?v=3">
    <link rel="stylesheet" href="css/mobile-first.css?v=3">
  <script src="js/shared-layout.js?v=17" defer=""></script>
  <link rel="stylesheet" href="css/page-inline-extracted.css?v=2">
  <style>
    /* =========================================================
      DECK NAVIGATOR — SINGLE FILE (FULL)
      Light cruising vibe • glass • calm RCCL-adjacent
      Includes: cards, search/filters, quick rail, categories,
                modal viewer, zoom/pan, hotspots, focus chips
    ========================================================= */

    /* ---------- RESET / GLOBAL ---------- */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { height: 100%; }
    img { max-width: 100%; display: block; }
    button { font: inherit; }

    :root{
      --depth-1: 0 10px 25px -8px rgba(0,35,65,0.06), 0 2px 6px rgba(0,35,65,0.02);
      --depth-2: 0 20px 35px -12px rgba(0,45,75,0.12), 0 4px 12px rgba(0,45,75,0.03);
      --depth-3: 0 30px 50px -18px rgba(0,55,90,0.18), 0 8px 20px rgba(0,55,90,0.04);

      --glass: rgba(255,255,255,0.70);
      --glass-edge: rgba(255,255,255,0.50);
      --glass-border: 1px solid rgba(255,255,255,0.55);

      --radius-card: 28px;
      --radius-pill: 60px;
      --radius-btn: 40px;

      --ease-out: cubic-bezier(0.25, 0.46, 0.45, 0.94);
      --ease-smooth: cubic-bezier(0.22, 1, 0.36, 1);

      --navy-deep: #0A2E4A;
      --navy-soft: #1C4E6C;
      --gold: #C6A15B;
      --gold-light: #E5D4B3;
      --sky-pale: #F0F7FA;
      --white-soft: #F9FCFE;

      --focus: rgba(198,161,91,0.35);
      --focus-ring: 0 0 0 3px var(--focus);
    }

    body{
      background-color: var(--sky-pale);
      background-image:
        radial-gradient(circle at 20% 30%, rgba(200,225,240,0.40) 0%, transparent 30%),
        radial-gradient(circle at 90% 70%, rgba(180,210,235,0.30) 0%, transparent 35%);
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      color: var(--navy-deep);
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
      overflow-x: hidden;
    }

    /* Typography */
    h1, h2, h3, .deck-title, .deck-hero__title{
      font-family: 'Plus Jakarta Sans', sans-serif;
      font-weight: 700;
      letter-spacing: -0.01em;
    }

    .container{
      width: min(100% - 32px, 1280px);
      margin-inline: auto;
    }

    .skip-link{
      position: fixed;
      top: -48px;
      left: 16px;
      background: var(--navy-deep);
      color: white;
      padding: 12px 20px;
      border-radius: var(--radius-pill);
      z-index: 9999;
      transition: top 0.2s;
      text-decoration: none;
      box-shadow: var(--depth-2);
    }
    .skip-link:focus{ top: 16px; outline: none; box-shadow: var(--depth-2), var(--focus-ring); }

    /* ---------- HERO ---------- */
    .decks-shell{ padding-bottom: 40px; }

    .deck-hero{
      padding: 56px 0 24px;
      position: relative;
      overflow: hidden;
    }
    .deck-hero::after{
      content:'';
      position:absolute;
      top:-12%;
      right:-6%;
      width: 320px;
      height: 320px;
      background: radial-gradient(circle, rgba(198,161,91,0.10) 0%, transparent 70%);
      border-radius: 50%;
      pointer-events:none;
    }
    .deck-hero__eyebrow{
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 3px;
      color: var(--navy-soft);
      opacity: 0.75;
      font-weight: 600;
    }
    .deck-hero__title{
      font-size: clamp(2.4rem, 8vw, 3.6rem);
      font-weight: 800;
      color: var(--navy-deep);
      line-height: 1.1;
      margin: 8px 0 4px;
      text-shadow: 0 2px 5px rgba(255,255,255,0.5);
    }
    .deck-hero__subtitle{
      font-size: 1.2rem;
      font-weight: 400;
      color: #3A5E76;
      margin-bottom: 24px;
    }
    .deck-hero__actions{
      display:flex;
      gap: 16px;
      flex-wrap: wrap;
    }

    /* Buttons */
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding: 12px 32px;
      border-radius: var(--radius-pill);
      font-weight: 600;
      font-size: 0.95rem;
      text-decoration:none;
      transition: 0.25s var(--ease-smooth);
      border: 1px solid rgba(255,255,255,0.70);
      cursor:pointer;
      background: white;
      color: var(--navy-deep);
      box-shadow: var(--depth-1);
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
      user-select: none;
    }
    .btn:focus{ outline: none; box-shadow: var(--depth-2), var(--focus-ring); }
    .btn--primary{
      background: var(--navy-deep);
      color: white;
      box-shadow: 0 10px 20px -8px rgba(10,46,74,0.30);
      border-color: rgba(10,46,74,0.60);
    }
    .btn--primary:hover{
      background: #144A66;
      transform: translateY(-2px);
      box-shadow: 0 18px 28px -10px rgba(10,46,74,0.40);
    }
    .btn--secondary{
      background: rgba(255,255,255,0.75);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.90);
    }

    /* ---------- SEARCH / FILTERS ---------- */
    .main-navigation{ margin-top: 16px; }
    .main-navigation__inner{
      display:flex;
      flex-wrap: wrap;
      align-items:center;
      gap: 18px;
      background: var(--glass);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border: var(--glass-border);
      padding: 16px 24px;
      border-radius: 48px;
      box-shadow: var(--depth-2);
    }
    .main-navigation__search{
      flex: 1 1 260px;
      display:flex;
      align-items:center;
      gap: 12px;
      background: rgba(255,255,255,0.60);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,0.70);
      padding: 10px 20px;
      border-radius: 60px;
      transition: box-shadow 0.2s, background 0.2s;
    }
    .main-navigation__search:focus-within{
      background: white;
      box-shadow: var(--focus-ring);
    }
    .main-navigation__search i{
      color: var(--navy-soft);
      opacity: 0.8;
    }
    .main-navigation__search input{
      border: none;
      background: transparent;
      width: 100%;
      font-size: 1rem;
      font-weight: 500;
      color: var(--navy-deep);
      outline: none;
    }
    .main-navigation__search input::placeholder{
      color: #53778b;
      font-weight: 400;
      opacity: 0.85;
    }

    .main-navigation__filters{
      display:flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .pill-btn{
      padding: 10px 22px;
      border-radius: 60px;
      border: 1px solid rgba(255,255,255,0.60);
      background: rgba(255,255,255,0.45);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      font-weight: 600;
      font-size: 0.9rem;
      color: var(--navy-deep);
      transition: all 0.2s ease;
      cursor: pointer;
      letter-spacing: 0.2px;
      user-select: none;
    }
    .pill-btn:focus{ outline: none; box-shadow: var(--focus-ring); }
    .pill-btn.is-active{
      background: var(--navy-deep);
      color: white;
      border-color: var(--navy-deep);
      box-shadow: 0 8px 16px -8px rgba(10,46,74,0.20);
    }

    /* ---------- QUICK RAIL ---------- */
    .deck-quickrail-wrap{
      margin-top: 32px;
      -webkit-mask: linear-gradient(90deg, transparent 0%, black 8%, black 92%, transparent 100%);
      mask: linear-gradient(90deg, transparent 0%, black 8%, black 92%, transparent 100%);
    }
    .deck-quickrail{
      display:flex;
      gap: 12px;
      overflow-x: auto;
      padding: 8px 4px 20px;
      scrollbar-width: thin;
      scrollbar-color: var(--gold) rgba(200,200,200,0.20);
      scroll-snap-type: x mandatory;
      overscroll-behavior-x: contain;
    }
    .deck-quickrail::-webkit-scrollbar{ height: 4px; }
    .deck-quickrail::-webkit-scrollbar-thumb{
      background: var(--gold);
      border-radius: 20px;
    }
    .deck-quickbtn{
      flex: 0 0 auto;
      scroll-snap-align: start;
      background: rgba(255,255,255,0.70);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      padding: 14px 24px;
      border-radius: 36px;
      box-shadow: var(--depth-1);
      display:flex;
      flex-direction: column;
      align-items: flex-start;
      transition: 0.25s var(--ease-smooth);
      cursor: pointer;
      border: none;
      user-select: none;
      min-width: 190px;
    }
    .deck-quickbtn:hover{
      transform: translateY(-3px);
      background: white;
      box-shadow: var(--depth-3);
    }
    .deck-quickbtn:focus{ outline: none; box-shadow: var(--depth-2), var(--focus-ring); }
    .deck-quickbtn.is-active{
      background: var(--navy-deep);
      color: white;
      box-shadow: 0 16px 28px -12px rgba(10,46,74,0.50);
    }
    .deck-quickbtn.is-active .deck-quickbtn__num,
    .deck-quickbtn.is-active .deck-quickbtn__sub{ color: white; }
    .deck-quickbtn__num{
      font-size: 1.6rem;
      font-weight: 800;
      line-height: 1;
      font-family: 'Plus Jakarta Sans', sans-serif;
      color: var(--navy-deep);
    }
    .deck-quickbtn__sub{
      font-size: 0.82rem;
      opacity: 0.78;
      font-weight: 500;
      color: var(--navy-soft);
      margin-top: 6px;
    }

    /* ---------- CATEGORIES ---------- */
    .deck-directory{ margin-top: 48px; }
    .deck-directory__header{
      display:flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 14px;
      margin-bottom: 20px;
    }
    .deck-directory__title{
      font-size: 1.6rem;
      font-weight: 800;
      color: var(--navy-deep);
    }
    .deck-directory__toggle{
      background: rgba(255,255,255,0.60);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,0.80);
      padding: 10px 22px;
      border-radius: 60px;
      font-weight: 650;
      color: var(--navy-deep);
      transition: 0.2s;
      cursor: pointer;
      user-select: none;
      display:flex;
      align-items:center;
      gap: 10px;
      white-space: nowrap;
    }
    .deck-directory__toggle:focus{ outline:none; box-shadow: var(--focus-ring); }
    .deck-directory__panels{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 24px;
      margin-bottom: 20px;
    }
    .category-card{
      background: var(--glass);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: var(--glass-border);
      border-radius: 32px;
      padding: 28px 24px;
      box-shadow: var(--depth-1);
      transition: 0.25s;
    }
    .category-card:hover{
      background: rgba(255,255,255,0.80);
      box-shadow: var(--depth-2);
    }
    .category-card__heading{
      font-size: 1.15rem;
      font-weight: 800;
      margin-bottom: 18px;
      display:flex;
      align-items:center;
      gap: 12px;
      color: var(--navy-deep);
    }
    .deck-pills{
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .deck-pill{
      background: white;
      border: 1px solid rgba(10,46,74,0.10);
      border-radius: 40px;
      padding: 10px 16px;
      display:flex;
      align-items: baseline;
      gap: 8px;
      font-weight: 650;
      transition: 0.2s;
      cursor: pointer;
      color: var(--navy-deep);
      user-select: none;
    }
    .deck-pill:focus{ outline:none; box-shadow: var(--focus-ring); }
    .deck-pill:hover{ transform: translateY(-1px); box-shadow: var(--depth-1); }
    .deck-pill__number{
      font-weight: 850;
      color: var(--gold);
      font-size: 1.05rem;
      font-family: 'Plus Jakarta Sans', sans-serif;
    }
    .deck-pill.is-active{
      background: var(--navy-deep);
      color: white;
      border-color: rgba(10,46,74,0.60);
    }
    .deck-pill.is-active .deck-pill__number{ color: white; }

    /* ---------- DECK GRID ---------- */
    .deck-grid{ margin-top: 56px; }
    .deck-grid__title{
      font-size: 1.85rem;
      font-weight: 850;
      margin-bottom: 28px;
      color: var(--navy-deep);
    }
    .deck-cards{
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 28px;
    }
    .deck-card{
      background: white;
      border-radius: var(--radius-card);
      box-shadow: var(--depth-1);
      transition: 0.3s var(--ease-smooth);
      display:flex;
      flex-direction: column;
      overflow:hidden;
      cursor:pointer;
      border: 1px solid rgba(255,255,255,0.60);
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
      outline: none;
    }
    .deck-card:hover{ transform: translateY(-6px); box-shadow: var(--depth-3); }
    .deck-card:focus{ box-shadow: var(--depth-2), var(--focus-ring); }
    .deck-visual{
      position:relative;
      background: linear-gradient(145deg, #F4F9FD, #EAF2F8);
      padding: 20px 20px 0;
      display:flex;
      justify-content:center;
      align-items:center;
      min-height: 190px;
    }
    .deck-number{
      position:absolute;
      top: 16px;
      left: 20px;
      font-size: 2.6rem;
      font-weight: 900;
      color: var(--navy-deep);
      opacity: 0.15;
      line-height: 1;
      font-family: 'Plus Jakarta Sans', sans-serif;
      pointer-events:none;
    }
    .deck-visual img{
      width: 100%;
      height: 160px;
      object-fit: contain;
      transition: transform 0.4s var(--ease-smooth);
      filter: saturate(1.05) contrast(1.02);
    }
    .deck-card:hover .deck-visual img{ transform: scale(1.02); }
    .deck-info{
      padding: 22px 22px 26px;
      background: white;
      border-top: 1px solid rgba(0,0,0,0.02);
    }
    .deck-title{
      font-size: 1.3rem;
      font-weight: 850;
      color: var(--navy-deep);
      margin-bottom: 4px;
    }
    .deck-subtitle{
      font-size: 0.95rem;
      font-weight: 650;
      color: var(--navy-soft);
      opacity: 0.85;
      margin-bottom: 14px;
    }
    .deck-highlights{
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .deck-highlights span{
      background: #F0F6FA;
      padding: 6px 14px;
      border-radius: 40px;
      font-size: 0.8rem;
      font-weight: 650;
      color: #1E4A62;
    }

    .deck-empty{
      text-align:center;
      padding: 60px 20px;
      background: rgba(255,255,255,0.55);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 60px;
      margin-top: 24px;
      border: 1px solid rgba(255,255,255,0.65);
    }
    .deck-empty__icon{ font-size: 2.2rem; margin-bottom: 10px; }
    .deck-empty__title{
      font-size: 1.25rem;
      font-weight: 850;
      margin-bottom: 16px;
      font-family: 'Plus Jakarta Sans', sans-serif;
    }

    /* ---------- MODAL ---------- */
    .deck-modal{
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      background: rgba(10,46,74,0.30);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      padding: 18px;
    }
    .deck-modal.is-open{ display:flex; }

    .deck-modal__backdrop{
      position:absolute;
      inset:0;
      background: transparent;
    }

    .deck-modal__dialog{
      position: relative;
      z-index: 2;
      background: var(--glass);
      backdrop-filter: blur(32px);
      -webkit-backdrop-filter: blur(32px);
      border: 1px solid rgba(255,255,255,0.70);
      border-radius: 44px;
      width: min(94%, 1300px);
      height: min(88%, 900px);
      display:flex;
      flex-direction: column;
      box-shadow: 0 40px 70px -20px rgba(0,20,40,0.30);
      padding: 22px 22px 20px;
    }

    .deck-modal__toolbar{
      display:flex;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 14px;
      flex-wrap: wrap;
    }

    .toolbar-group{
      display:flex;
      gap: 10px;
      background: rgba(255,255,255,0.40);
      padding: 8px;
      border-radius: 60px;
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
      align-items: center;
    }

    .btn-icon, .labeled-btn{
      background: white;
      border: none;
      padding: 12px 18px;
      border-radius: 40px;
      font-size: 0.95rem;
      font-weight: 700;
      color: var(--navy-deep);
      display:flex;
      align-items:center;
      gap: 10px;
      box-shadow: var(--depth-1);
      transition: 0.2s var(--ease-smooth);
      cursor:pointer;
      user-select: none;
      text-decoration: none;
      white-space: nowrap;
    }
    .btn-icon{ padding: 12px 14px; }
    .btn-icon:focus, .labeled-btn:focus{ outline:none; box-shadow: var(--depth-2), var(--focus-ring); }
    .btn-icon:hover, .labeled-btn:hover{
      background: var(--navy-deep);
      color: white;
      transform: translateY(-2px);
    }

    .labeled-btn[aria-disabled="true"]{
      opacity: 0.55;
      cursor: not-allowed;
      pointer-events: none;
      filter: grayscale(0.2);
    }

    .zoom-level{
      font-weight: 800;
      color: var(--navy-soft);
      padding-inline: 6px;
      min-width: 64px;
      text-align: center;
    }

    .close-btn{
      background: rgba(255,255,255,0.65);
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 1.15rem;
      color: var(--navy-deep);
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
      transition: 0.2s var(--ease-smooth);
      cursor: pointer;
      box-shadow: var(--depth-1);
      user-select: none;
    }
    .close-btn:hover{
      background: var(--navy-deep);
      color: white;
      transform: translateY(-2px);
    }
    .close-btn:focus{ outline:none; box-shadow: var(--depth-2), var(--focus-ring); }

    .deck-modal__body{
      flex: 1;
      min-height: 0;
      display:flex;
      flex-direction: column;
    }
    .deck-modal__title{
      font-size: 1.65rem;
      font-weight: 900;
      color: var(--navy-deep);
    }
    .deck-modal__subtitle{
      color: #3C6279;
      margin: 6px 0 14px;
      font-weight: 550;
      min-height: 1.2em;
    }

    /* Focus chips */
    .deck-focuschips{
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 14px;
    }
    .deck-focuschip{
      background: rgba(255,255,255,0.62);
      border: 1px solid rgba(255,255,255,0.90);
      padding: 8px 16px;
      border-radius: 40px;
      font-weight: 750;
      color: var(--navy-deep);
      transition: 0.2s var(--ease-smooth);
      cursor: pointer;
      user-select: none;
    }
    .deck-focuschip:hover{ transform: translateY(-1px); box-shadow: var(--depth-1); }
    .deck-focuschip:focus{ outline:none; box-shadow: var(--focus-ring); }
    .deck-focuschip.is-active{
      background: var(--navy-deep);
      color: white;
      border-color: rgba(10,46,74,0.60);
    }

    .deck-modal__frame{
      flex: 1;
      min-height: 0;
      background: #EFF5F9;
      border-radius: 36px;
      padding: 18px;
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,0.70);
    }

    .deck-plan-stage{
      width: 100%;
      height: 100%;
      overflow: auto;
      position: relative;
      scroll-behavior: smooth;
      border-radius: 24px;
      background: rgba(255,255,255,0.55);
      border: 1px solid rgba(255,255,255,0.75);
      -webkit-overflow-scrolling: touch;
      overscroll-behavior: contain;
    }

    .deck-plan-canvas{
      position: relative;
      display: inline-block;
      transform-origin: 0 0;
      transition: transform 0.08s ease;
      will-change: transform;
      padding: 8px;
    }

    .deck-plan-media{
      max-width: none; /* allow zoom without reflow */
      display:block;
      border-radius: 20px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.05);
      background: white;
    }

    .deck-plan-hotspots{ position: absolute; inset: 8px; pointer-events: none; }
    .deck-hotspot{
      pointer-events: auto;
      position:absolute;
      width: 42px;
      height: 42px;
      border-radius: 50%;
      background: rgba(198,161,91,0.92);
      border: 3px solid white;
      color: white;
      font-weight: 900;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow: 0 4px 14px rgba(0,0,0,0.20);
      cursor:pointer;
      transition: 0.18s var(--ease-smooth);
      transform: translate(-50%, -50%);
      backdrop-filter: blur(2px);
      -webkit-backdrop-filter: blur(2px);
      font-size: 1.05rem;
      user-select: none;
    }
    .deck-hotspot:hover{ transform: translate(-50%, -50%) scale(1.14); }
    .deck-hotspot[data-selected="true"]{
      outline: 0;
      box-shadow: 0 0 0 6px rgba(10,46,74,0.14), 0 4px 14px rgba(0,0,0,0.20);
      background: var(--navy-deep);
    }
    .deck-hotspot[data-highlight="true"]{
      background: var(--gold);
      box-shadow: 0 0 0 6px rgba(198,161,91,0.25), 0 4px 14px rgba(0,0,0,0.20);
      animation: pulse 2.2s infinite;
    }
    @keyframes pulse{
      0%{ box-shadow: 0 0 0 0 rgba(198,161,91,0.55), 0 4px 14px rgba(0,0,0,0.20); }
      70%{ box-shadow: 0 0 0 14px rgba(198,161,91,0.0), 0 4px 14px rgba(0,0,0,0.20); }
      100%{ box-shadow: 0 0 0 0 rgba(198,161,91,0.0), 0 4px 14px rgba(0,0,0,0.20); }
    }

    .deck-plan-legend{
      margin-top: 14px;
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .deck-plan-legend-item{
      background: white;
      border: 1px solid rgba(10,46,74,0.08);
      padding: 10px 16px;
      border-radius: 60px;
      box-shadow: var(--depth-1);
      display:flex;
      flex-direction: column;
      align-items: flex-start;
      cursor:pointer;
      transition: 0.2s var(--ease-smooth);
      max-width: 100%;
      text-align: left;
      user-select: none;
    }
    .deck-plan-legend-item:hover{ transform: translateY(-1px); box-shadow: var(--depth-2); }
    .deck-plan-legend-item:focus{ outline:none; box-shadow: var(--depth-2), var(--focus-ring); }
    .deck-plan-legend-item strong{ font-weight: 900; }
    .deck-plan-legend-item span{
      opacity: 0.78;
      font-weight: 550;
      font-size: 0.9rem;
      margin-top: 4px;
      line-height: 1.35;
    }
    .deck-plan-legend-item.is-active{
      background: var(--navy-deep);
      color: white;
      border-color: rgba(10,46,74,0.60);
    }
    .deck-plan-legend-item.is-active span{ opacity: 0.9; }

    /* Pan hint */
    .deck-pan-hint{
      background: rgba(10,46,74,0.85);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      color: white;
      padding: 10px 18px;
      border-radius: 60px;
      position: absolute;
      bottom: 16px;
      left: 16px;
      display:flex;
      align-items:center;
      gap: 10px;
      box-shadow: var(--depth-2);
      opacity: 0;
      transform: translateY(6px);
      transition: 0.22s var(--ease-smooth);
      pointer-events: none;
      font-weight: 650;
    }
    .deck-pan-hint.is-visible{
      opacity: 1;
      transform: translateY(0);
    }

    /* Modal skeleton */
    .deck-plan-skeleton{
      height: 100%;
      border-radius: 28px;
      background:
        linear-gradient(90deg, rgba(255,255,255,0.55), rgba(255,255,255,0.85), rgba(255,255,255,0.55));
      background-size: 200% 100%;
      animation: shimmer 1.2s infinite;
      display:flex;
      align-items:center;
      justify-content:center;
      color: rgba(28,78,108,0.75);
      font-weight: 750;
    }
    @keyframes shimmer{
      0%{ background-position: 0% 0%; }
      100%{ background-position: 200% 0%; }
    }

    /* Body lock when modal open */
    body.is-modal-open{ overflow: hidden; }

    /* ---------- RESPONSIVE ---------- */
    @media (max-width: 680px){
      .main-navigation__inner{ border-radius: 32px; padding: 18px; }
      .deck-quickbtn{ padding: 12px 18px; min-width: 168px; }
      .deck-modal{ padding: 12px; }
      .deck-modal__dialog{ padding: 16px; border-radius: 34px; height: min(90%, 900px); }
      .deck-modal__frame{ padding: 12px; border-radius: 28px; }
      .toolbar-group{ padding: 6px; gap: 8px; }
      .btn-icon, .labeled-btn{ padding: 11px 14px; }
      .close-btn{ width: 46px; height: 46px; }
      .deck-plan-legend-item{ width: 100%; border-radius: 22px; }
    }

    @media (prefers-reduced-motion: reduce){
      *{ transition: none !important; animation: none !important; scroll-behavior: auto !important; }
    }
  </style>
<link id="rccl-minimal-stylesheet" rel="stylesheet" href="css/shared-layout.css?v=9"><style id="rccl-nav-v2-overrides">
      .app-header--rccl-site .header-utility__promo {
        font-weight: 700;
        color: #1f5e87;
        font-size: 0.78rem;
      }

      .app-header--rccl-site .header-utility {
        background: linear-gradient(180deg, #ecf8ff 0%, #dff1ff 100%);
        border-bottom: 1px solid rgba(8, 89, 136, 0.14);
      }

      .app-header--rccl-site .header-utility__crumb {
        color: #124d75;
      }

      .app-header--rccl-site .header-utility__mode {
        color: #0f4e76;
        background: rgba(255, 255, 255, 0.76);
        border-color: rgba(8, 89, 136, 0.22);
      }

      .app-header--rccl-site .header-nav {
        gap: 2px;
      }

      .app-header--rccl-site .header-nav__link {
        display: inline-flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 2px;
        min-width: 96px;
        padding: 9px 12px 10px;
      }

      .app-header--rccl-site .header-nav__link i {
        font-size: 0.86rem;
      }

      .app-header--rccl-site .header-nav__label {
        font-size: 0.88rem;
        line-height: 1.2;
        font-weight: 700;
      }

      .app-header--rccl-site .header-nav__hint {
        font-size: 0.68rem;
        line-height: 1.2;
        color: rgba(208, 229, 249, 0.82);
      }

      .app-header--rccl-site .header-nav__link.active .header-nav__hint {
        color: #7b5c2b;
      }

      .app-header--rccl-site .header-nav__link.active {
        color: #0f4f76;
        background: linear-gradient(180deg, rgba(255, 213, 125, 0.3) 0%, rgba(255, 213, 125, 0.16) 100%);
        border-color: rgba(255, 190, 92, 0.42);
        box-shadow: 0 8px 16px rgba(0, 121, 180, 0.12);
      }

      .app-header--rccl-site .header-nav__link.active i {
        color: #0f4f76;
      }

      .app-header--rccl-site .header-cta--help {
        min-height: 36px;
      }

      .more-drawer-backdrop {
        position: fixed;
        inset: 0;
        background: rgba(4, 12, 26, 0.56);
        z-index: 1050;
        opacity: 0;
        transition: opacity 220ms ease;
      }

      .more-drawer-backdrop.is-open {
        opacity: 1;
      }

      .more-drawer {
        position: fixed;
        top: 0;
        right: 0;
        width: min(360px, 92vw);
        height: 100dvh;
        background: linear-gradient(180deg, rgba(7, 33, 68, 0.98) 0%, rgba(6, 24, 49, 0.98) 100%);
        color: #f4f8ff;
        border-left: 1px solid rgba(255, 255, 255, 0.16);
        box-shadow: -16px 0 44px rgba(2, 12, 26, 0.44);
        z-index: 1051;
        padding: 14px 14px 18px;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        opacity: 0;
        transform: translateX(14px);
        transition: transform 240ms cubic-bezier(0.22, 0.61, 0.36, 1), opacity 180ms ease;
        pointer-events: none;
      }

      .more-drawer.is-open {
        opacity: 1;
        transform: translateX(0);
        pointer-events: auto;
      }

      .more-drawer__header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 12px;
      }

      .more-drawer__header h2 {
        margin: 0;
        font-size: 1.1rem;
        color: #fff;
      }

      .more-drawer__close {
        width: 34px;
        height: 34px;
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.22);
        background: rgba(255, 255, 255, 0.08);
        color: #fff;
      }

      .more-drawer__group {
        margin-top: 16px;
      }

      .more-drawer__group-title {
        margin: 0 0 8px;
        padding: 0 4px;
        font-size: 0.76rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: #ffe7a6;
      }

      .more-drawer__group-links {
        display: grid;
        gap: 6px;
      }

      .more-drawer__link {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        min-height: 42px;
        padding: 9px 12px;
        border-radius: 11px;
        border: 1px solid rgba(255, 255, 255, 0.12);
        color: #f4f8ff;
        text-decoration: none;
        background: rgba(255, 255, 255, 0.04);
      }

      .more-drawer__link:hover,
      .more-drawer__link.active {
        border-color: rgba(255, 223, 137, 0.44);
        background: rgba(255, 223, 137, 0.14);
      }

      .bottom-nav {
        position: fixed;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 990;
        display: none;
        grid-template-columns: repeat(5, minmax(0, 1fr));
        gap: 8px;
        padding: 9px 12px calc(10px + env(safe-area-inset-bottom));
        background: rgba(241, 250, 255, 0.92);
        border-top: 1px solid rgba(8, 89, 136, 0.18);
        backdrop-filter: blur(10px);
      }

      .bottom-nav__item {
        min-height: 48px;
        border-radius: 12px;
        border: 1px solid rgba(8, 89, 136, 0.14);
        background: rgba(255, 255, 255, 0.64);
        color: #1f567c;
        text-decoration: none;
        display: inline-flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 2px;
        font-size: 0.67rem;
        font-weight: 700;
        transition: transform 170ms ease, background-color 170ms ease, border-color 170ms ease;
      }

      .bottom-nav__item:active {
        transform: scale(0.97);
      }

      .bottom-nav__item i {
        font-size: 0.8rem;
      }

      .bottom-nav__item.active {
        border-color: rgba(255, 190, 92, 0.56);
        color: #0f4f76;
        background: rgba(255, 190, 92, 0.22);
        box-shadow: 0 8px 14px rgba(0, 121, 180, 0.12);
      }

      @media (max-width: 767px) {
        body.app-theme-rcc {
          padding-bottom: calc(92px + env(safe-area-inset-bottom));
        }

        .bottom-nav {
          display: grid;
        }

        .app-header--rccl-site .header-nav__hint {
          display: none;
        }

        .app-header--rccl-site .header-actions .header-cta--help {
          display: none;
        }
      }

      html.more-drawer-open,
      body.more-drawer-open {
        overflow: hidden !important;
        overscroll-behavior: none !important;
      }

      @media print {
        .skip-link,
        .app-header--rccl-site .header-utility,
        .app-header--rccl-site .header-nav,
        .app-header--rccl-site .header-actions,
        .app-header--rccl-site .mobile-nav-toggle,
        .more-drawer,
        .more-drawer-backdrop,
        .bottom-nav {
          display: none !important;
        }

        .app-header--rccl-site {
          position: static !important;
          background: transparent !important;
          border: none !important;
          box-shadow: none !important;
          margin: 0 0 0.25in !important;
          padding: 0 !important;
        }

        .app-header--rccl-site .header-container {
          display: block !important;
          padding: 0 !important;
          border: none !important;
          background: transparent !important;
          box-shadow: none !important;
        }

        .app-header--rccl-site .header-brand {
          margin: 0 !important;
        }

        .app-header--rccl-site .header-logo {
          color: #0b2b47 !important;
          background: transparent !important;
          border: none !important;
          box-shadow: none !important;
          padding: 0 !important;
        }
      }
    </style></head>

<body class="decks-page app-theme-rcc">
  <a href="#main" class="skip-link">Skip to main content</a>

  <div id="sharedHeader">
        <header class="app-header--minimal app-header--rccl-site" role="banner">
          <div class="header-utility">
            <div class="header-utility__inner">
              <div class="header-utility__left">
                <span class="header-utility__crumb">Adventure of the Seas</span>
                <span class="header-utility__mode mode-before" id="navModeBadge">Before Sail</span>
              </div>
              <span class="header-utility__promo" id="navContextLine">Boarding soon · lock final details</span>
            </div>
          </div>

          <div class="header-container">
            <div class="header-brand">
              <a href="index.html" class="header-logo">
                <i class="fas fa-crown" aria-hidden="true"></i>
                <div class="header-logo-text">
                  <span class="header-logo-title">Royal Caribbean</span>
                  <span class="header-logo-subtitle">Adventure of the Seas · Cruise Companion</span>
                </div>
              </a>
            </div>

            <nav class="header-nav" id="headerPrimaryNav" aria-label="Primary navigation" aria-hidden="true" style="display: none;">
              
        <a href="index.html" class="header-nav__link " data-nav="home">
          <i class="fas fa-home" aria-hidden="true"></i>
          <span class="header-nav__label">Home</span>
          <span class="header-nav__hint">The Countdown</span>
        </a>
      
        <a href="plan.html" class="header-nav__link " data-nav="plan">
          <i class="fas fa-compass" aria-hidden="true"></i>
          <span class="header-nav__label">Game Plan</span>
          <span class="header-nav__hint">What To Do Next</span>
        </a>
      
        <a href="itinerary.html#today" class="header-nav__link " data-nav="today">
          <i class="fas fa-calendar-day" aria-hidden="true"></i>
          <span class="header-nav__label">Today</span>
          <span class="header-nav__hint">Right Now</span>
        </a>
      
        <a href="decks.html" class="header-nav__link active" data-nav="map" aria-current="page">
          <i class="fas fa-map" aria-hidden="true"></i>
          <span class="header-nav__label">Ship Map</span>
          <span class="header-nav__hint">Find Anything</span>
        </a>
      
        <a href="dining.html" class="header-nav__link " data-nav="food">
          <i class="fas fa-utensils" aria-hidden="true"></i>
          <span class="header-nav__label">Food</span>
          <span class="header-nav__hint">Tonight's Pick</span>
        </a>
      
        <a href="rooms.html" class="header-nav__link " data-nav="family">
          <i class="fas fa-users" aria-hidden="true"></i>
          <span class="header-nav__label">Family</span>
          <span class="header-nav__hint">Who's Where</span>
        </a>
      
            </nav>

            <div class="header-actions" id="headerHeaderActions" aria-hidden="true" style="display: none;">
              <button type="button" class="header-cta header-cta--help" id="headerMoreButton" aria-haspopup="dialog" aria-expanded="false" aria-controls="moreDrawer">
                <span>More</span>
                <i class="fas fa-chevron-down" aria-hidden="true"></i>
              </button>
              <button type="button" class="header-cta header-cta--install" id="pwaInstallButton" hidden="" aria-hidden="true">
                <i class="fas fa-download" aria-hidden="true"></i>
                <span>Install App</span>
              </button>
            </div>

            <button class="mobile-nav-toggle" aria-label="Open menu" aria-expanded="false" aria-controls="headerPrimaryNav">
              <i class="fas fa-bars" aria-hidden="true"></i>
            </button>
          </div>

          
          
        </header>
      </div><main id="main" class="decks-shell">
    <!-- HERO -->
    <section class="deck-hero">
      <div class="container">
        <div class="deck-hero__eyebrow">Adventure of the Seas · Feb 14–20, 2026</div>
        <h1 class="deck-hero__title">Deck Navigator</h1>
        <p class="deck-hero__subtitle">Onboard · Deck by deck</p>
        <div class="deck-hero__actions">
          <a class="btn btn--primary" href="#deck-directory">Open deck directory</a>
          <a class="btn btn--secondary" href="rooms.html">Find my stateroom</a>
        </div>
      </div>
    </section>

    <!-- SEARCH / FILTERS -->
    <section class="main-navigation container" aria-label="Deck navigation">
      <div class="main-navigation__inner">
        <div class="main-navigation__search">
          <i class="fas fa-search" aria-hidden="true"></i>
          <input id="deckSearch" type="search" placeholder="Search decks, venues, or amenities" aria-label="Search decks" autocomplete="off">
        </div>
        <div class="main-navigation__filters" aria-label="Deck filters">
          <button class="pill-btn is-active" data-filter="all" type="button">All</button>
          <button class="pill-btn" data-filter="entertainment" type="button">Entertainment</button>
          <button class="pill-btn" data-filter="wellness" type="button">Wellness</button>
          <button class="pill-btn" data-filter="essential" type="button">Essential</button>
        </div>
      </div>
    </section>

    <!-- QUICK RAIL -->
    <section class="deck-quickrail-wrap container" aria-label="Quick deck rail">
      <div class="deck-quickrail" id="deckQuickRail">
          <button class="deck-quickbtn" data-deck="15" type="button" aria-label="Open Deck 15">
            <span class="deck-quickbtn__num">D15</span>
            <span class="deck-quickbtn__sub">Sports &amp; Observation</span>
          </button>
        
          <button class="deck-quickbtn" data-deck="14" type="button" aria-label="Open Deck 14">
            <span class="deck-quickbtn__num">D14</span>
            <span class="deck-quickbtn__sub">Sky Deck</span>
          </button>
        
          <button class="deck-quickbtn" data-deck="13" type="button" aria-label="Open Deck 13">
            <span class="deck-quickbtn__num">D13</span>
            <span class="deck-quickbtn__sub">Adventure Zone</span>
          </button>
        
          <button class="deck-quickbtn" data-deck="12" type="button" aria-label="Open Deck 12">
            <span class="deck-quickbtn__num">D12</span>
            <span class="deck-quickbtn__sub">Pool Deck</span>
          </button>
        
          <button class="deck-quickbtn" data-deck="11" type="button" aria-label="Open Deck 11">
            <span class="deck-quickbtn__num">D11</span>
            <span class="deck-quickbtn__sub">Fitness &amp; Spa</span>
          </button>
        
          <button class="deck-quickbtn" data-deck="10" type="button" aria-label="Open Deck 10">
            <span class="deck-quickbtn__num">D10</span>
            <span class="deck-quickbtn__sub">Stateroom Corridor</span>
          </button>
        
          <button class="deck-quickbtn is-active" data-deck="9" type="button" aria-label="Open Deck 9">
            <span class="deck-quickbtn__num">D9</span>
            <span class="deck-quickbtn__sub">Midship Cabins</span>
          </button>
        
          <button class="deck-quickbtn" data-deck="8" type="button" aria-label="Open Deck 8">
            <span class="deck-quickbtn__num">D8</span>
            <span class="deck-quickbtn__sub">Stateroom Access</span>
          </button>
        
          <button class="deck-quickbtn" data-deck="7" type="button" aria-label="Open Deck 7">
            <span class="deck-quickbtn__num">D7</span>
            <span class="deck-quickbtn__sub">Cabin Transit</span>
          </button>
        
          <button class="deck-quickbtn" data-deck="6" type="button" aria-label="Open Deck 6">
            <span class="deck-quickbtn__num">D6</span>
            <span class="deck-quickbtn__sub">Stateroom Ring</span>
          </button>
        
          <button class="deck-quickbtn" data-deck="5" type="button" aria-label="Open Deck 5">
            <span class="deck-quickbtn__num">D5</span>
            <span class="deck-quickbtn__sub">Promenade Level</span>
          </button>
        
          <button class="deck-quickbtn" data-deck="4" type="button" aria-label="Open Deck 4">
            <span class="deck-quickbtn__num">D4</span>
            <span class="deck-quickbtn__sub">Dining &amp; Entertainment</span>
          </button>
        
          <button class="deck-quickbtn" data-deck="3" type="button" aria-label="Open Deck 3">
            <span class="deck-quickbtn__num">D3</span>
            <span class="deck-quickbtn__sub">Lobby &amp; Guest Services</span>
          </button>
        
          <button class="deck-quickbtn" data-deck="2" type="button" aria-label="Open Deck 2">
            <span class="deck-quickbtn__num">D2</span>
            <span class="deck-quickbtn__sub">Medical &amp; Crew Support</span>
          </button>
        
          <button class="deck-quickbtn" data-deck="0" type="button" aria-label="Open All Decks">
            <span class="deck-quickbtn__num">ALL</span>
            <span class="deck-quickbtn__sub">Ship Overview</span>
          </button>
        </div>
    </section>

    <!-- CATEGORIES -->
    <section id="deck-directory" class="deck-directory container">
      <div class="deck-directory__header">
        <h2 class="deck-directory__title">Browse by category</h2>
        <button id="toggleCategoryBrowse" class="deck-directory__toggle" type="button" aria-expanded="false" aria-controls="deckCategoryPanels">
          Show <i class="fas fa-chevron-down" aria-hidden="true"></i>
        </button>
      </div>

      <div id="deckCategoryPanels" class="deck-directory__panels" hidden="">
        <article class="category-card" data-category="entertainment">
          <div class="category-card__heading"><i class="fas fa-masks-theater" aria-hidden="true"></i> Entertainment</div>
          <div class="deck-pills" id="pill-entertainment">
            <button class="deck-pill" type="button" data-deck="14" aria-label="Open Deck 14">
              <span class="deck-pill__number">14</span>
              <span class="deck-pill__text">Sky Deck</span>
            </button>
          
            <button class="deck-pill" type="button" data-deck="13" aria-label="Open Deck 13">
              <span class="deck-pill__number">13</span>
              <span class="deck-pill__text">Adventure Zone</span>
            </button>
          
            <button class="deck-pill" type="button" data-deck="5" aria-label="Open Deck 5">
              <span class="deck-pill__number">5</span>
              <span class="deck-pill__text">Promenade Level</span>
            </button>
          
            <button class="deck-pill" type="button" data-deck="4" aria-label="Open Deck 4">
              <span class="deck-pill__number">4</span>
              <span class="deck-pill__text">Dining &amp; Entertainment</span>
            </button>
          </div>
        </article>

        <article class="category-card" data-category="wellness">
          <div class="category-card__heading"><i class="fas fa-spa" aria-hidden="true"></i> Wellness</div>
          <div class="deck-pills" id="pill-wellness">
            <button class="deck-pill" type="button" data-deck="15" aria-label="Open Deck 15">
              <span class="deck-pill__number">15</span>
              <span class="deck-pill__text">Sports &amp; Observation</span>
            </button>
          
            <button class="deck-pill" type="button" data-deck="12" aria-label="Open Deck 12">
              <span class="deck-pill__number">12</span>
              <span class="deck-pill__text">Pool Deck</span>
            </button>
          
            <button class="deck-pill" type="button" data-deck="11" aria-label="Open Deck 11">
              <span class="deck-pill__number">11</span>
              <span class="deck-pill__text">Fitness &amp; Spa</span>
            </button>
          </div>
        </article>

        <article class="category-card" data-category="essential">
          <div class="category-card__heading"><i class="fas fa-compass" aria-hidden="true"></i> Essential</div>
          <div class="deck-pills" id="pill-essential">
            <button class="deck-pill" type="button" data-deck="0" aria-label="Open All Decks">
              <span class="deck-pill__number">ALL</span>
              <span class="deck-pill__text">Ship Overview</span>
            </button>
          
            <button class="deck-pill" type="button" data-deck="10" aria-label="Open Deck 10">
              <span class="deck-pill__number">10</span>
              <span class="deck-pill__text">Stateroom Corridor</span>
            </button>
          
            <button class="deck-pill is-active" type="button" data-deck="9" aria-label="Open Deck 9">
              <span class="deck-pill__number">9</span>
              <span class="deck-pill__text">Midship Cabins</span>
            </button>
          
            <button class="deck-pill" type="button" data-deck="8" aria-label="Open Deck 8">
              <span class="deck-pill__number">8</span>
              <span class="deck-pill__text">Stateroom Access</span>
            </button>
          
            <button class="deck-pill" type="button" data-deck="7" aria-label="Open Deck 7">
              <span class="deck-pill__number">7</span>
              <span class="deck-pill__text">Cabin Transit</span>
            </button>
          
            <button class="deck-pill" type="button" data-deck="6" aria-label="Open Deck 6">
              <span class="deck-pill__number">6</span>
              <span class="deck-pill__text">Stateroom Ring</span>
            </button>
          
            <button class="deck-pill" type="button" data-deck="3" aria-label="Open Deck 3">
              <span class="deck-pill__number">3</span>
              <span class="deck-pill__text">Lobby &amp; Guest Services</span>
            </button>
          
            <button class="deck-pill" type="button" data-deck="2" aria-label="Open Deck 2">
              <span class="deck-pill__number">2</span>
              <span class="deck-pill__text">Medical &amp; Crew Support</span>
            </button>
          </div>
        </article>
      </div>
    </section>

    <!-- DECK GRID -->
    <section class="deck-grid container">
      <div class="deck-grid__header">
        <h2 class="deck-grid__title">Decks</h2>
      </div>

      <div id="deckCards" class="deck-cards" role="list"><article class="deck-card" data-deck="0" tabindex="0" role="listitem" aria-label="Open All Decks">
            <div class="deck-visual">
              <span class="deck-number">ALL</span>
              <img src="decks/deck-all.svg" alt="All Decks" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">All Decks</h3>
              <p class="deck-subtitle">Ship Overview</p>
              <div class="deck-highlights">
                <span>Full ship layout</span><span>Cross-deck context</span>
              </div>
            </div>
          </article><article class="deck-card" data-deck="15" tabindex="0" role="listitem" aria-label="Open Deck 15">
            <div class="deck-visual">
              <span class="deck-number">15</span>
              <img src="decks/deck-15.png" alt="Deck 15" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">Deck 15</h3>
              <p class="deck-subtitle">Sports &amp; Observation</p>
              <div class="deck-highlights">
                <span>Sports court</span><span>Jog track</span><span>Views</span>
              </div>
            </div>
          </article><article class="deck-card" data-deck="14" tabindex="0" role="listitem" aria-label="Open Deck 14">
            <div class="deck-visual">
              <span class="deck-number">14</span>
              <img src="decks/deck-14.png" alt="Deck 14" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">Deck 14</h3>
              <p class="deck-subtitle">Sky Deck</p>
              <div class="deck-highlights">
                <span>Panoramic views</span><span>Lounges</span><span>Sun decks</span>
              </div>
            </div>
          </article><article class="deck-card" data-deck="13" tabindex="0" role="listitem" aria-label="Open Deck 13">
            <div class="deck-visual">
              <span class="deck-number">13</span>
              <img src="decks/deck-13.png" alt="Deck 13" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">Deck 13</h3>
              <p class="deck-subtitle">Adventure Zone</p>
              <div class="deck-highlights">
                <span>FlowRider</span><span>Activities</span><span>Families</span>
              </div>
            </div>
          </article><article class="deck-card" data-deck="12" tabindex="0" role="listitem" aria-label="Open Deck 12">
            <div class="deck-visual">
              <span class="deck-number">12</span>
              <img src="decks/deck-12.png" alt="Deck 12" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">Deck 12</h3>
              <p class="deck-subtitle">Pool Deck</p>
              <div class="deck-highlights">
                <span>Main pool</span><span>Solarium</span><span>Windjammer</span>
              </div>
            </div>
          </article><article class="deck-card" data-deck="11" tabindex="0" role="listitem" aria-label="Open Deck 11">
            <div class="deck-visual">
              <span class="deck-number">11</span>
              <img src="decks/deck-11.png" alt="Deck 11" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">Deck 11</h3>
              <p class="deck-subtitle">Fitness &amp; Spa</p>
              <div class="deck-highlights">
                <span>Spa</span><span>Fitness</span><span>Wellness</span>
              </div>
            </div>
          </article><article class="deck-card" data-deck="10" tabindex="0" role="listitem" aria-label="Open Deck 10">
            <div class="deck-visual">
              <span class="deck-number">10</span>
              <img src="decks/deck-10.png" alt="Deck 10" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">Deck 10</h3>
              <p class="deck-subtitle">Stateroom Corridor</p>
              <div class="deck-highlights">
                <span>Cabins</span><span>Elevators</span><span>Quiet routes</span>
              </div>
            </div>
          </article><article class="deck-card" data-deck="9" tabindex="0" role="listitem" aria-label="Open Deck 9">
            <div class="deck-visual">
              <span class="deck-number">9</span>
              <img src="decks/deck-09.png" alt="Deck 9" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">Deck 9</h3>
              <p class="deck-subtitle">Midship Cabins</p>
              <div class="deck-highlights">
                <span>Cabins</span><span>Family zones</span><span>Wayfinding</span>
              </div>
            </div>
          </article><article class="deck-card" data-deck="8" tabindex="0" role="listitem" aria-label="Open Deck 8">
            <div class="deck-visual">
              <span class="deck-number">8</span>
              <img src="decks/deck-08.png" alt="Deck 8" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">Deck 8</h3>
              <p class="deck-subtitle">Stateroom Access</p>
              <div class="deck-highlights">
                <span>Cabins</span><span>Guest routes</span><span>Aft access</span>
              </div>
            </div>
          </article><article class="deck-card" data-deck="7" tabindex="0" role="listitem" aria-label="Open Deck 7">
            <div class="deck-visual">
              <span class="deck-number">7</span>
              <img src="decks/deck-07.png" alt="Deck 7" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">Deck 7</h3>
              <p class="deck-subtitle">Cabin Transit</p>
              <div class="deck-highlights">
                <span>Cabins</span><span>Quiet zones</span><span>Midship transit</span>
              </div>
            </div>
          </article><article class="deck-card" data-deck="6" tabindex="0" role="listitem" aria-label="Open Deck 6">
            <div class="deck-visual">
              <span class="deck-number">6</span>
              <img src="decks/deck-06.png" alt="Deck 6" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">Deck 6</h3>
              <p class="deck-subtitle">Stateroom Ring</p>
              <div class="deck-highlights">
                <span>Cabins</span><span>Family adjacency</span><span>Transitions</span>
              </div>
            </div>
          </article><article class="deck-card" data-deck="5" tabindex="0" role="listitem" aria-label="Open Deck 5">
            <div class="deck-visual">
              <span class="deck-number">5</span>
              <img src="decks/deck-05.png" alt="Deck 5" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">Deck 5</h3>
              <p class="deck-subtitle">Promenade Level</p>
              <div class="deck-highlights">
                <span>Entertainment</span><span>Dining</span><span>Retail</span>
              </div>
            </div>
          </article><article class="deck-card" data-deck="4" tabindex="0" role="listitem" aria-label="Open Deck 4">
            <div class="deck-visual">
              <span class="deck-number">4</span>
              <img src="decks/deck-04.png" alt="Deck 4" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">Deck 4</h3>
              <p class="deck-subtitle">Dining &amp; Entertainment</p>
              <div class="deck-highlights">
                <span>Main dining</span><span>Show venue</span><span>Casino</span>
              </div>
            </div>
          </article><article class="deck-card" data-deck="3" tabindex="0" role="listitem" aria-label="Open Deck 3">
            <div class="deck-visual">
              <span class="deck-number">3</span>
              <img src="decks/deck-03.png" alt="Deck 3" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">Deck 3</h3>
              <p class="deck-subtitle">Lobby &amp; Guest Services</p>
              <div class="deck-highlights">
                <span>Guest services</span><span>Dining</span><span>Retail</span>
              </div>
            </div>
          </article><article class="deck-card" data-deck="2" tabindex="0" role="listitem" aria-label="Open Deck 2">
            <div class="deck-visual">
              <span class="deck-number">2</span>
              <img src="decks/deck-02.png" alt="Deck 2" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">Deck 2</h3>
              <p class="deck-subtitle">Medical &amp; Crew Support</p>
              <div class="deck-highlights">
                <span>Medical</span><span>Crew services</span><span>Logistics</span>
              </div>
            </div>
          </article></div>

      <div id="emptyState" class="deck-empty" hidden="">
        <div class="deck-empty__icon">🚢</div>
        <h3 class="deck-empty__title">No matching decks</h3>
        <button class="btn btn--primary" id="clearFilters" type="button">Browse all decks</button>
      </div>
    </section>
  </main>

  <!-- MODAL -->
  <div class="deck-modal" id="deckModal" aria-hidden="true">
    <div class="deck-modal__backdrop" data-action="close-modal" aria-hidden="true"></div>

    <div class="deck-modal__dialog" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalDesc">
      <div class="deck-modal__toolbar">
        <div class="toolbar-group toolbar-group--primary">
          <button class="btn-icon" data-action="prev-deck" aria-label="Previous deck" type="button"><i class="fas fa-chevron-left" aria-hidden="true"></i></button>
          <button class="btn-icon" data-action="next-deck" aria-label="Next deck" type="button"><i class="fas fa-chevron-right" aria-hidden="true"></i></button>
          <button class="btn-icon" data-action="zoom-in" aria-label="Zoom in" type="button"><i class="fas fa-plus" aria-hidden="true"></i></button>
          <button class="btn-icon" data-action="zoom-out" aria-label="Zoom out" type="button"><i class="fas fa-minus" aria-hidden="true"></i></button>
          <button class="btn-icon" data-action="zoom-reset" aria-label="Reset view" type="button"><i class="fas fa-rotate-left" aria-hidden="true"></i></button>
          <span class="zoom-level" id="zoomLevel" aria-label="Zoom level">175%</span>
        </div>

        <div class="toolbar-group toolbar-group--secondary">
          <button class="labeled-btn" data-action="center-me" type="button" aria-label="Center on my location">
            <i class="fas fa-location-dot" aria-hidden="true"></i><span class="btn-label">My Location</span>
          </button>
          <a class="labeled-btn" id="downloadPlan" href="#" target="_blank" rel="noopener" aria-disabled="true">
            <i class="fas fa-file-pdf" aria-hidden="true"></i><span class="btn-label">PDF</span>
          </a>
        </div>

        <button class="close-btn" data-action="close-modal" aria-label="Close" type="button">
          <i class="fas fa-times" aria-hidden="true"></i>
        </button>
      </div>

      <div class="deck-modal__body">
        <h3 id="modalTitle" class="deck-modal__title">Deck 9</h3>
        <p id="modalDesc" class="deck-modal__subtitle">Family-friendly staterooms.</p>

        <p id="deckPanHint" class="deck-pan-hint" hidden="">
          <i class="fas fa-hand-paper" aria-hidden="true"></i> Drag to pan while zoomed in
        </p>

        <div id="deckFocusChips" class="deck-focuschips"></div>
        <div id="modalFrame" class="deck-modal__frame">
            <div class="deck-plan-stage" id="deckPlanStage" aria-label="Deck plan viewer">
              <div class="deck-plan-canvas" id="deckPlanCanvas" style="transform: scale(1.75);">
                <img class="deck-plan-media" src="decks/deck-09-final.min.svg" alt="Deck 9">
                
              </div>
            </div>
            
          </div>
      </div>
    </div>
  </div>

  <div id="sharedFooter">
        <footer class="app-footer--minimal app-footer--rccl-site" role="contentinfo">
          <div class="footer-container">
            <div class="footer-social-row" aria-label="Social links">
              <a href="https://facebook.com/royalcaribbean" class="footer-social__link" target="_blank" rel="noopener noreferrer" aria-label="Facebook"><i class="fab fa-facebook-f" aria-hidden="true"></i></a>
              <a href="https://instagram.com/royalcaribbean" class="footer-social__link" target="_blank" rel="noopener noreferrer" aria-label="Instagram"><i class="fab fa-instagram" aria-hidden="true"></i></a>
              <a href="https://tiktok.com/@royalcaribbean" class="footer-social__link" target="_blank" rel="noopener noreferrer" aria-label="TikTok"><i class="fab fa-tiktok" aria-hidden="true"></i></a>
              <a href="https://youtube.com/@RoyalCaribbeanInternational" class="footer-social__link" target="_blank" rel="noopener noreferrer" aria-label="YouTube"><i class="fab fa-youtube" aria-hidden="true"></i></a>
              <a href="https://x.com/royalcaribbean" class="footer-social__link" target="_blank" rel="noopener noreferrer" aria-label="X"><i class="fab fa-x-twitter" aria-hidden="true"></i></a>
              <a href="https://pinterest.com/royalcaribbean" class="footer-social__link" target="_blank" rel="noopener noreferrer" aria-label="Pinterest"><i class="fab fa-pinterest-p" aria-hidden="true"></i></a>
            </div>

            <div class="footer-country">
              <button type="button" class="footer-country__btn" aria-label="Country: United States">
                <span>🇺🇸</span>
                <span>United States</span>
              </button>
            </div>

            <p class="footer-copyright">© 2026 Royal Caribbean Cruises</p>

            <nav class="footer-legal-links" aria-label="Legal links">
              <a href="https://www.royalcaribbean.com/resources/guest-terms" class="footer-legal__link" target="_blank" rel="noopener noreferrer">Cruise contract</a>
              <a href="https://www.royalcaribbean.com/company/about-us" class="footer-legal__link" target="_blank" rel="noopener noreferrer">About us</a>
              <a href="https://www.royalcaribbean.com/resources/privacy-policy" class="footer-legal__link" target="_blank" rel="noopener noreferrer">Privacy policy</a>
              <a href="https://www.royalcaribbean.com/resources/terms-and-conditions" class="footer-legal__link" target="_blank" rel="noopener noreferrer">Terms of use</a>
              <a href="https://www.royalcaribbeangroup.com/careers/" class="footer-legal__link" target="_blank" rel="noopener noreferrer">Careers</a>
              <a href="https://www.royalcaribbean.com/resources/travel-updates" class="footer-legal__link" target="_blank" rel="noopener noreferrer">Travel updates</a>
            </nav>

            <div class="footer-brands" aria-label="Royal Caribbean brands">
              <span class="footer-brand-mark">Royal Caribbean Group</span>
              <span class="footer-brand-mark">Royal Caribbean</span>
              <span class="footer-brand-mark">Celebrity Cruises</span>
              <span class="footer-brand-mark">Silversea</span>
            </div>
          </div>
        </footer>
      </div><script>
    (function() {
      'use strict';

      // ----- DATA -----
      const deckData = [
        { number: 0,  name: 'All Decks', subtitle: 'Ship Overview', highlights: ['Full ship layout', 'Cross-deck context'], description: 'Complete multi-deck blueprint – ultimate orientation.', category: 'essential',     svg: 'decks/deck-all.min.svg',        pdf: '' },
        { number: 15, name: 'Deck 15',  subtitle: 'Sports & Observation', highlights: ['Sports court', 'Jog track', 'Views'], description: 'FlowRider, mini-golf, running track.', category: 'wellness',     svg: 'decks/deck-15-final.min.svg',   pdf: '' },
        { number: 14, name: 'Deck 14',  subtitle: 'Sky Deck', highlights: ['Panoramic views', 'Lounges', 'Sun decks'], description: 'Viking Crown Lounge & sky bar.', category: 'entertainment', svg: 'decks/deck-14-final.min.svg',   pdf: '' },
        { number: 13, name: 'Deck 13',  subtitle: 'Adventure Zone', highlights: ['FlowRider', 'Activities', 'Families'], description: 'Adventure Ocean & rock climbing wall.', category: 'entertainment', svg: 'decks/deck-13-final.min.svg',   pdf: '' },
        { number: 12, name: 'Deck 12',  subtitle: 'Pool Deck', highlights: ['Main pool', 'Solarium', 'Windjammer'], description: 'Main pool, adults-only solarium, Windjammer.', category: 'wellness',     svg: 'decks/deck-12-final.min.svg',   pdf: '' },
        { number: 11, name: 'Deck 11',  subtitle: 'Fitness & Spa', highlights: ['Spa', 'Fitness', 'Wellness'], description: 'Vitality Spa & fully equipped fitness.', category: 'wellness',     svg: 'decks/deck-11-final.min.svg',   pdf: '' },
        { number: 10, name: 'Deck 10',  subtitle: 'Stateroom Corridor', highlights: ['Cabins', 'Elevators', 'Quiet routes'], description: 'Staterooms and elevator access.', category: 'essential',     svg: 'decks/deck-10-final.min.svg',   pdf: '' },
        { number: 9,  name: 'Deck 9',   subtitle: 'Midship Cabins', highlights: ['Cabins', 'Family zones', 'Wayfinding'], description: 'Family-friendly staterooms.', category: 'essential',     svg: 'decks/deck-09-final.min.svg',   pdf: '' },
        { number: 8,  name: 'Deck 8',   subtitle: 'Stateroom Access', highlights: ['Cabins', 'Guest routes', 'Aft access'], description: 'Convenient access to upper decks.', category: 'essential',     svg: 'decks/deck-08-final.min.svg',   pdf: '' },
        { number: 7,  name: 'Deck 7',   subtitle: 'Cabin Transit', highlights: ['Cabins', 'Quiet zones', 'Midship transit'], description: 'Quiet corridor, elevator stacks C/D.', category: 'essential',     svg: 'decks/deck-07-final.min.svg',   pdf: '' },
        { number: 6,  name: 'Deck 6',   subtitle: 'Stateroom Ring', highlights: ['Cabins', 'Family adjacency', 'Transitions'], description: 'Your stateroom zone (6650) near aft.', category: 'essential',     svg: 'decks/deck-06-final.min.svg',   pdf: '' },
        { number: 5,  name: 'Deck 5',   subtitle: 'Promenade Level', highlights: ['Entertainment', 'Dining', 'Retail'], description: 'Royal Promenade – cafes, shops, parades.', category: 'entertainment', svg: 'decks/deck-05-final.min.svg',   pdf: 'decks/deck-05.pdf' },
        { number: 4,  name: 'Deck 4',   subtitle: 'Dining & Entertainment', highlights: ['Main dining', 'Show venue', 'Casino'], description: 'Main dining room, theater, casino.', category: 'entertainment', svg: 'decks/deck-04-final.min.svg',   pdf: '' },
        { number: 3,  name: 'Deck 3',   subtitle: 'Lobby & Guest Services', highlights: ['Guest services', 'Dining', 'Retail'], description: 'Grand lobby, shore excursions, champagne bar.', category: 'essential',     svg: 'decks/deck-03-final.min.svg',   pdf: '' },
        { number: 2,  name: 'Deck 2',   subtitle: 'Medical & Crew Support', highlights: ['Medical', 'Crew services', 'Logistics'], description: 'Medical center and operations.', category: 'essential',     svg: 'decks/deck-02-final.min.svg',   pdf: '' }
      ];

      const deckHotspots = {
        6: [
          { id: 'aft-cabins', title: 'Aft cabin cluster', note: 'Quieter corridor, wake views. Your room 6650 nearby.', x: 78, y: 58, highlight: true },
          { id: 'midship-elevators', title: 'Midship elevators', note: 'Fastest transfer to dining & promenade.', x: 52, y: 50 },
          { id: 'forward-stairs', title: 'Forward stairs', note: 'Best route to theater and deck 4.', x: 26, y: 43 }
        ],
        12: [
          { id: 'main-pool', title: 'Main pool', note: 'Live music, pool games, bar.', x: 40, y: 60 },
          { id: 'solarium', title: 'Solarium', note: 'Adults-only oasis, indoor pool.', x: 70, y: 30, highlight: true },
          { id: 'windjammer', title: 'Windjammer Cafe', note: 'Casual buffet, ocean view.', x: 20, y: 70 }
        ],
        11: [
          { id: 'spa', title: 'Vitality Spa', note: 'Thermal suite, massages.', x: 48, y: 44 },
          { id: 'fitness', title: 'Fitness Center', note: 'Panoramic treadmills.', x: 30, y: 55 }
        ],
        5: [
          { id: 'cafe-promenade', title: 'Cafe Promenade', note: 'Coffee + sandwiches, good regroup spot.', x: 55, y: 48 },
          { id: 'guest-services', title: 'Guest Services', note: 'Help desk, questions, changes.', x: 48, y: 60 }
        ],
        4: [
          { id: 'main-dining', title: 'Main Dining Room', note: 'Two-level elegant dining.', x: 40, y: 40 },
          { id: 'royal-theater', title: 'Royal Theater', note: 'Broadway-style shows.', x: 65, y: 60 }
        ]
      };

      const deckFocusMap = {
        12: ['Main Pool', 'Solarium', 'Windjammer'],
        11: ['Vitality Spa', 'Fitness Center'],
        5:  ['Cafe Promenade', 'Guest Services'],
        4:  ['Main Dining', 'Royal Theater'],
        6:  ['Room 6650', 'Midship Elevators']
      };

      // ----- STATE -----
      const state = {
        filter: 'all',
        search: '',
        currentDeck: null,
        currentZoom: 100,
        panHintShown: sessionStorage.getItem('deck_pan_hint_shown') === '1',
        lastFocusEl: null
      };

      const els = {
        search: document.getElementById('deckSearch'),
        quickRail: document.getElementById('deckQuickRail'),
        cards: document.getElementById('deckCards'),
        empty: document.getElementById('emptyState'),
        clearFilters: document.getElementById('clearFilters'),
        categoryToggle: document.getElementById('toggleCategoryBrowse'),
        categoryPanels: document.getElementById('deckCategoryPanels'),
        modal: document.getElementById('deckModal'),
        modalFrame: document.getElementById('modalFrame'),
        modalTitle: document.getElementById('modalTitle'),
        modalDesc: document.getElementById('modalDesc'),
        modalFocusChips: document.getElementById('deckFocusChips'),
        panHint: document.getElementById('deckPanHint'),
        zoomLevel: document.getElementById('zoomLevel'),
        download: document.getElementById('downloadPlan')
      };

      // ----- HELPERS -----
      function getDeckImage(number) {
        if (number === 0) return 'decks/deck-all.svg';
        return `decks/deck-${String(number).padStart(2, '0')}.png`;
      }

      function normalize(str) {
        return (str || '').toLowerCase();
      }

      function clamp(v, lo, hi) {
        return Math.min(hi, Math.max(lo, v));
      }

      // ----- RENDER -----
      function renderQuickRail() {
        const sorted = [...deckData].sort((a,b) => b.number - a.number);
        els.quickRail.innerHTML = sorted.map(d => `
          <button class="deck-quickbtn" data-deck="${d.number}" type="button" aria-label="Open ${d.name}">
            <span class="deck-quickbtn__num">${d.number === 0 ? 'ALL' : `D${d.number}`}</span>
            <span class="deck-quickbtn__sub">${d.subtitle}</span>
          </button>
        `).join('');
      }

      function renderPills() {
        const cats = { entertainment: [], wellness: [], essential: [] };
        deckData.forEach(d => { if (cats[d.category]) cats[d.category].push(d); });
        Object.entries(cats).forEach(([key, decks]) => {
          const host = document.getElementById(`pill-${key}`);
          if (!host) return;
          host.innerHTML = decks.map(d => `
            <button class="deck-pill" type="button" data-deck="${d.number}" aria-label="Open ${d.name}">
              <span class="deck-pill__number">${d.number === 0 ? 'ALL' : d.number}</span>
              <span class="deck-pill__text">${d.subtitle}</span>
            </button>
          `).join('');
        });
      }

      function renderDeckCards(filter = 'all', search = '') {
        els.cards.innerHTML = '';
        const needle = normalize(search.trim());

        const filtered = deckData.filter(d => {
          const matchesCategory = (filter === 'all' || d.category === filter);
          if (!matchesCategory) return false;

          if (!needle) return true;
          const hay = [
            d.name,
            d.subtitle,
            (d.highlights || []).join(' ')
          ].join(' ');
          return normalize(hay).includes(needle);
        });

        filtered.forEach(deck => {
          const card = document.createElement('article');
          card.className = 'deck-card';
          card.dataset.deck = deck.number;
          card.tabIndex = 0;
          card.setAttribute('role', 'listitem');
          card.setAttribute('aria-label', `Open ${deck.name}`);

          card.innerHTML = `
            <div class="deck-visual">
              <span class="deck-number">${deck.number === 0 ? 'ALL' : deck.number}</span>
              <img src="${getDeckImage(deck.number)}" alt="${deck.name}" loading="lazy" decoding="async">
            </div>
            <div class="deck-info">
              <h3 class="deck-title">${deck.name}</h3>
              <p class="deck-subtitle">${deck.subtitle}</p>
              <div class="deck-highlights">
                ${(deck.highlights || []).map(h => `<span>${h}</span>`).join('')}
              </div>
            </div>
          `;
          els.cards.appendChild(card);
        });

        els.empty.hidden = filtered.length !== 0;
      }

      // ----- MODAL / ZOOM / PAN -----
      function setActiveDeck(num) {
        document.querySelectorAll('.deck-quickbtn').forEach(b => b.classList.toggle('is-active', Number(b.dataset.deck) === num));
        document.querySelectorAll('.deck-pill').forEach(b => b.classList.toggle('is-active', Number(b.dataset.deck) === num));
      }

      function setZoom(nextZoom) {
        state.currentZoom = clamp(nextZoom, 50, 300);
        els.zoomLevel.textContent = `${state.currentZoom}

      function zoomFit() {
        const stage = document.getElementById('deckPlanStage');
        const img = document.querySelector('.deck-plan-media');
        if (!stage || !img) return;
        const iw = img.naturalWidth || img.width || 1;
        const ih = img.naturalHeight || img.height || 1;
        const sw = stage.clientWidth - 16;
        const sh = stage.clientHeight - 16;
        const fit = Math.min(sw / iw, sh / ih);
        const pct = Math.max(50, Math.min(140, Math.round(fit * 100)));
        setZoom(pct);
        // center
        requestAnimationFrame(() => {
          const canvas = document.getElementById('deckPlanCanvas');
          if (!canvas) return;
          const cw = iw * (state.currentZoom/100);
          const ch = ih * (state.currentZoom/100);
          stage.scrollLeft = Math.max(0, (cw - stage.clientWidth) / 2);
          stage.scrollTop  = Math.max(0, (ch - stage.clientHeight) / 2);
        });
      }
%`;

        const canvas = document.getElementById('deckPlanCanvas');
        if (canvas) canvas.style.transform = `scale(${(state.currentZoom/100).toFixed(2)})`;

        if (state.currentZoom > 100 && !state.panHintShown) {
          togglePanHint(true);
          state.panHintShown = true;
          sessionStorage.setItem('deck_pan_hint_shown', '1');
          setTimeout(() => togglePanHint(false), 2400);
        }
      }

      function togglePanHint(show) {
        if (!els.panHint) return;
        if (show) {
          els.panHint.hidden = false;
          requestAnimationFrame(() => els.panHint.classList.add('is-visible'));
        } else {
          els.panHint.classList.remove('is-visible');
          setTimeout(() => {
            if (!els.panHint.classList.contains('is-visible')) els.panHint.hidden = true;
          }, 220);
        }
      }

      function attachPan() {
        const stage = document.getElementById('deckPlanStage');
        if (!stage) return;

        // Prevent double-binding when modal content re-renders
        if (stage.dataset.gestureBound === '1') return;
        stage.dataset.gestureBound = '1';

        // --- Drag-to-pan (when zoomed) ---
        let dragging = false;
        let startX = 0, startY = 0, left = 0, top = 0;

        stage.addEventListener('pointerdown', (e) => {
          if (state.currentZoom <= 100) return;
          dragging = true;
          startX = e.clientX;
          startY = e.clientY;
          left = stage.scrollLeft;
          top = stage.scrollTop;
          stage.setPointerCapture(e.pointerId);
          stage.classList.add('is-dragging');
        });

        stage.addEventListener('pointermove', (e) => {
          if (!dragging) return;
          stage.scrollLeft = left - (e.clientX - startX);
          stage.scrollTop  = top  - (e.clientY - startY);
        });

        stage.addEventListener('pointerup', () => { dragging = false; stage.classList.remove('is-dragging'); });
        stage.addEventListener('pointercancel', () => { dragging = false; stage.classList.remove('is-dragging'); });

        // --- Wheel zoom (desktop) ---
        stage.addEventListener('wheel', (e) => {
          if (!e.ctrlKey && Math.abs(e.deltaY) < 1) return;
          e.preventDefault();
          const dir = e.deltaY > 0 ? -1 : 1;
          setZoom(state.currentZoom + dir * 12);
        }, { passive: false });

        // --- Double-tap / double-click toggle zoom ---
        let lastTap = 0;
        stage.addEventListener('pointerup', (e) => {
          const now = performance.now();
          if (now - lastTap < 260) {
            // toggle
            const next = state.currentZoom <= 110 ? 200 : 100;
            setZoom(next);
          }
          lastTap = now;
        });

        // --- Lightweight pinch zoom (touch) ---
        const pointers = new Map();
        let startDist = 0;
        let startZoom = 100;

        function dist(a, b) {
          const dx = a.clientX - b.clientX;
          const dy = a.clientY - b.clientY;
          return Math.hypot(dx, dy);
        }

        stage.addEventListener('pointerdown', (e) => {
          pointers.set(e.pointerId, e);
          if (pointers.size === 2) {
            const [p1, p2] = [...pointers.values()];
            startDist = dist(p1, p2);
            startZoom = state.currentZoom;
          }
        }, { passive: true });

        stage.addEventListener('pointermove', (e) => {
          if (!pointers.has(e.pointerId)) return;
          pointers.set(e.pointerId, e);
          if (pointers.size !== 2) return;
          const [p1, p2] = [...pointers.values()];
          const d = dist(p1, p2);
          if (!startDist) return;
          const ratio = d / startDist;
          setZoom(Math.round(startZoom * ratio));
        }, { passive: true });

        stage.addEventListener('pointerup', (e) => pointers.delete(e.pointerId), { passive: true });
        stage.addEventListener('pointercancel', (e) => pointers.delete(e.pointerId), { passive: true });
      }
        stage.addEventListener('pointerup', endDrag);
        stage.addEventListener('pointercancel', endDrag);
        stage.addEventListener('pointerleave', () => { /* avoid stuck grab */ if (dragging) endDrag(); });
      }

      function selectHotspotById(id) {
        const btn = els.modalFrame.querySelector(`.deck-hotspot[data-hotspot-id="${id}"]`);
        if (!btn) return;

        els.modalFrame.querySelectorAll('.deck-hotspot').forEach(b => {
          b.dataset.selected = (b.dataset.hotspotId === id) ? 'true' : 'false';
        });
        els.modalFrame.querySelectorAll('.deck-plan-legend-item').forEach(b => {
          b.classList.toggle('is-active', b.dataset.hotspotId === id);
        });

        els.modalDesc.textContent = btn.dataset.note || '';
        btn.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' });
      }

      function renderModalPlan(deck) {
        els.modalFrame.innerHTML = `<div class="deck-plan-skeleton" aria-hidden="true">Loading deck…</div>`;

        setTimeout(() => {
          const hotspots = deckHotspots[deck.number] || [];
          const chips = deckFocusMap[deck.number] || [];

          els.modalFocusChips.innerHTML = chips.map(label => `<button class="deck-focuschip" type="button">${label}</button>`).join('');

          const hotspotButtons = hotspots.map((s,i) => `
            <button class="deck-hotspot"
              type="button"
              style="left:${s.x}%; top:${s.y}%;"
              data-hotspot-id="${s.id}"
              data-title="${s.title}"
              data-note="${s.note}"
              data-highlight="${s.highlight ? 'true' : 'false'}"
              aria-label="${s.title}">
              ${i+1}
            </button>
          `).join('');

          els.modalFrame.innerHTML = `
            <div class="deck-plan-stage" id="deckPlanStage" aria-label="Deck plan viewer">
              <div class="deck-plan-canvas" id="deckPlanCanvas" style="transform:scale(${(state.currentZoom/100).toFixed(2)});">
                <img class="deck-plan-media" src="${deck.svg || ''}" alt="${deck.name}">
                ${hotspots.length ? `<div class="deck-plan-hotspots">${hotspotButtons}</div>` : ''}
              </div>
            </div>
            ${hotspots.length ? `
              <div class="deck-plan-legend" aria-label="Hotspot list">
                ${hotspots.map((s,i)=>`
                  <button class="deck-plan-legend-item" type="button" data-hotspot-id="${s.id}">
                    <strong>${i+1}. ${s.title}</strong>
                    <span>${s.note}</span>
                  </button>
                `).join('')}
              </div>
            ` : ''}
          `;

          attachPan();

          const img = document.getElementById('deckPlanMedia');
          if (img) {
            img.addEventListener('load', () => {
              // Fit on first open per deck unless user already zoomed
              if (state.currentZoom === 100) zoomFit();
            }, { once: true });
          }
          setZoom(state.currentZoom); // re-apply transform safely
        }, 140);
      }

      function openModal(deck) {
        state.currentDeck = deck;
        setActiveDeck(deck.number);

        state.lastFocusEl = document.activeElement;

        els.modalTitle.textContent = deck.name;
        els.modalDesc.textContent = deck.description || '';
        renderModalPlan(deck);

        if (deck.pdf) {
          els.download.href = deck.pdf;
          els.download.setAttribute('aria-disabled', 'false');
        } else {
          els.download.href = '#';
          els.download.setAttribute('aria-disabled', 'true');
        }

        document.body.classList.add('is-modal-open');
        els.modal.classList.add('is-open');
        els.modal.setAttribute('aria-hidden', 'false');

        setZoom(100);

        // focus close button for keyboard users
        const closeBtn = els.modal.querySelector('.close-btn');
        if (closeBtn) closeBtn.focus({ preventScroll: true });
      }

      function closeModal() {
        els.modal.classList.remove('is-open');
        els.modal.setAttribute('aria-hidden', 'true');
        document.body.classList.remove('is-modal-open');
        togglePanHint(false);

        if (state.lastFocusEl && typeof state.lastFocusEl.focus === 'function') {
          state.lastFocusEl.focus({ preventScroll: true });
        }
      }

      // ----- EVENTS -----
      function bindEvents() {
        // Filter pills
        document.querySelectorAll('.pill-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            document.querySelectorAll('.pill-btn').forEach(b => b.classList.remove('is-active'));
            btn.classList.add('is-active');
            state.filter = btn.dataset.filter || 'all';
            renderDeckCards(state.filter, els.search.value);
          });
        });

        // Search
        els.search.addEventListener('input', (e) => {
          renderDeckCards(document.querySelector('.pill-btn.is-active')?.dataset.filter || 'all', e.target.value);
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
          if (e.key === '/' && document.activeElement !== els.search) {
            e.preventDefault();
            els.search.focus();
          }
          if (e.key === 'Escape' && els.modal.classList.contains('is-open')) {
            e.preventDefault();
            closeModal();
          }
        });

        // Cards open (click)
        els.cards.addEventListener('click', (e) => {
          const card = e.target.closest('.deck-card');
          if (!card) return;
          const deck = deckData.find(d => d.number === Number(card.dataset.deck));
          if (deck) openModal(deck);
        });

        // Cards open (keyboard)
        els.cards.addEventListener('keydown', (e) => {
          const card = e.target.closest('.deck-card');
          if (!card) return;
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            const deck = deckData.find(d => d.number === Number(card.dataset.deck));
            if (deck) openModal(deck);
          }
        });

        // Quick rail
        els.quickRail.addEventListener('click', (e) => {
          const btn = e.target.closest('.deck-quickbtn');
          if (!btn) return;
          const deck = deckData.find(d => d.number === Number(btn.dataset.deck));
          if (deck) openModal(deck);
        });

        // Category pills (delegated)
        document.addEventListener('click', (e) => {
          const pill = e.target.closest('.deck-pill');
          if (!pill) return;
          const deck = deckData.find(d => d.number === Number(pill.dataset.deck));
          if (deck) openModal(deck);
        });

        // Clear filters
        els.clearFilters?.addEventListener('click', () => {
          state.search = '';
          els.search.value = '';
          state.filter = 'all';
          document.querySelectorAll('.pill-btn').forEach(b => b.classList.toggle('is-active', b.dataset.filter === 'all'));
          renderDeckCards('all', '');
        });

        // Category toggle (FIXED)
        if (els.categoryToggle && els.categoryPanels) {
          els.categoryToggle.addEventListener('click', () => {
            const expanded = els.categoryToggle.getAttribute('aria-expanded') === 'true';
            const next = !expanded;
            els.categoryToggle.setAttribute('aria-expanded', String(next));
            els.categoryPanels.hidden = !next;
            els.categoryToggle.innerHTML = `${next ? 'Hide' : 'Show'} <i class="fas fa-chevron-down" aria-hidden="true"></i>`;
          });
        }

        // Modal actions
        els.modal.addEventListener('click', (e) => {
          // hotspots
          const hotspot = e.target.closest('.deck-hotspot');
          if (hotspot) { selectHotspotById(hotspot.dataset.hotspotId); return; }

          // legend
          const legend = e.target.closest('.deck-plan-legend-item');
          if (legend) { selectHotspotById(legend.dataset.hotspotId); return; }

          // focus chip
          const chip = e.target.closest('.deck-focuschip');
          if (chip) {
            els.modalFocusChips.querySelectorAll('.deck-focuschip').forEach(b => b.classList.remove('is-active'));
            chip.classList.add('is-active');
            const needle = normalize(chip.textContent);
            const match = [...els.modalFrame.querySelectorAll('.deck-hotspot')]
              .find(b => normalize(b.dataset.title).includes(needle));
            if (match) selectHotspotById(match.dataset.hotspotId);
            return;
          }

          // actions
          const act = e.target.closest('[data-action]')?.dataset.action;
          if (!act) return;

          if (act === 'close-modal') closeModal();
          if (act === 'zoom-in') setZoom(state.currentZoom + 25);
          if (act === 'zoom-out') setZoom(state.currentZoom - 25);
          if (act === 'zoom-reset') setZoom(100);
          if (act === 'zoom-fit') zoomFit();

          if (act === 'prev-deck') {
            const sorted = deckData.filter(d => d.number !== 0).sort((a,b)=>a.number-b.number);
            const idx = sorted.findIndex(d => d.number === state.currentDeck?.number);
            if (idx > 0) openModal(sorted[idx - 1]);
          }
          if (act === 'next-deck') {
            const sorted = deckData.filter(d => d.number !== 0).sort((a,b)=>a.number-b.number);
            const idx = sorted.findIndex(d => d.number === state.currentDeck?.number);
            if (idx >= 0 && idx < sorted.length - 1) openModal(sorted[idx + 1]);
          }

          if (act === 'center-me' && state.currentDeck?.number === 6) {
            const target = els.modalFrame.querySelector('.deck-hotspot[data-hotspot-id="aft-cabins"]');
            if (target) target.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' });
          }
        });

        // Click outside dialog closes (backdrop already does it; this protects taps on empty padding)
        els.modal.addEventListener('mousedown', (e) => {
          const dialog = e.target.closest('.deck-modal__dialog');
          if (!dialog && els.modal.classList.contains('is-open')) closeModal();
        });
      }

      function init() {
        renderQuickRail();
        renderPills();
        renderDeckCards();
        bindEvents();

        // Friendly auto-nudge to deck 6 on small screens (subtle)
        if (window.matchMedia('(max-width: 900px)').matches) {
          setTimeout(() => {
            const btn = document.querySelector('.deck-quickbtn[data-deck="6"]');
            if (btn) btn.scrollIntoView({ inline: 'center', behavior: 'smooth' });
          }, 240);
        }
      }

      init();
    })();
  </script>


<div id="sharedBottomNav">
        <nav class="bottom-nav" aria-label="Bottom navigation">
          
          <a href="index.html" class="bottom-nav__item " data-nav="home">
            <i class="fas fa-home" aria-hidden="true"></i>
            <span>Home</span>
          </a>
        
          <a href="plan.html" class="bottom-nav__item " data-nav="plan">
            <i class="fas fa-compass" aria-hidden="true"></i>
            <span>Plan</span>
          </a>
        
          <a href="itinerary.html#today" class="bottom-nav__item " data-nav="today">
            <i class="fas fa-calendar-day" aria-hidden="true"></i>
            <span>Today</span>
          </a>
        
          <a href="decks.html" class="bottom-nav__item active" data-nav="map" aria-current="page">
            <i class="fas fa-ship" aria-hidden="true"></i>
            <span>Map</span>
          </a>
        
            <button type="button" id="moreBtnMobile" class="bottom-nav__item bottom-nav__item--more" data-nav="more" data-bottom-action="open-more-drawer" aria-haspopup="dialog" aria-expanded="false" aria-controls="moreDrawer">
              <i class="fas fa-ellipsis" aria-hidden="true"></i>
              <span>More</span>
            </button>
          
        </nav>
      </div><div class="more-drawer-backdrop" id="moreDrawerBackdrop" hidden=""></div><aside class="more-drawer" id="moreDrawer" role="dialog" aria-modal="true" aria-label="More menu" hidden="">
            <div class="more-drawer__header">
              <h2>More</h2>
              <button type="button" class="more-drawer__close" id="moreDrawerClose" aria-label="Close menu">
                <i class="fas fa-times" aria-hidden="true"></i>
              </button>
            </div>
            
          <section class="more-drawer__group" aria-label="Explore">
            <h3 class="more-drawer__group-title">Explore</h3>
            <div class="more-drawer__group-links">
          <a href="ports.html" class="more-drawer__link ">
            <i class="fas fa-map-location-dot" aria-hidden="true"></i>
            <span>Ports</span>
          </a>
        
          <a href="tips.html" class="more-drawer__link ">
            <i class="fas fa-lightbulb" aria-hidden="true"></i>
            <span>Pro Moves</span>
          </a>
        
          <a href="photos.html" class="more-drawer__link ">
            <i class="fas fa-images" aria-hidden="true"></i>
            <span>Photos</span>
          </a>
        </div>
          </section>
        
          <section class="more-drawer__group" aria-label="Utility">
            <h3 class="more-drawer__group-title">Utility</h3>
            <div class="more-drawer__group-links">
          <a href="operations.html" class="more-drawer__link ">
            <i class="fas fa-clipboard-check" aria-hidden="true"></i>
            <span>Checklist</span>
          </a>
        
          <a href="contacts.html" class="more-drawer__link ">
            <i class="fas fa-phone-volume" aria-hidden="true"></i>
            <span>Contacts</span>
          </a>
        
          <a href="offline.html" class="more-drawer__link ">
            <i class="fas fa-wifi" aria-hidden="true"></i>
            <span>Offline</span>
          </a>
        </div>
          </section>
        
          </aside></body></html>
