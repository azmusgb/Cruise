<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0079d4">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="manifest" href="manifest.json?v=2">
    <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
  <link rel="icon" type="image/svg+xml" href="icons/icon-192.svg">
    <title>Staterooms | Adventure of the Seas</title>
    <meta name="description" content="View your stateroom assignments, deck locations, and quick actions in a clean, light interface.">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/base.css?v=3">
  <link rel="stylesheet" href="css/utilities.css?v=3">
  <link rel="stylesheet" href="css/components.css?v=3">
    <link rel="stylesheet" href="css/feature-modules.css?v=3">
    <script src="js/shared-layout.js?v=16" defer></script>
    
    <style>
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--royal-blue);
            color: white;
            padding: 8px 16px;
            border-radius: var(--radius-sm);
            text-decoration: none;
            z-index: 1000;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 10px;
        }

        /* Hero Section */
        .hero--rooms {
            background: var(--ocean-gradient);
            padding: 60px 0 40px;
            position: relative;
            overflow: hidden;
            margin-bottom: 32px;
        }

        .hero--rooms::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(255, 255, 255, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 40%);
            pointer-events: none;
        }

        .hero__content {
            position: relative;
            z-index: 1;
        }

        .hero__eyebrow {
            display: inline-block;
            font-size: 0.9rem;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 12px;
            letter-spacing: 0.5px;
        }

        .hero__title {
            font-size: 2.8rem;
            font-weight: 800;
            color: white;
            margin-bottom: 16px;
            line-height: 1.2;
        }

        .hero__description {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.9);
            max-width: 600px;
            margin-bottom: 28px;
        }

        .hero__highlights {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 0 0 22px;
        }

        .hero__tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 12px;
            border-radius: 999px;
            font-size: 0.82rem;
            font-weight: 700;
            color: #fff;
            background: rgba(255, 255, 255, 0.18);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 18px rgba(7, 43, 83, 0.18);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
        }

        .hero__tag i {
            font-size: 0.78rem;
        }

        .hero__actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        /* Navigation Bar */
        .nav-bar {
            background: white;
            border-bottom: 1px solid var(--royal-border);
            padding: 16px 0;
            margin-bottom: 32px;
        }

        .nav-bar__inner {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 200px;
            max-width: 400px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 14px 20px 14px 48px;
            border: 1px solid var(--royal-border);
            border-radius: var(--radius-lg);
            background: var(--royal-foam);
            color: var(--royal-ink);
            font-family: 'Inter', sans-serif;
            font-size: 0.95rem;
            transition: var(--transition-smooth);
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--royal-sky);
            box-shadow: 0 0 0 3px rgba(0, 168, 232, 0.1);
        }

        .search-box i {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--royal-blue);
            opacity: 0.7;
        }

        .nav-filters {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 20px;
            border-radius: var(--radius-lg);
            background: var(--royal-foam);
            color: var(--royal-navy);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.9rem;
            border: 1px solid var(--royal-border);
            transition: var(--transition-smooth);
            white-space: nowrap;
        }

        .filter-btn:hover {
            background: #d9ebfb;
            transform: translateY(-2px);
        }

        .filter-btn--active {
            background: linear-gradient(135deg, var(--royal-blue), var(--royal-sky));
            color: white;
            border-color: var(--royal-sky);
        }

        /* Stats Overview */
        .stats-section {
            margin-bottom: 40px;
        }

        .stats-grid {
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        }

        .stat-card {
            padding: 24px;
        }

        .stat-card__title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
            color: var(--royal-ink);
            margin-bottom: 16px;
            opacity: 0.9;
        }

        .stat-card__content {
            display: flex;
            align-items: baseline;
            gap: 12px;
        }

        .stat-value {
            font-size: 2.8rem;
            font-weight: 800;
            color: var(--royal-blue);
            line-height: 1;
            font-family: 'Montserrat', sans-serif;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--royal-ink);
            opacity: 0.8;
        }

        /* Rooms Grid */
        .rooms-section {
            margin-bottom: 60px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 28px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .section-title {
            font-size: 2rem;
            color: var(--royal-navy);
        }

        .section-subtitle {
            color: var(--royal-ink);
            opacity: 0.8;
            margin-top: 4px;
        }

        .rooms-count {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--royal-foam);
            padding: 8px 16px;
            border-radius: var(--radius-full);
            border: 1px solid var(--royal-border);
            font-weight: 600;
            color: var(--royal-blue);
        }

        .rooms-count__number {
            background: linear-gradient(135deg, var(--royal-blue), var(--royal-sky));
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: 700;
        }

        .rooms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 24px;
        }

        .focus-section {
            margin-bottom: 28px;
        }

        .focus-section__header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            gap: 12px;
            margin-bottom: 14px;
            flex-wrap: wrap;
        }

        .focus-section__title {
            margin: 0;
            font-size: 1.2rem;
            color: var(--royal-navy);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .focus-section__subtitle {
            margin: 0;
            font-size: 0.9rem;
            color: var(--royal-ink);
            opacity: 0.85;
        }

        .focus-section--secondary .room-card {
            opacity: 0.9;
        }

        .room-card {
            background: #ffffff;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.02);
            border: 1px solid rgba(0, 80, 140, 0.08);
            transition: box-shadow 0.25s ease, transform 0.2s ease;
            display: flex;
            flex-direction: column;
        }

        .room-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 18px rgba(0, 0, 0, 0.05);
            border-color: rgba(0, 110, 200, 0.2);
        }

        .room-card:active {
            transform: scale(0.99);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.02);
        }

        .room-card__status-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 14px 24px 0;
            margin-bottom: -4px;
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.74rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.02em;
            border: 1px solid rgba(0, 0, 0, 0.05);
            background: #f4f7fb;
        }

        .status-badge--warning {
            background: #ffebee;
            color: #b71c1c;
        }

        .status-badge--info {
            background: #e3f2fd;
            color: #0d47a1;
        }

        .status-badge--success {
            background: #e8f5e9;
            color: #1b5e20;
        }

        .room-card__header {
            padding: 24px 24px 0;
            position: relative;
        }

        .room-number {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--royal-blue), var(--royal-sky));
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1rem;
            box-shadow: var(--shadow-light);
        }

        .room-type {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .room-type__icon {
            width: 40px;
            height: 40px;
            background: var(--royal-foam);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--royal-blue);
            font-size: 1.2rem;
        }

        .room-type__name {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--royal-navy);
        }

        .room-location {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: var(--royal-foam);
            padding: 6px 12px;
            border-radius: var(--radius-full);
            font-size: 0.9rem;
            color: var(--royal-blue);
            margin-top: 8px;
        }

        .room-card__preview {
            height: 180px;
            background: linear-gradient(135deg, #e8f4ff, #d4e9ff);
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--royal-blue);
            opacity: 0.8;
            font-size: 0.9rem;
        }

        .room-card__content {
            padding: 0 24px 24px;
            flex: 1;
        }

        .room-features {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .feature-tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: #ffffff;
            border: 1px solid rgba(0, 80, 140, 0.1);
            border-radius: 40px;
            font-size: 0.85rem;
            color: #1e3b5c;
        }

        .feature-tag i {
            color: var(--royal-blue);
            font-size: 0.9rem;
        }

        .room-card__actions {
            margin-top: auto;
            padding-top: 20px;
            border-top: 1px solid var(--royal-border-light);
            display: grid;
            gap: 8px;
        }

        .compare-toggle-btn {
            width: 100%;
            min-height: 40px;
            border-radius: var(--radius-md);
            border: 1px dashed rgba(0, 121, 212, 0.4);
            background: #f7fbff;
            color: var(--royal-navy);
            font-weight: 700;
            font-size: 0.86rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
        }

        .compare-toggle-btn.is-active {
            background: #e3f2fd;
            border-style: solid;
            border-color: rgba(0, 121, 212, 0.65);
        }

        .view-deck-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 12px 16px;
            background: var(--royal-foam);
            color: var(--royal-navy);
            text-decoration: none;
            border-radius: var(--radius-md);
            font-weight: 700;
            font-size: 0.95rem;
            transition: var(--transition-smooth);
            border: 1px solid rgba(10, 96, 166, 0.22);
            cursor: pointer;
        }

        .view-deck-btn:hover {
            background: #e7f3ff;
            border-color: rgba(10, 96, 166, 0.4);
        }

        .room-details-btn {
            width: 100%;
            min-height: 44px;
            border: 1px solid transparent;
            border-radius: var(--radius-md);
            background: linear-gradient(135deg, var(--royal-blue), var(--royal-sky));
            color: #ffffff;
            font-weight: 700;
            font-size: 0.92rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .room-details-btn:hover,
        .room-details-btn:focus-visible {
            filter: brightness(1.03);
            outline: none;
        }

        /* Quick Actions */
        .quick-actions {
            background: white;
            border-radius: var(--radius-xl);
            padding: 32px;
            margin-bottom: 60px;
            box-shadow: var(--shadow-light);
            border: 1px solid var(--royal-border);
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 24px;
        }

        .action-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 20px;
            background: var(--royal-foam);
            border-radius: var(--radius-lg);
            text-decoration: none;
            color: var(--royal-ink);
            transition: var(--transition-smooth);
            border: 1px solid var(--royal-border);
        }

        .action-item:hover {
            background: white;
            transform: translateY(-2px);
            border-color: var(--royal-sky);
            box-shadow: var(--shadow-light);
        }

        .action-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--royal-blue), var(--royal-sky));
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
        }

        .action-content h4 {
            font-size: 1.1rem;
            margin-bottom: 4px;
            color: var(--royal-navy);
        }

        .action-content p {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* Modal for Room Details */
        .room-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .room-modal--open {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 28px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-floating);
        }

        .comparison-rail {
            position: fixed;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 70;
            background: #fff;
            border-top: 1px solid var(--royal-border);
            border-top-left-radius: 22px;
            border-top-right-radius: 22px;
            box-shadow: 0 -8px 30px rgba(0, 0, 0, 0.12);
            padding: 16px;
            max-height: 50vh;
            overflow-y: auto;
        }

        .comparison-rail__header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .comparison-rail__header h3 {
            margin: 0;
            font-size: 1rem;
            color: var(--royal-navy);
        }

        .comparison-grid {
            display: grid;
            gap: 10px;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        }

        .comparison-column {
            border: 1px solid var(--royal-border);
            border-radius: var(--radius-md);
            background: #f9fcff;
            padding: 10px 12px;
        }

        .comparison-column h4 {
            margin: 0 0 8px;
            color: var(--royal-navy);
        }

        .comparison-list {
            margin: 0;
            padding: 0;
            list-style: none;
            display: grid;
            gap: 6px;
            font-size: 0.88rem;
        }

        .comparison-list span {
            font-weight: 700;
            color: var(--royal-blue);
        }

        .keyboard-hint {
            position: fixed;
            right: 14px;
            bottom: 14px;
            z-index: 65;
            background: rgba(6, 27, 54, 0.92);
            color: #fff;
            border-radius: 12px;
            padding: 8px 10px;
            font-size: 0.78rem;
            box-shadow: 0 8px 22px rgba(6, 27, 54, 0.3);
        }

        .keyboard-hint kbd {
            background: rgba(255, 255, 255, 0.16);
            border: 1px solid rgba(255, 255, 255, 0.24);
            border-radius: 5px;
            padding: 1px 5px;
            font-family: inherit;
            font-size: 0.74rem;
        }

        .modal-header {
            padding: 24px 24px 8px;
            border-bottom: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Design Refresh Overrides */
        .nav-bar {
            border: 1px solid var(--royal-border);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-light);
            padding: 20px 0;
            margin-bottom: 28px;
            background: linear-gradient(180deg, #ffffff 0%, #f8fcff 100%);
        }

        .nav-bar__inner {
            gap: 16px;
        }

        .nav-heading {
            width: 100%;
            border-bottom: 1px solid var(--royal-border-light);
            padding-bottom: 12px;
        }

        .nav-heading__title {
            margin-bottom: 2px;
            font-size: 1.2rem;
            color: var(--royal-navy);
        }

        .nav-heading__subtitle {
            margin: 0;
            font-size: 0.95rem;
            color: var(--royal-ink);
            opacity: 0.82;
        }

        .nav-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
        }

        .search-box {
            flex: 1;
            min-width: 280px;
            max-width: 720px;
        }

        .search-box input {
            padding: 15px 20px 15px 50px;
            min-height: 52px;
            font-size: 1rem;
        }

        .filter-control {
            position: relative;
        }

        .filter-control .filter-btn {
            min-height: 52px;
            padding: 0 18px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .filter-panel {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            display: none;
            min-width: 200px;
            background: #fff;
            border: 1px solid var(--royal-border);
            border-radius: var(--radius-md);
            padding: 8px;
            box-shadow: var(--shadow-medium);
            z-index: 20;
        }

        .filter-panel.is-open {
            display: grid;
            gap: 6px;
        }

        .room-type-filter {
            text-align: left;
            padding: 10px 12px;
            border-radius: var(--radius-md);
            border: 1px solid transparent;
            background: var(--royal-foam);
            color: var(--royal-ink);
            cursor: pointer;
            font-weight: 600;
        }

        .room-type-filter:hover,
        .room-type-filter:focus-visible,
        .room-type-filter.is-active {
            background: #d9ebfb;
            border-color: rgba(0, 168, 232, 0.35);
            outline: none;
        }

        .filter-link {
            min-height: 42px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .stats-grid {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            align-items: start;
        }

        .section-header--stacked {
            justify-content: flex-start;
            margin-bottom: 16px;
        }

        .stat-card {
            min-height: 178px;
        }

        .stat-chart {
            display: grid;
            gap: 10px;
            width: 100%;
        }

        .stat-chart__row {
            display: grid;
            grid-template-columns: 90px 1fr 42px;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
            color: var(--royal-ink);
        }

        .stat-chart__track {
            height: 10px;
            border-radius: var(--radius-full);
            background: #e8f1fb;
            overflow: hidden;
        }

        .stat-chart__fill {
            display: block;
            height: 100%;
            border-radius: inherit;
        }

        .stat-chart__fill--ocean {
            background: linear-gradient(90deg, #3f85d6, #00a8e8);
        }

        .stat-chart__fill--balcony {
            background: linear-gradient(90deg, #ffb454, #ff8f00);
        }

        .stat-chart__fill--interior {
            background: linear-gradient(90deg, #7f95b8, #6c7f9f);
        }

        .search-summary {
            margin: 0 0 18px;
            font-weight: 600;
            color: var(--royal-blue);
        }

        .rooms-grid {
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
            gap: 28px;
        }

        .room-card {
            border-left: 5px solid transparent;
        }

        .room-card--ocean-view {
            border-left-color: #00a8e8;
        }

        .room-card--balcony {
            border-left-color: #ffb400;
        }

        .room-card--interior {
            border-left-color: #6f84a6;
        }

        .room-card__header {
            padding: 28px 28px 0;
        }

        .room-card__content {
            padding: 0 28px 28px;
        }

        .room-category {
            display: inline-flex;
            align-items: center;
            font-size: 0.74rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--royal-navy);
            background: var(--royal-foam);
            border: 1px solid var(--royal-border);
            border-radius: var(--radius-full);
            padding: 4px 10px;
            margin-bottom: 10px;
        }

        .room-meta-details {
            opacity: 0.75;
            max-height: none;
            margin: 8px 0 12px;
            color: #3a5668;
            font-size: 0.9rem;
            font-style: italic;
            padding-left: 4px;
            border-left: 2px solid rgba(0, 110, 200, 0.2);
        }

        .room-card:hover .room-meta-details,
        .room-card:focus-within .room-meta-details {
            opacity: 0.75;
            margin: 8px 0 12px;
        }

        .quick-actions {
            padding: 28px;
        }

        .action-group {
            margin-top: 20px;
        }

        .action-group__title {
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            margin-bottom: 10px;
            color: var(--royal-blue);
        }

        .actions-grid {
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 18px;
            margin-top: 0;
        }

        .action-item {
            min-height: 86px;
            position: relative;
        }

        .action-icon {
            width: 52px;
            height: 52px;
            font-size: 1.4rem;
            flex: 0 0 auto;
        }

        .no-search-results {
            margin-top: 20px;
            padding: 14px 16px;
            border: 1px dashed var(--royal-border);
            border-radius: var(--radius-md);
            background: #fff;
            color: var(--royal-ink);
            text-align: center;
            font-weight: 600;
        }

        .room-modal {
            background: rgba(13, 37, 67, 0.42);
        }

        .modal-content {
            max-width: 430px;
            width: min(100%, 430px);
        }

        .modal-header {
            padding: 20px 24px 8px;
            border-bottom: none;
        }

        .modal-description {
            margin: 0;
            color: #5a6e7c;
            opacity: 1;
            padding: 0 24px 16px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            font-size: 0.95rem;
        }

        #modalTitle {
            font-size: 1.6rem;
            font-weight: 700;
            color: #003b5c;
            letter-spacing: -0.01em;
        }

        .mobile-stats-toggle {
            display: none;
        }

        .stats-grid-wrap {
            display: block;
        }

        /* Rooms-specific readability + scale tuning on top of shared theme */
        body.app-theme-rcc.rooms-page .room-card__header {
            background: linear-gradient(135deg, #f1f9ff 0%, #ffffff 100%) !important;
            border-bottom: 1px solid rgba(0, 120, 200, 0.08);
        }

        body.app-theme-rcc.rooms-page .room-number {
            display: none;
        }

        body.app-theme-rcc.rooms-page .room-type__icon {
            background: #ffffff;
            border: 1px solid rgba(0, 110, 200, 0.15);
            color: #0066b3;
            flex: 0 0 auto;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.02);
        }

        body.app-theme-rcc.rooms-page .room-type__name {
            color: #003b5c !important;
            text-shadow: none !important;
            font-size: 1.7rem;
            font-weight: 700;
            letter-spacing: -0.01em;
            line-height: 1.12;
        }

        body.app-theme-rcc.rooms-page .room-location {
            background: rgba(0, 110, 200, 0.04);
            color: #0066a0;
            border: 1px solid rgba(0, 110, 200, 0.1);
            font-weight: 600;
            font-size: 0.9rem;
            padding: 6px 14px;
        }

        body.app-theme-rcc.rooms-page .room-card__content {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        body.app-theme-rcc.rooms-page .room-card {
            position: relative;
            border: 1px solid rgba(0, 80, 140, 0.08);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.02);
            background: #ffffff;
        }

        body.app-theme-rcc.rooms-page .room-card::before {
            content: "";
            position: absolute;
            inset: 0;
            border-radius: inherit;
            pointer-events: none;
            background: linear-gradient(140deg, rgba(18, 132, 230, 0.08), rgba(255, 255, 255, 0) 40%);
        }

        body.app-theme-rcc.rooms-page .room-card:hover,
        body.app-theme-rcc.rooms-page .room-card:focus-within {
            transform: translateY(-3px);
            box-shadow: 0 10px 18px rgba(0, 0, 0, 0.05);
        }

        body.app-theme-rcc.rooms-page .feature-tag {
            padding: 6px 12px;
            min-height: 0;
            font-size: 0.85rem;
            font-weight: 500;
        }

        body.app-theme-rcc.rooms-page .feature-tag i.fa-user,
        body.app-theme-rcc.rooms-page .feature-tag i.fa-life-ring {
            color: #006bb3;
        }

        body.app-theme-rcc.rooms-page .feature-tag i.fa-id-badge,
        body.app-theme-rcc.rooms-page .feature-tag i.fa-ship {
            color: #6b7f8f;
            opacity: 0.8;
        }

        body.app-theme-rcc.rooms-page .feature-tag:has(.fa-user) {
            background: #f0f7ff;
            border-color: rgba(0, 110, 200, 0.2);
            font-weight: 600;
        }

        body.app-theme-rcc.rooms-page .guest-roster {
            display: grid;
            gap: 8px;
            margin-top: 2px;
            padding: 10px 12px;
            border: 1px solid rgba(11, 96, 166, 0.2);
            border-radius: 14px;
            background: linear-gradient(180deg, #f4faff 0%, #eaf5ff 100%);
        }

        body.app-theme-rcc.rooms-page .guest-roster__label {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin: 0;
            font-size: 0.78rem;
            font-weight: 800;
            letter-spacing: 0.09em;
            text-transform: uppercase;
            color: var(--royal-blue);
        }

        body.app-theme-rcc.rooms-page .guest-roster__list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            list-style: none;
            margin: 0;
            padding: 0;
        }

        body.app-theme-rcc.rooms-page .guest-pill {
            display: inline-flex;
            align-items: center;
            padding: 6px 14px;
            background: #f5f9ff;
            border-radius: 40px;
            color: #005c99;
            font-size: 0.9rem;
            font-weight: 600;
            border: 1px solid rgba(0, 100, 180, 0.08);
            line-height: 1;
        }

        body.app-theme-rcc.rooms-page .guest-pill::after {
            content: none;
        }

        body.app-theme-rcc.rooms-page .room-meta-details {
            color: #3a5668;
            font-size: 0.9rem;
            line-height: 1.45;
            margin: 8px 0 12px;
        }

        body.app-theme-rcc.rooms-page .view-deck-btn {
            min-height: 48px;
            font-size: 0.95rem;
        }

        .room-highlights-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 16px 0 20px;
        }

        .highlight-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: #f5f9ff;
            border-radius: 40px;
            color: #005c99;
            font-size: 0.95rem;
            font-weight: 600;
            border: 1px solid rgba(0, 100, 180, 0.1);
        }

        .modal-room-location {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 14px;
            border-radius: 999px;
            background: #f5f9ff;
            color: #005c99;
            border: 1px solid rgba(0, 100, 180, 0.1);
            font-weight: 600;
        }

        .modal-body-copy {
            color: #2a4a66;
            margin: 8px 0 0;
            font-size: 0.95rem;
            line-height: 1.45;
        }

        .modal-hint {
            color: #5a6e7c;
            margin: 8px 0 0;
            font-size: 0.86rem;
        }

        .modal-actions {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 24px;
        }

        .modal-primary-btn {
            background: #006bb3;
            color: #ffffff;
            padding: 16px;
            border-radius: 16px;
            font-weight: 700;
            font-size: 1.05rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            border: none;
            box-shadow: 0 6px 14px rgba(0, 107, 179, 0.2);
            text-decoration: none;
        }

        .modal-secondary-btn {
            background: #ffffff;
            color: #1e3b5c;
            padding: 14px;
            border-radius: 16px;
            font-weight: 600;
            font-size: 1rem;
            border: 1.5px solid rgba(0, 80, 140, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
        }

        .main a:focus-visible,
        .main button:focus-visible,
        .main input:focus-visible {
            outline: 3px solid rgba(0, 168, 232, 0.35);
            outline-offset: 2px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero--rooms {
                padding: 30px 0 16px;
                margin-bottom: 14px;
            }

            .hero__title {
                font-size: clamp(1.65rem, 7vw, 2rem);
            }

            .hero__description {
                margin-bottom: 0;
                font-size: 0.95rem;
                max-width: 100%;
            }

            .hero__eyebrow,
            .hero__highlights,
            .hero__actions,
            .page-spine {
                display: none;
            }
            
            .hero__actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .rooms-grid {
                grid-template-columns: 1fr;
                gap: 18px;
            }

            .focus-section {
                margin-bottom: 20px;
            }

            .focus-section__title {
                font-size: 1.02rem;
            }

            .focus-section__subtitle {
                font-size: 0.82rem;
            }
            
            .stat-value {
                font-size: 2.2rem;
            }
            
            .actions-grid {
                grid-template-columns: 1fr;
            }

            .nav-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .nav-heading {
                padding-bottom: 8px;
                margin-bottom: 2px;
            }

            .nav-heading__subtitle {
                display: none;
            }

            .search-box,
            .filter-control {
                max-width: 100%;
                width: 100%;
            }

            .search-box input {
                min-height: 54px;
                font-size: 16px;
                padding: 14px 16px 14px 46px;
            }

            .filter-control .filter-btn {
                width: 100%;
                justify-content: center;
                min-height: 52px;
            }

            .filter-panel {
                left: 0;
                right: 0;
            }

            .mobile-stats-toggle {
                display: inline-flex;
                align-items: center;
                gap: 8px;
            }

            .stats-grid-wrap {
                display: none;
            }

            .stats-grid-wrap.is-open {
                display: block;
            }

            .filter-link {
                min-height: 44px;
                justify-content: center;
            }

            body.app-theme-rcc.rooms-page .room-card {
                border-radius: 18px;
                box-shadow: 0 12px 26px rgba(6, 45, 83, 0.14);
            }

            body.app-theme-rcc.rooms-page .room-card__header {
                padding: 20px 18px 0;
            }

            body.app-theme-rcc.rooms-page .room-number {
                display: none;
            }

            body.app-theme-rcc.rooms-page .room-type__icon {
                width: 44px;
                height: 44px;
                font-size: 1.24rem;
            }

            body.app-theme-rcc.rooms-page .room-type__name {
                font-size: clamp(1.6rem, 8.2vw, 2rem);
            }

            body.app-theme-rcc.rooms-page .room-location {
                font-size: 1rem;
                min-height: 40px;
            }

            body.app-theme-rcc.rooms-page .room-card__content {
                padding: 0 18px 20px;
                gap: 10px;
            }

            body.app-theme-rcc.rooms-page .guest-roster {
                padding: 10px;
                border-radius: 12px;
            }

            body.app-theme-rcc.rooms-page .guest-roster__label {
                font-size: 0.75rem;
            }

            body.app-theme-rcc.rooms-page .room-features {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 10px;
                margin-bottom: 12px;
            }

            body.app-theme-rcc.rooms-page .feature-tag {
                width: 100%;
                min-height: 44px;
                padding: 10px 12px;
                font-size: 0.99rem;
            }

            body.app-theme-rcc.rooms-page .room-card__actions {
                padding-top: 14px;
            }

            .room-card__status-bar {
                padding: 12px 18px 0;
            }

            .status-badge {
                font-size: 0.7rem;
            }

            body.app-theme-rcc.rooms-page .view-deck-btn {
                min-height: 52px;
                font-size: 1.03rem;
                padding: 12px 14px;
            }

            body.app-theme-rcc.rooms-page .room-details-btn {
                min-height: 46px;
                border-color: transparent;
            }

            .quick-actions {
                padding: 20px 16px;
            }

            .action-item {
                min-height: 92px;
                padding: 16px;
            }

            .action-icon {
                width: 50px;
                height: 50px;
            }

            .action-content h4 {
                font-size: 1rem;
            }

            .action-content p {
                font-size: 0.92rem;
            }

            .comparison-rail {
                padding: 12px;
                border-top-left-radius: 16px;
                border-top-right-radius: 16px;
            }

            .keyboard-hint {
                left: 10px;
                right: 10px;
                bottom: 10px;
                font-size: 0.72rem;
            }
        }

        @media (max-width: 480px) {
            .hero__title {
                font-size: 1.8rem;
            }
            
            .section-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .rooms-count {
                align-self: flex-start;
            }

            .rooms-grid {
                gap: 14px;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }

            body.app-theme-rcc.rooms-page .room-card__header {
                padding: 16px 14px 0;
            }

            body.app-theme-rcc.rooms-page .room-card__content {
                padding: 0 14px 16px;
            }

            body.app-theme-rcc.rooms-page .room-features {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            body.app-theme-rcc.rooms-page .feature-tag {
                min-height: 42px;
                font-size: 0.95rem;
            }

            body.app-theme-rcc.rooms-page .view-deck-btn {
                min-height: 50px;
                font-size: 0.98rem;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.6s ease forwards;
        }

        .is-reveal-pending {
            opacity: 0;
            transform: translateY(14px);
        }

        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
    </style>
    <link rel="stylesheet" href="css/mobile-first.css?v=3">
</head>
<body class="app-theme-rcc rooms-page page-shell">
    <!-- Skip Link -->
    <a href="#rooms-section" class="skip-link">Skip to rooms list</a>

    <!-- Header Placeholder -->
    <div id="sharedHeader" data-page="rooms"></div>

    <!-- Hero Section -->
    <section class="hero hero--rooms">
        <div class="container">
            <div class="hero__content">
                <span class="hero__eyebrow">Adventure of the Seas · Feb 14–20, 2026</span>
                <h1 class="hero__title">Stateroom Command</h1>
                <p class="hero__description">
                    Review assignments, deck placement, and room-level guest actions in one workspace.
                </p>
                <div class="hero__highlights" aria-label="Stateroom highlights">
                    <span class="hero__tag"><i class="fas fa-key" aria-hidden="true"></i> Assignment and ownership clarity</span>
                    <span class="hero__tag"><i class="fas fa-person-shelter" aria-hidden="true"></i> Muster and safety context</span>
                    <span class="hero__tag"><i class="fas fa-bed" aria-hidden="true"></i> Room-type amenities at a glance</span>
                </div>
                <div class="page-spine" aria-label="Stateroom briefing">
                    <div class="page-spine__item">
                        <span class="page-spine__label">Assignments</span>
                        <span class="page-spine__meta">Who is in each room</span>
                    </div>
                    <div class="page-spine__item">
                        <span class="page-spine__label">Room type</span>
                        <span class="page-spine__meta">Interior, ocean view, balcony context</span>
                    </div>
                    <div class="page-spine__item">
                        <span class="page-spine__label">Fast actions</span>
                        <span class="page-spine__meta">Map lookup and service requests</span>
                    </div>
                </div>
                <div class="hero__actions">
                    <a href="decks.html" class="btn btn--primary">
                        <i class="fas fa-map"></i> Open deck plan
                    </a>
                    <a href="index.html" class="btn btn--secondary">
                        <i class="fas fa-arrow-left"></i> Back to dashboard
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main id="rooms-content" class="main">
        <div class="container">
            <!-- Navigation Bar -->
            <nav class="nav-bar" aria-label="Stateroom navigation">
                <div class="container nav-bar__inner">
                    <div class="nav-heading">
                        <h2 class="nav-heading__title">Find and manage staterooms</h2>
                        <p class="nav-heading__subtitle">Search by room number, type, deck, or feature</p>
                    </div>
                    <div class="nav-controls">
                        <div class="search-box">
                            <label class="sr-only" for="roomSearchInput">Search rooms</label>
                            <i class="fas fa-search" aria-hidden="true"></i>
                            <input id="roomSearchInput" type="search" placeholder="Search by room number, name, or location" aria-label="Search staterooms by room number, name, or location" enterkeyhint="search" inputmode="search" autocapitalize="off" autocorrect="off" spellcheck="false">
                        </div>
                        <div class="filter-control" data-filter-root>
                            <button id="filterToggle" class="filter-btn" type="button" aria-expanded="false" aria-controls="filterPanel" data-filter-toggle>
                                <i class="fas fa-filter" aria-hidden="true"></i>
                                Filter
                            </button>
                            <div id="filterPanel" class="filter-panel rccl-filter-panel" role="menu" aria-label="Room type filters" data-filter-panel data-filter-group="roomType">
                                <button type="button" class="room-type-filter rccl-filter-option is-active" data-room-type="all" data-filter-option data-filter-value="all" role="menuitemradio" aria-checked="true">All rooms</button>
                                <button type="button" class="room-type-filter rccl-filter-option" data-room-type="balcony" data-filter-option data-filter-value="balcony" role="menuitemradio" aria-checked="false">Balcony</button>
                                <button type="button" class="room-type-filter rccl-filter-option" data-room-type="ocean-view" data-filter-option data-filter-value="ocean-view" role="menuitemradio" aria-checked="false">Ocean view</button>
                                <button type="button" class="room-type-filter rccl-filter-option" data-room-type="interior" data-filter-option data-filter-value="interior" role="menuitemradio" aria-checked="false">Interior</button>
                            </div>
                        </div>
                    </div>
                    <div class="nav-filters">
                        <a href="#rooms-section" class="filter-btn filter-link">
                            <i class="fas fa-bed" aria-hidden="true"></i> Rooms
                        </a>
                        <a href="decks.html" class="filter-btn filter-link">
                            <i class="fas fa-map" aria-hidden="true"></i> Deck Plans
                        </a>
                        <a href="#quick-actions" class="filter-btn filter-link">
                            <i class="fas fa-bolt" aria-hidden="true"></i> Quick Actions
                        </a>
                    </div>
                </div>
            </nav>

            <!-- Statistics Overview -->
            <section class="stats-section" aria-labelledby="overviewTitle">
                <div class="section-header section-header--stacked">
                    <div>
                        <h2 id="overviewTitle" class="section-title">Stateroom Snapshot</h2>
                        <p class="section-subtitle">Key details only, with visual room-type distribution</p>
                    </div>
                    <button type="button" id="mobileStatsToggle" class="filter-btn mobile-stats-toggle" aria-expanded="false" aria-controls="statsGridWrap">
                        <i class="fas fa-chevron-down" aria-hidden="true"></i>
                        <span>Show summary</span>
                    </button>
                </div>
                <div id="statsGridWrap" class="stats-grid-wrap">
                <div class="stats-grid">
                    <article class="stat-card animate-fade-in">
                        <div class="stat-card__title">
                            <i class="fas fa-door-closed" aria-hidden="true"></i>
                            Assigned Rooms
                        </div>
                        <div class="stat-card__content">
                            <span class="stat-value">5</span>
                            <span class="stat-label">active staterooms</span>
                        </div>
                    </article>

                    <article class="stat-card animate-fade-in">
                        <div class="stat-card__title">
                            <i class="fas fa-layer-group" aria-hidden="true"></i>
                            Deck Coverage
                        </div>
                        <div class="stat-card__content">
                            <span class="stat-value">3</span>
                            <span class="stat-label">decks represented</span>
                        </div>
                    </article>

                    <article class="stat-card animate-fade-in">
                        <div class="stat-card__title">
                            <i class="fas fa-chart-column" aria-hidden="true"></i>
                            Room Mix
                        </div>
                        <div class="stat-chart" aria-label="Room type distribution chart">
                            <div class="stat-chart__row">
                                <span>Ocean View</span>
                                <div class="stat-chart__track"><span class="stat-chart__fill stat-chart__fill--ocean" style="width: 60%;"></span></div>
                                <strong>60%</strong>
                            </div>
                            <div class="stat-chart__row">
                                <span>Balcony</span>
                                <div class="stat-chart__track"><span class="stat-chart__fill stat-chart__fill--balcony" style="width: 20%;"></span></div>
                                <strong>20%</strong>
                            </div>
                            <div class="stat-chart__row">
                                <span>Interior</span>
                                <div class="stat-chart__track"><span class="stat-chart__fill stat-chart__fill--interior" style="width: 20%;"></span></div>
                                <strong>20%</strong>
                            </div>
                        </div>
                    </article>
                </div>
                </div>
            </section>

            <!-- Rooms Grid -->
            <section id="rooms-section" class="rooms-section">
                <div class="section-header">
                    <div>
                        <h2 class="section-title">Stateroom Overview</h2>
                        <p class="section-subtitle">Adaptive room grouping surfaces what needs attention first</p>
                    </div>
                    <div class="rooms-count">
                        <span class="rooms-count__number">5</span>
                        <span>rooms</span>
                    </div>
                </div>
                <p id="searchSummary" class="search-summary" role="status" aria-live="polite">Showing 5 of 5 rooms</p>
                
                <section class="focus-section" id="todayFocusSection" aria-labelledby="todayFocusTitle">
                    <div class="focus-section__header">
                        <h3 id="todayFocusTitle" class="focus-section__title">
                            <i class="fas fa-bolt" aria-hidden="true"></i>
                            Today's Focus
                        </h3>
                        <p class="focus-section__subtitle">Rooms requiring immediate action before sail-away</p>
                    </div>
                    <div class="rooms-grid focus-grid" id="focusGrid"></div>
                </section>

                <section class="focus-section focus-section--secondary" id="allSetSection" aria-labelledby="allSetTitle">
                    <div class="focus-section__header">
                        <h3 id="allSetTitle" class="focus-section__title">
                            <i class="fas fa-check-circle" aria-hidden="true"></i>
                            All Set
                        </h3>
                        <p class="focus-section__subtitle">Ready rooms with no immediate blockers</p>
                    </div>
                    <div class="rooms-grid" id="allSetGrid"></div>
                </section>

                <div class="rooms-grid" id="roomsGridSource" hidden>
                    <!-- Room 1 -->
                    <article class="room-card room-card--interior animate-fade-in" data-room="6650" data-room-type="interior" data-muster-complete="false" data-linked-room="6651" data-room-priority="urgent" data-room-note="Muster not completed">
                        <div class="room-card__header">
                            <span class="room-number">1</span>
                            <span class="room-category">Stateroom</span>
                            <div class="room-type">
                                <div class="room-type__icon">
                                    <i class="fas fa-bed"></i>
                                </div>
                                <h3 class="room-type__name">6650</h3>
                            </div>
                            <span class="room-location">
                                <i class="fas fa-layer-group"></i> Deck 6 · Aft
                            </span>
                        </div>

                        <div class="room-card__content">
                            <div class="room-features">
                                <span class="feature-tag">
                                    <i class="fas fa-user"></i> 4 guests
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-id-badge"></i> Booking 4519230
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-life-ring"></i> Muster D22
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-water"></i> Aft wake views
                                </span>
                            </div>
                            <div class="guest-roster" aria-label="Guests in room 6650">
                                <p class="guest-roster__label"><i class="fas fa-users" aria-hidden="true"></i>Guest Roster</p>
                                <ul class="guest-roster__list">
                                    <li class="guest-pill">Melissa</li>
                                    <li class="guest-pill">Declan</li>
                                    <li class="guest-pill">Owen</li>
                                    <li class="guest-pill">William</li>
                                </ul>
                            </div>
                            <p class="room-meta-details">Quieter aft ride with strong wake views.</p>
                            
                            <div class="room-card__actions">
                                <button type="button" class="room-details-btn" data-room-details>
                                    <i class="fas fa-info-circle" aria-hidden="true"></i>
                                    <span>Room details</span>
                                </button>
                                <a href="decks.html?room=6650" class="view-deck-btn">
                                    <i class="fas fa-map-marked-alt" aria-hidden="true"></i>
                                    <span>Locate on deck</span>
                                </a>
                            </div>
                        </div>
                    </article>
                    
                    <!-- Room 2 -->
                    <article class="room-card room-card--interior animate-fade-in" data-room="6651" data-room-type="interior" data-muster-complete="true" data-linked-room="6650">
                        <div class="room-card__header">
                            <span class="room-number">2</span>
                            <span class="room-category">Stateroom</span>
                            <div class="room-type">
                                <div class="room-type__icon">
                                    <i class="fas fa-bed"></i>
                                </div>
                                <h3 class="room-type__name">6651</h3>
                            </div>
                            <span class="room-location">
                                <i class="fas fa-layer-group"></i> Deck 6
                            </span>
                        </div>

                        <div class="room-card__content">
                            <div class="room-features">
                                <span class="feature-tag">
                                    <i class="fas fa-user"></i> 2 guests
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-id-badge"></i> Booking 6788946
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-life-ring"></i> Muster D22
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-users"></i> Linked reservation
                                </span>
                            </div>
                            <div class="guest-roster" aria-label="Guests in room 6651">
                                <p class="guest-roster__label"><i class="fas fa-users" aria-hidden="true"></i>Guest Roster</p>
                                <ul class="guest-roster__list">
                                    <li class="guest-pill">Abel</li>
                                    <li class="guest-pill">Amy</li>
                                </ul>
                            </div>
                            <p class="room-meta-details">Linked to 6650 with shared muster station.</p>
                            
                            <div class="room-card__actions">
                                <button type="button" class="room-details-btn" data-room-details>
                                    <i class="fas fa-info-circle" aria-hidden="true"></i>
                                    <span>Room details</span>
                                </button>
                                <a href="decks.html?room=6651" class="view-deck-btn">
                                    <i class="fas fa-map-marked-alt" aria-hidden="true"></i>
                                    <span>Locate on deck</span>
                                </a>
                            </div>
                        </div>
                    </article>
                    
                    <!-- Room 3 -->
                    <article class="room-card room-card--ocean-view animate-fade-in" data-room="8528" data-room-type="ocean-view" data-muster-complete="true">
                        <div class="room-card__header">
                            <span class="room-number">3</span>
                            <span class="room-category">Stateroom</span>
                            <div class="room-type">
                                <div class="room-type__icon">
                                    <i class="fas fa-user-friends"></i>
                                </div>
                                <h3 class="room-type__name">8528</h3>
                            </div>
                            <span class="room-location">
                                <i class="fas fa-layer-group"></i> Deck 8
                            </span>
                        </div>

                        <div class="room-card__content">
                            <div class="room-features">
                                <span class="feature-tag">
                                    <i class="fas fa-user"></i> 2 guests
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-id-badge"></i> Booking 4352113
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-life-ring"></i> Muster A2
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-ship"></i> Linked sailing record
                                </span>
                            </div>
                            <div class="guest-roster" aria-label="Guests in room 8528">
                                <p class="guest-roster__label"><i class="fas fa-users" aria-hidden="true"></i>Guest Roster</p>
                                <ul class="guest-roster__list">
                                    <li class="guest-pill">Aimee</li>
                                    <li class="guest-pill">Karin</li>
                                </ul>
                            </div>
                            <p class="room-meta-details">Deck 8 assignment with separate muster flow.</p>
                            
                            <div class="room-card__actions">
                                <button type="button" class="room-details-btn" data-room-details>
                                    <i class="fas fa-info-circle" aria-hidden="true"></i>
                                    <span>Room details</span>
                                </button>
                                <a href="decks.html?room=8528" class="view-deck-btn">
                                    <i class="fas fa-map-marked-alt" aria-hidden="true"></i>
                                    <span>Locate on deck</span>
                                </a>
                            </div>
                        </div>
                    </article>
                    
                    <!-- Room 4 -->
                    <article class="room-card room-card--ocean-view animate-fade-in" data-room="8612" data-room-type="ocean-view" data-muster-complete="true">
                        <div class="room-card__header">
                            <span class="room-number">4</span>
                            <span class="room-category">Stateroom</span>
                            <div class="room-type">
                                <div class="room-type__icon">
                                    <i class="fas fa-user-friends"></i>
                                </div>
                                <h3 class="room-type__name">8612</h3>
                            </div>
                            <span class="room-location">
                                <i class="fas fa-layer-group"></i> Deck 8
                            </span>
                        </div>

                        <div class="room-card__content">
                            <div class="room-features">
                                <span class="feature-tag">
                                    <i class="fas fa-user"></i> 2 guests
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-id-badge"></i> Booking 4406580
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-life-ring"></i> Muster C16
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-ship"></i> Linked sailing record
                                </span>
                            </div>
                            <div class="guest-roster" aria-label="Guests in room 8612">
                                <p class="guest-roster__label"><i class="fas fa-users" aria-hidden="true"></i>Guest Roster</p>
                                <ul class="guest-roster__list">
                                    <li class="guest-pill">Isabella</li>
                                    <li class="guest-pill">Walter</li>
                                </ul>
                            </div>
                            <p class="room-meta-details">Deck 8 room with C16 muster assignment.</p>
                            
                            <div class="room-card__actions">
                                <button type="button" class="room-details-btn" data-room-details>
                                    <i class="fas fa-info-circle" aria-hidden="true"></i>
                                    <span>Room details</span>
                                </button>
                                <a href="decks.html?room=8612" class="view-deck-btn">
                                    <i class="fas fa-map-marked-alt" aria-hidden="true"></i>
                                    <span>Locate on deck</span>
                                </a>
                            </div>
                        </div>
                    </article>
                    
                    <!-- Room 5 -->
                    <article class="room-card room-card--interior animate-fade-in" data-room="3622" data-room-type="interior" data-muster-complete="false" data-room-priority="attention" data-room-note="Arrival-day check still pending">
                        <div class="room-card__header">
                            <span class="room-number">5</span>
                            <span class="room-category">Interior Room</span>
                            <div class="room-type">
                                <div class="room-type__icon">
                                    <i class="fas fa-bed"></i>
                                </div>
                                <h3 class="room-type__name">3622</h3>
                            </div>
                            <span class="room-location">
                                <i class="fas fa-layer-group"></i> Deck 3 · Forward
                            </span>
                        </div>

                        <div class="room-card__content">
                            <div class="room-features">
                                <span class="feature-tag">
                                    <i class="fas fa-user"></i> 2 guests
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-expand"></i> 160 sq ft
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-moon"></i> Dark sleep environment
                                </span>
                                <span class="feature-tag">
                                    <i class="fas fa-elevator"></i> Forward elevators nearby
                                </span>
                            </div>
                            <div class="guest-roster" aria-label="Guests in room 3622">
                                <p class="guest-roster__label"><i class="fas fa-users" aria-hidden="true"></i>Guest Roster</p>
                                <ul class="guest-roster__list">
                                    <li class="guest-pill">Phoebe</li>
                                    <li class="guest-pill">Ryan</li>
                                </ul>
                            </div>
                            <p class="room-meta-details">Budget-friendly interior room at the front of the ship.</p>
                            
                            <div class="room-card__actions">
                                <button type="button" class="room-details-btn" data-room-details>
                                    <i class="fas fa-info-circle" aria-hidden="true"></i>
                                    <span>Room details</span>
                                </button>
                                <a href="decks.html?room=3622" class="view-deck-btn">
                                    <i class="fas fa-map-marked-alt" aria-hidden="true"></i>
                                    <span>Locate on deck</span>
                                </a>
                            </div>
                        </div>
                    </article>
                </div>
                <p id="noSearchResults" class="no-search-results" hidden>Try clearing filters or searching by room number (for example: 6650).</p>
            </section>

            <!-- Quick Actions -->
            <section id="quick-actions" class="quick-actions">
                <h2 class="section-title">Quick Actions</h2>
                <p class="section-subtitle">Grouped by task so guests can find the right action faster</p>
                
                <section class="action-group" aria-labelledby="orderingActionsTitle">
                    <h3 id="orderingActionsTitle" class="action-group__title">Ordering</h3>
                    <div class="actions-grid">
                        <a href="index.html" class="action-item rccl-tooltip-target" data-tooltip="Unlock and enter your assigned stateroom.">
                            <div class="action-icon">
                                <i class="fas fa-key" aria-hidden="true"></i>
                            </div>
                            <div class="action-content">
                                <h4>Digital Key</h4>
                                <p>Access your stateroom</p>
                            </div>
                        </a>

                        <a href="dining.html" class="action-item rccl-tooltip-target" data-tooltip="Order meals, drinks, and amenity delivery.">
                            <div class="action-icon">
                                <i class="fas fa-concierge-bell" aria-hidden="true"></i>
                            </div>
                            <div class="action-content">
                                <h4>Room Service</h4>
                                <p>Order food & beverages</p>
                            </div>
                        </a>
                    </div>
                </section>

                <section class="action-group" aria-labelledby="assistanceActionsTitle">
                    <h3 id="assistanceActionsTitle" class="action-group__title">Assistance</h3>
                    <div class="actions-grid">
                        <a href="decks.html" class="action-item rccl-tooltip-target" data-tooltip="Find your room and major ship venues.">
                            <div class="action-icon">
                                <i class="fas fa-map" aria-hidden="true"></i>
                            </div>
                            <div class="action-content">
                                <h4>Deck Plans</h4>
                                <p>Explore ship layout</p>
                            </div>
                        </a>

                        <a href="contacts.html" class="action-item rccl-tooltip-target" data-tooltip="Contact support for cabin questions or issues.">
                            <div class="action-icon">
                                <i class="fas fa-user-headset" aria-hidden="true"></i>
                            </div>
                            <div class="action-content">
                                <h4>Guest Services</h4>
                                <p>Get assistance</p>
                            </div>
                        </a>
                    </div>
                </section>
            </section>
        </div>
    </main>

    <!-- Room Detail Modal -->
    <div id="roomModal" class="room-modal rccl-modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalDescription" aria-hidden="true" data-modal>
        <div class="modal-content rccl-modal__content">
            <div class="modal-header rccl-modal__header">
                <h3 id="modalTitle">Room Details</h3>
                <button id="modalCloseBtn" type="button" class="header-action" aria-label="Close room details" data-modal-close>
                    <i class="fas fa-times" aria-hidden="true"></i>
                </button>
            </div>
            <p id="modalDescription" class="modal-description">Review room highlights and continue to deck placement.</p>
            <div id="modalBody" style="padding: 20px 24px 24px;">
                <!-- Content loaded dynamically -->
            </div>
        </div>
    </div>

    <div id="roomComparisonRail" class="comparison-rail" hidden aria-live="polite">
        <div class="comparison-rail__header">
            <h3>Comparing <span id="compareCount">0</span> room(s)</h3>
            <button type="button" id="clearComparisonBtn" class="header-action" aria-label="Close comparison rail">
                <i class="fas fa-times" aria-hidden="true"></i>
            </button>
        </div>
        <div id="comparisonGrid" class="comparison-grid"></div>
    </div>

    <div id="keyboardHint" class="keyboard-hint" hidden aria-live="polite">
        <kbd>Ctrl</kbd>+<kbd>J</kbd>/<kbd>K</kbd> navigate rooms · <kbd>R</kbd> details · <kbd>D</kbd> deck · <kbd>?</kbd> help
    </div>

    <!-- Footer Placeholder -->
    <div id="sharedFooter"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('roomSearchInput');
            const roomCards = Array.from(document.querySelectorAll('#roomsGridSource .room-card'));
            const focusGrid = document.getElementById('focusGrid');
            const allSetGrid = document.getElementById('allSetGrid');
            const todayFocusSection = document.getElementById('todayFocusSection');
            const allSetSection = document.getElementById('allSetSection');
            const searchSummary = document.getElementById('searchSummary');
            const noSearchResults = document.getElementById('noSearchResults');
            const roomsCountValue = document.querySelector('.rooms-count__number');
            const roomsCount = document.querySelector('.rooms-count');
            const filterToggle = document.getElementById('filterToggle');
            const filterPanel = document.getElementById('filterPanel');
            const mobileStatsToggle = document.getElementById('mobileStatsToggle');
            const statsGridWrap = document.getElementById('statsGridWrap');
            const roomModal = document.getElementById('roomModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalDescription = document.getElementById('modalDescription');
            const modalBody = document.getElementById('modalBody');
            const comparisonRail = document.getElementById('roomComparisonRail');
            const compareCount = document.getElementById('compareCount');
            const comparisonGrid = document.getElementById('comparisonGrid');
            const clearComparisonBtn = document.getElementById('clearComparisonBtn');
            const keyboardHint = document.getElementById('keyboardHint');
            const totalRooms = roomCards.length;

            let activeType = 'all';
            let currentVisibleCards = [];
            let keyboardRoomIndex = 0;
            let currentModalRoomIndex = -1;
            const compareSet = new Set();

            function computeRoomPriority(card) {
                const musterComplete = card.dataset.musterComplete === 'true';
                const explicitPriority = card.dataset.roomPriority || '';
                if (!musterComplete || explicitPriority === 'urgent') return 3;
                if (card.dataset.linkedRoom || explicitPriority === 'attention') return 2;
                return 1;
            }

            function getRoomFacts(card) {
                const roomNumber = card.dataset.room || '';
                const roomType = card.dataset.roomType || 'stateroom';
                const location = card.querySelector('.room-location')?.textContent?.trim() || 'Unknown location';
                const guestCount = card.querySelectorAll('.guest-pill').length;
                const muster = Array.from(card.querySelectorAll('.feature-tag')).map((t) => t.textContent.trim()).find((text) => /muster/i.test(text)) || 'Not listed';
                return { roomNumber, roomType, location, guestCount, muster };
            }

            function renderStatusBadges(card) {
                const header = card.querySelector('.room-card__header');
                if (!header) return;

                const existing = card.querySelector('.room-card__status-bar');
                if (existing) existing.remove();

                const statusBar = document.createElement('div');
                statusBar.className = 'room-card__status-bar';

                const musterComplete = card.dataset.musterComplete === 'true';
                if (musterComplete) {
                    statusBar.insertAdjacentHTML('beforeend', '<span class="status-badge status-badge--success"><i class="fas fa-check-circle" aria-hidden="true"></i>Muster complete</span>');
                } else {
                    statusBar.insertAdjacentHTML('beforeend', '<span class="status-badge status-badge--warning"><i class="fas fa-life-ring" aria-hidden="true"></i>Muster not completed</span>');
                }

                if (card.dataset.linkedRoom) {
                    statusBar.insertAdjacentHTML('beforeend', `<span class="status-badge status-badge--info"><i class="fas fa-link" aria-hidden="true"></i>Linked to ${card.dataset.linkedRoom}</span>`);
                }

                if (card.dataset.roomNote) {
                    statusBar.insertAdjacentHTML('beforeend', `<span class="status-badge status-badge--info"><i class="fas fa-bolt" aria-hidden="true"></i>${card.dataset.roomNote}</span>`);
                }

                header.insertAdjacentElement('beforebegin', statusBar);
            }

            function ensureCompareButton(card) {
                const actions = card.querySelector('.room-card__actions');
                if (!actions || actions.querySelector('.compare-toggle-btn')) return;
                const roomNumber = card.dataset.room || '';
                const compareBtn = document.createElement('button');
                compareBtn.type = 'button';
                compareBtn.className = 'compare-toggle-btn';
                compareBtn.dataset.compareRoom = roomNumber;
                compareBtn.innerHTML = '<i class="fas fa-columns" aria-hidden="true"></i><span>Compare room</span>';
                actions.appendChild(compareBtn);
            }

            function renderComparisonRail() {
                const selected = roomCards.filter((card) => compareSet.has(card.dataset.room));
                compareCount.textContent = String(selected.length);

                if (!selected.length) {
                    comparisonRail.hidden = true;
                    comparisonGrid.innerHTML = '';
                    return;
                }

                comparisonGrid.innerHTML = selected.map((card) => {
                    const facts = getRoomFacts(card);
                    return `
                        <div class="comparison-column">
                            <h4>${facts.roomNumber} · ${facts.roomType.replace('-', ' ')}</h4>
                            <ul class="comparison-list">
                                <li><span>Guests:</span> ${facts.guestCount}</li>
                                <li><span>Location:</span> ${facts.location}</li>
                                <li><span>Muster:</span> ${facts.muster}</li>
                            </ul>
                        </div>
                    `;
                }).join('');

                comparisonRail.hidden = false;
            }

            roomCards.forEach((card) => {
                renderStatusBadges(card);
                ensureCompareButton(card);
            });

            function updateRoomVisibility() {
                const searchTerm = searchInput.value.toLowerCase().trim();
                let visibleCount = 0;
                const visibleCards = [];

                roomCards.forEach((card) => {
                    const roomNumber = card.dataset.room || '';
                    const roomName = card.querySelector('.room-type__name')?.textContent || '';
                    const roomLocation = card.querySelector('.room-location')?.textContent || '';
                    const roomFeatures = card.querySelector('.room-features')?.textContent || '';
                    const roomType = card.dataset.roomType || 'all';
                    const searchableText = `${roomNumber} ${roomName} ${roomLocation} ${roomFeatures}`.toLowerCase();

                    const matchesSearch = !searchTerm || searchableText.includes(searchTerm);
                    const matchesType = activeType === 'all' || roomType === activeType;
                    const shouldShow = matchesSearch && matchesType;

                    if (shouldShow) {
                        visibleCount += 1;
                        visibleCards.push(card);
                    }
                });

                visibleCards.sort((a, b) => computeRoomPriority(b) - computeRoomPriority(a));
                currentVisibleCards = visibleCards;
                keyboardRoomIndex = Math.min(keyboardRoomIndex, Math.max(visibleCards.length - 1, 0));

                if (focusGrid) focusGrid.innerHTML = '';
                if (allSetGrid) allSetGrid.innerHTML = '';

                visibleCards.forEach((card) => {
                    card.hidden = false;
                    card.style.display = 'flex';
                    const priority = computeRoomPriority(card);
                    const compareBtn = card.querySelector('.compare-toggle-btn');
                    const isCompared = compareSet.has(card.dataset.room);
                    compareBtn?.classList.toggle('is-active', isCompared);
                    if (compareBtn) {
                        compareBtn.querySelector('span').textContent = isCompared ? 'Selected for compare' : 'Compare room';
                    }
                    if (priority >= 2 && focusGrid) {
                        focusGrid.appendChild(card);
                    } else if (allSetGrid) {
                        allSetGrid.appendChild(card);
                    }
                });

                if (todayFocusSection) {
                    todayFocusSection.hidden = !focusGrid || focusGrid.children.length === 0;
                }
                if (allSetSection) {
                    allSetSection.hidden = !allSetGrid || allSetGrid.children.length === 0;
                }

                const roomLabel = visibleCount === 1 ? 'room' : 'rooms';
                searchSummary.textContent = `Showing ${visibleCount} of ${totalRooms} ${roomLabel}`;
                roomsCountValue.textContent = String(visibleCount);
                if (roomsCount) {
                    roomsCount.hidden = visibleCount === 0;
                }
                noSearchResults.hidden = visibleCount !== 0;
                renderComparisonRail();
            }

            function closeFilterPanel() {
                if (!filterPanel) return;
                filterPanel.classList.remove('is-open');
                filterToggle.setAttribute('aria-expanded', 'false');
            }

            document.addEventListener('rccl:filter-change', function(event) {
                if (!event.detail || event.detail.group !== 'roomType') return;
                activeType = event.detail.value || 'all';
                filterToggle.classList.toggle('filter-btn--active', activeType !== 'all');
                closeFilterPanel();
                updateRoomVisibility();
            });

            searchInput.addEventListener('input', updateRoomVisibility);

            function focusedRoomCard() {
                return currentVisibleCards[keyboardRoomIndex] || null;
            }

            function focusRoomAt(index) {
                if (!currentVisibleCards.length) return;
                keyboardRoomIndex = (index + currentVisibleCards.length) % currentVisibleCards.length;
                const card = focusedRoomCard();
                card?.setAttribute('tabindex', '-1');
                card?.focus({ preventScroll: false });
                card?.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }

            function showKeyboardHintTemporarily() {
                if (!keyboardHint) return;
                keyboardHint.hidden = false;
                window.clearTimeout(showKeyboardHintTemporarily._timer);
                showKeyboardHintTemporarily._timer = window.setTimeout(() => {
                    keyboardHint.hidden = true;
                }, 3800);
            }

            function focusedRoomAction(type) {
                const card = focusedRoomCard();
                if (!card) return;
                if (type === 'details') {
                    card.querySelector('[data-room-details]')?.click();
                    return;
                }
                if (type === 'deck') {
                    const deckLink = card.querySelector('.view-deck-btn');
                    if (deckLink) window.location.href = deckLink.href;
                }
            }

            // Keyboard power mode
            document.addEventListener('keydown', function(e) {
                const target = e.target;
                const typingContext = target && (
                    target.tagName === 'INPUT' ||
                    target.tagName === 'TEXTAREA' ||
                    target.isContentEditable
                );

                if (e.key === '/' && !typingContext && e.target !== searchInput) {
                    e.preventDefault();
                    searchInput.focus();
                    return;
                }

                if (e.key === '?') {
                    e.preventDefault();
                    showKeyboardHintTemporarily();
                    return;
                }

                if (typingContext) return;

                if (e.key === 'Escape') {
                    closeRoomModal();
                    if (compareSet.size) {
                        compareSet.clear();
                        roomCards.forEach((card) => {
                            const compareBtn = card.querySelector('.compare-toggle-btn');
                            compareBtn?.classList.remove('is-active');
                            if (compareBtn) compareBtn.querySelector('span').textContent = 'Compare room';
                        });
                        renderComparisonRail();
                    }
                    return;
                }

                if (e.ctrlKey && e.key.toLowerCase() === 'j') {
                    e.preventDefault();
                    focusRoomAt(keyboardRoomIndex + 1);
                    return;
                }

                if (e.ctrlKey && e.key.toLowerCase() === 'k') {
                    e.preventDefault();
                    focusRoomAt(keyboardRoomIndex - 1);
                    return;
                }

                if (e.key.toLowerCase() === 'r') {
                    e.preventDefault();
                    focusedRoomAction('details');
                    return;
                }

                if (e.key.toLowerCase() === 'd') {
                    e.preventDefault();
                    focusedRoomAction('deck');
                }
            });

            if (filterToggle && filterPanel) {
                filterToggle.addEventListener('click', function() {
                    const shouldOpen = !filterPanel.classList.contains('is-open');
                    filterPanel.classList.toggle('is-open', shouldOpen);
                    filterToggle.setAttribute('aria-expanded', String(shouldOpen));
                });

                document.addEventListener('click', function(e) {
                    if (!e.target.closest('[data-filter-root]')) {
                        closeFilterPanel();
                    }
                });

                document.addEventListener('keydown', function(e) {
                    if (e.key === 'Escape') {
                        closeFilterPanel();
                    }
                });
            }

            if (mobileStatsToggle && statsGridWrap) {
                mobileStatsToggle.addEventListener('click', function() {
                    const isOpen = statsGridWrap.classList.toggle('is-open');
                    mobileStatsToggle.setAttribute('aria-expanded', String(isOpen));
                    const label = mobileStatsToggle.querySelector('span');
                    const icon = mobileStatsToggle.querySelector('i');
                    if (label) {
                        label.textContent = isOpen ? 'Hide summary' : 'Show summary';
                    }
                    if (icon) {
                        icon.classList.toggle('fa-chevron-down', !isOpen);
                        icon.classList.toggle('fa-chevron-up', isOpen);
                    }
                    if (isOpen) {
                        const firstStat = statsGridWrap.querySelector('.stat-card');
                        if (firstStat) {
                            firstStat.setAttribute('tabindex', '-1');
                            firstStat.focus();
                        }
                    }
                });
            }

            // Explicit room details button handler to avoid card-level action ambiguity
            roomCards.forEach(card => {
                const detailsBtn = card.querySelector('[data-room-details]');
                if (!detailsBtn) return;

                detailsBtn.addEventListener('click', function() {
                    const roomNumber = card.dataset.room;
                    const roomName = card.querySelector('.room-type__name').textContent;
                    const roomLocation = card.querySelector('.room-location').textContent;
                    showRoomModal(roomNumber, roomName, roomLocation);
                });

                const compareBtn = card.querySelector('.compare-toggle-btn');
                compareBtn?.addEventListener('click', function() {
                    const roomNumber = card.dataset.room;
                    if (!roomNumber) return;
                    if (compareSet.has(roomNumber)) {
                        compareSet.delete(roomNumber);
                    } else {
                        compareSet.add(roomNumber);
                    }
                    compareBtn.classList.toggle('is-active', compareSet.has(roomNumber));
                    compareBtn.querySelector('span').textContent = compareSet.has(roomNumber) ? 'Selected for compare' : 'Compare room';
                    renderComparisonRail();
                });
            });

            // Room modal functions
            function showRoomModal(roomNumber, roomName, location) {
                const roomCard = roomCards.find((card) => card.dataset.room === roomNumber);
                const guestCount = roomCard ? roomCard.querySelectorAll('.guest-pill').length : 2;
                const featureTags = roomCard ? Array.from(roomCard.querySelectorAll('.feature-tag')) : [];
                const sqftTag = featureTags.find((tag) => /sq\s*ft/i.test(tag.textContent || ''));
                const sqftText = sqftTag ? (sqftTag.textContent || '').trim() : 'Size varies';
                const hasBalcony = roomCard ? roomCard.dataset.roomType === 'balcony' : roomName.includes('Balcony');
                const roomTypeName = roomCard
                    ? (roomCard.dataset.roomType || 'stateroom').replace('-', ' ')
                    : 'stateroom';
                const roomDescription = roomCard ? (roomCard.querySelector('.room-meta-details')?.textContent || '').trim() : '';
                const highlights = featureTags
                    .map((tag) => (tag.textContent || '').trim())
                    .filter(Boolean)
                    .filter((text) => !/sq\s*ft/i.test(text))
                    .slice(0, 2);
                modalTitle.textContent = `Room ${roomNumber}`;
                modalDescription.textContent = `${roomTypeName.charAt(0).toUpperCase()}${roomTypeName.slice(1)} details and deck placement.`;
                closeFilterPanel();
                currentModalRoomIndex = currentVisibleCards.findIndex((card) => card.dataset.room === roomNumber);
                
                modalBody.innerHTML = `
                    <div class="modal-room-location">
                        <i class="fas fa-layer-group" aria-hidden="true"></i>
                        <span>${location}</span>
                    </div>

                    <div class="room-highlights-grid">
                        <span class="highlight-badge">
                            <i class="fas fa-user" aria-hidden="true"></i>
                            <span>${guestCount} ${guestCount === 1 ? 'guest' : 'guests'}</span>
                        </span>
                        <span class="highlight-badge">
                            <i class="fas fa-expand" aria-hidden="true"></i>
                            <span>${sqftText}</span>
                        </span>
                        ${hasBalcony ? `
                        <span class="highlight-badge">
                            <i class="fas fa-wind" aria-hidden="true"></i>
                            <span>Private balcony</span>
                        </span>
                        ` : ''}
                        ${highlights.map((text) => `
                        <span class="highlight-badge">
                            <i class="fas fa-check-circle" aria-hidden="true"></i>
                            <span>${text}</span>
                        </span>
                        `).join('')}
                    </div>

                    <p class="modal-body-copy">${roomDescription || 'Use deck view to confirm nearby elevators and venue access before arrival.'}</p>
                    <p class="modal-hint">Opens deck plan focused on room ${roomNumber}.</p>

                    <div class="modal-actions">
                        <button type="button" class="modal-secondary-btn modal-prev-room">
                            <i class="fas fa-chevron-left" aria-hidden="true"></i>
                            <span>Previous room</span>
                        </button>
                        <button type="button" class="modal-secondary-btn modal-next-room">
                            <i class="fas fa-chevron-right" aria-hidden="true"></i>
                            <span>Next room</span>
                        </button>
                        <a href="decks.html?room=${roomNumber}" class="modal-primary-btn">
                            <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
                            <span>Show on deck plan</span>
                        </a>
                        <button type="button" class="modal-secondary-btn modal-continue-room">
                            <i class="fas fa-arrow-left" aria-hidden="true"></i>
                            <span>Continue browsing</span>
                        </button>
                    </div>
                `;

                if (window.RCCLModal && typeof window.RCCLModal.open === 'function') {
                    window.RCCLModal.open('roomModal');
                } else {
                    roomModal.classList.add('room-modal--open');
                }
                const modalContinue = modalBody.querySelector('.modal-continue-room');
                modalContinue?.focus();
                modalContinue?.addEventListener('click', closeRoomModal, { once: true });
                modalBody.querySelector('.modal-prev-room')?.addEventListener('click', function() {
                    moveModalRoom(-1);
                });
                modalBody.querySelector('.modal-next-room')?.addEventListener('click', function() {
                    moveModalRoom(1);
                });
            }

            function moveModalRoom(step) {
                if (!currentVisibleCards.length) return;
                if (currentModalRoomIndex < 0) {
                    currentModalRoomIndex = 0;
                } else {
                    currentModalRoomIndex = (currentModalRoomIndex + step + currentVisibleCards.length) % currentVisibleCards.length;
                }
                const card = currentVisibleCards[currentModalRoomIndex];
                if (!card) return;
                const roomNumber = card.dataset.room;
                const roomName = card.querySelector('.room-type__name')?.textContent || roomNumber;
                const roomLocation = card.querySelector('.room-location')?.textContent || 'Unknown location';
                showRoomModal(roomNumber, roomName, roomLocation);
            }

            function closeRoomModal() {
                if (window.RCCLModal && typeof window.RCCLModal.close === 'function') {
                    window.RCCLModal.close('roomModal');
                } else {
                    roomModal.classList.remove('room-modal--open');
                }
            }

            // Filter buttons
            const filterButtons = document.querySelectorAll('.filter-link');
            filterButtons.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    if (this.getAttribute('href').startsWith('#')) {
                        e.preventDefault();

                        const targetId = this.getAttribute('href');
                        const targetElement = document.querySelector(targetId);
                        
                        if (targetElement) {
                            window.scrollTo({
                                top: targetElement.offsetTop - 80,
                                behavior: 'smooth'
                            });
                        }
                    }
                });
            });

            // Initialize animations
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.remove('is-reveal-pending');
                        entry.target.classList.add('animate-fade-in');
                        observer.unobserve(entry.target);
                    }
                });
            }, observerOptions);

            document.querySelectorAll('.stat-card, .room-card, .action-item').forEach(el => {
                el.classList.remove('animate-fade-in');
                el.classList.add('is-reveal-pending');
                observer.observe(el);
            });

            updateRoomVisibility();

            clearComparisonBtn?.addEventListener('click', function() {
                compareSet.clear();
                roomCards.forEach((card) => {
                    const compareBtn = card.querySelector('.compare-toggle-btn');
                    compareBtn?.classList.remove('is-active');
                    if (compareBtn) compareBtn.querySelector('span').textContent = 'Compare room';
                });
                renderComparisonRail();
            });

            let modalTouchStartX = 0;
            let modalTouchStartY = 0;
            roomModal?.addEventListener('touchstart', function(e) {
                const touch = e.touches[0];
                if (!touch) return;
                modalTouchStartX = touch.clientX;
                modalTouchStartY = touch.clientY;
            }, { passive: true });

            roomModal?.addEventListener('touchend', function(e) {
                const touch = e.changedTouches[0];
                const modalIsOpen = roomModal.getAttribute('aria-hidden') === 'false' || roomModal.classList.contains('room-modal--open');
                if (!touch || !modalIsOpen) return;
                const dx = touch.clientX - modalTouchStartX;
                const dy = touch.clientY - modalTouchStartY;
                if (Math.abs(dx) < 80 || Math.abs(dx) < Math.abs(dy) * 1.5) return;
                moveModalRoom(dx > 0 ? -1 : 1);
            });

            // Floating toasts removed per UX update.
        });
    </script>
</body>
</html>
